--[[
	⣿⣿⣿⣿⣿ SIGMA SPY ⣿⣿⣿⣿⣿
	⣿⣿⣯⡉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉
	⠉⠻⣿⣿⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠈⠻⣿⣿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⠙⢿⣿⣿⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⠀⠀⣉⣿⣿⣿⠆⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⣠⣾⣿⣿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⢀⣴⣿⣿⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⣀⣴⣿⣿⠟⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⣿⣿⣟⣁⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀
	⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿

	@author depso (depthso)
	@repo https://github.com/depthso
	@license MIT
	@description Sigma Remote Spy for Roblox
    
	This file is COMPILED, check /src folder for the source
	Build scripts are available in /build
]]

local a,b={UseWorkspace=false,NoActors=false,FolderName='Sigma Spy',RepoUrl=
[[https://raw.githubusercontent.com/Jsssiee/Sigma-Spy/refs/heads/main]],
ParserUrl=
[[https://raw.githubusercontent.com/Jsssiee/Roblox-parser/refs/heads/main/dist/Main.luau]]
},{...}local c=b[1]if typeof(c)=='table'then for d,e in c do a[d]=e end end
local d=setmetatable({},{__index=function(d,e)local f=game:GetService(e)return
cloneref(f)end})local e=(function()local e,f={UseWorkspace=false,Folder=
'Sigma spy',RepoUrl=nil,FolderStructure={['Sigma Spy']={'assets'}}}function e:
Init(g)local h,i=self.FolderStructure,g.Services f=i.HttpService self:
CheckFolders(h)end function e:PushConfig(g)for h,i in next,g do self[h]=i end
end function e:UrlFetch(g)local h={Url=g:gsub(' ','%%20'),Method='GET'}local i,j
=pcall(request,h)if not i then warn'[!] HTTP request error! Check console (F9)'
warn('> Url:',g)error(j)return''end local k,l=j.Body,j.StatusCode if l==404 then
warn'[!] The file requested has moved or been deleted.'warn(' >',g)return''end
return k,j end function e:MakePath(g)local h=self.Folder return`{h}/{g}`end
function e:LoadCustomasset(g)if not getcustomasset then return end if not g then
return end local h=readfile(g)if#h<=0 then return end local i,j=pcall(
getcustomasset,g)if not i then return end if not j or#j<=0 then return end
return j end function e:GetFile(g,h)local i,j,k,l=self.RepoUrl,self.UseWorkspace
,self:MakePath(g),''if j then l=readfile(k)else l=self:UrlFetch(`{i}/{g}`)end if
h then self:FileCheck(k,function()return l end)return self:LoadCustomasset(k)end
return l end function e:GetTemplate(g)return self:GetFile(`templates/{g}.lua`)
end function e:FileCheck(g,h)if isfile(g)then return end local i=h()writefile(g,
i)end function e:FolderCheck(g)if isfolder(g)then return end makefolder(g)end
function e:CheckPath(g,h)return g and`{g}/{h}`or h end function e:CheckFolders(g
,h)for i,j in next,g do if typeof(j)=='table'then local k=self:CheckPath(h,i)
self:FolderCheck(k)self:CheckFolders(j,k)continue end local k=self:CheckPath(h,j
)self:FolderCheck(k)end end function e:TemplateCheck(g,h)self:FileCheck(g,
function()return self:GetTemplate(h)end)end function e:GetAsset(g,h)return self:
GetFile(`assets/{g}`,h)end function e:GetModule(g,h)local i=`{g}.lua`if h then
self:TemplateCheck(i,h)local j=readfile(i)local k=loadstring(j)if k then return
j end return self:GetTemplate(h)end return self:GetFile(i)end function e:
LoadLibraries(g,...)local h={}for i,j in next,g do local k=typeof(j)=='table'and
j[1]=='base64'j=k and j[2]or j if typeof(j)~='string'and not k then h[i]=j
continue end if k then j=crypt.base64decode(j)g[i]=j end local l,m=loadstring(j,
i)assert(l,`Failed to load {i}: {m}`)h[i]=l(...)end return h end function e:
LoadModules(g,h)for i,j in next,g do local k=j.Init if not k then continue end j
:Init(h)end end function e:CreateFont(g,h)if not h then return end local i=`assets/{
g}.json`local j,k=self:MakePath(i),{name=g,faces={{name='Regular',weight=400,
style='Normal',assetId=h}}}local l=f:JSONEncode(k)writefile(j,l)return j end
function e:CompileModule(g)local h='local Libraries = {'for i,j in g do if
typeof(j)~='string'then continue end h..=`\t{i} = (function()\n{j}\nend)(),\n`
end h..='}'return h end function e:MakeActorScript(g,h)local i=e:CompileModule(g
)i..='\tlocal ExtraData = {\n\t\tIsActor = true\n\t}\n\t'i..=`Libraries.Hook:BeginService(Libraries, ExtraData, {
h})`return i end return e end)()e:PushConfig(a)e:Init{Services=d}local f=e.
FolderName local g,h={Config=e:GetModule(`{f}/Config`,'Config'),ReturnSpoofs=e:
GetModule(`{f}/Return spoofs`,'Return Spoofs'),Configuration=a,Files=e,Process={
'base64',
[[dHlwZSB0YWJsZSA9IHsKICAgIFthbnldOiBhbnkKfQoKdHlwZSBSZW1vdGVEYXRhID0gewoJUmVtb3RlOiBJbnN0YW5jZSwKICAgIE5vQmFja3RyYWNlOiBib29sZWFuPywKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglBcmdzOiB0YWJsZSwKICAgIElkOiBzdHJpbmcsCglNZXRob2Q6IHN0cmluZywKICAgIFRyYW5zZmVyVHlwZTogc3RyaW5nLAoJVmFsdWVSZXBsYWNlbWVudHM6IHRhYmxlLAogICAgUmV0dXJuVmFsdWVzOiB0YWJsZSwKICAgIE9yaWdpbmFsRnVuYzogKEluc3RhbmNlLCAuLi5hbnkpIC0+IC4uLmFueQp9CgotLS8vIE1vZHVsZQpsb2NhbCBQcm9jZXNzID0gewogICAgLS0vLyBSZW1vdGUgY2xhc3NlcwogICAgUmVtb3RlQ2xhc3NEYXRhID0gewogICAgICAgIFsiUmVtb3RlRXZlbnQiXSA9IHsKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJGaXJlU2VydmVyIiwKICAgICAgICAgICAgICAgICJmaXJlU2VydmVyIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgUmVjZWl2ZSA9IHsKICAgICAgICAgICAgICAgICJPbkNsaWVudEV2ZW50IiwKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgWyJSZW1vdGVGdW5jdGlvbiJdID0gewogICAgICAgICAgICBJc1JlbW90ZUZ1bmN0aW9uID0gdHJ1ZSwKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJJbnZva2VTZXJ2ZXIiLAogICAgICAgICAgICAgICAgImludm9rZVNlcnZlciIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIFJlY2VpdmUgPSB7CiAgICAgICAgICAgICAgICAiT25DbGllbnRJbnZva2UiLAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBbIlVucmVsaWFibGVSZW1vdGVFdmVudCJdID0gewogICAgICAgICAgICBTZW5kID0gewogICAgICAgICAgICAgICAgIkZpcmVTZXJ2ZXIiLAogICAgICAgICAgICAgICAgImZpcmVTZXJ2ZXIiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBSZWNlaXZlID0gewogICAgICAgICAgICAgICAgIk9uQ2xpZW50RXZlbnQiLAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBbIkJpbmRhYmxlRXZlbnQiXSA9IHsKICAgICAgICAgICAgTm9SZWNpdmVIb29rID0gdHJ1ZSwKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJGaXJlIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgUmVjZWl2ZSA9IHsKICAgICAgICAgICAgICAgICJFdmVudCIsCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIFsiQmluZGFibGVGdW5jdGlvbiJdID0gewogICAgICAgICAgICBJc1JlbW90ZUZ1bmN0aW9uID0gdHJ1ZSwKICAgICAgICAgICAgTm9SZWNpdmVIb29rID0gdHJ1ZSwKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJJbnZva2UiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBSZWNlaXZlID0gewogICAgICAgICAgICAgICAgIk9uSW52b2tlIiwKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBSZW1vdGVPcHRpb25zID0ge30sCiAgICBMb29waW5nUmVtb3RlcyA9IHt9LAogICAgQ29uZmlnT3ZlcndyaXRlcyA9IHsKICAgICAgICBbeyJzaXJodXJ0IiwgInBvdGFzc2l1bSIsICJ3YXZlIn1dID0gewogICAgICAgICAgICBGb3JjZVVzZUN1c3RvbUNvbW0gPSB0cnVlCiAgICAgICAgfQogICAgfQp9CgotLS8vIE1vZHVsZXMKbG9jYWwgSG9vawpsb2NhbCBDb21tdW5pY2F0aW9uCmxvY2FsIFJldHVyblNwb29mcwpsb2NhbCBVaQpsb2NhbCBDb25maWcKCi0tLy8gU2VydmljZXMKbG9jYWwgSHR0cFNlcnZpY2U6IEh0dHBTZXJ2aWNlCgotLS8vIENvbW11bmljYXRpb24gY2hhbm5lbApsb2NhbCBDaGFubmVsCmxvY2FsIFdyYXBwZWRDaGFubmVsID0gZmFsc2UKCmxvY2FsIFNpZ21hRU5WID0gZ2V0ZmVudigxKQoKZnVuY3Rpb24gUHJvY2VzczpNZXJnZShCYXNlOiB0YWJsZSwgTmV3OiB0YWJsZSkKICAgIGlmIG5vdCBOZXcgdGhlbiByZXR1cm4gZW5kCglmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBOZXcgZG8KCQlCYXNlW0tleV0gPSBWYWx1ZQoJZW5kCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpJbml0KERhdGEpCiAgICBsb2NhbCBNb2R1bGVzID0gRGF0YS5Nb2R1bGVzCiAgICBsb2NhbCBTZXJ2aWNlcyA9IERhdGEuU2VydmljZXMKCiAgICAtLS8vIFNlcnZpY2VzCiAgICBIdHRwU2VydmljZSA9IFNlcnZpY2VzLkh0dHBTZXJ2aWNlCgogICAgLS0vLyBNb2R1bGVzCiAgICBDb25maWcgPSBNb2R1bGVzLkNvbmZpZwogICAgVWkgPSBNb2R1bGVzLlVpCiAgICBIb29rID0gTW9kdWxlcy5Ib29rCiAgICBDb21tdW5pY2F0aW9uID0gTW9kdWxlcy5Db21tdW5pY2F0aW9uCiAgICBSZXR1cm5TcG9vZnMgPSBNb2R1bGVzLlJldHVyblNwb29mcwplbmQKCi0tLy8gQ29tbXVuaWNhdGlvbgpmdW5jdGlvbiBQcm9jZXNzOlNldENoYW5uZWwoTmV3Q2hhbm5lbDogQmluZGFibGVFdmVudCwgSXNXcmFwcGVkOiBib29sZWFuKQogICAgQ2hhbm5lbCA9IE5ld0NoYW5uZWwKICAgIFdyYXBwZWRDaGFubmVsID0gSXNXcmFwcGVkCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpHZXRDb25maWdPdmVyd3JpdGVzKE5hbWU6IHN0cmluZykKICAgIGxvY2FsIENvbmZpZ092ZXJ3cml0ZXMgPSBzZWxmLkNvbmZpZ092ZXJ3cml0ZXMKCiAgICBmb3IgTGlzdCwgT3ZlcndyaXRlcyBpbiBuZXh0LCBDb25maWdPdmVyd3JpdGVzIGRvCiAgICAgICAgaWYgbm90IHRhYmxlLmZpbmQoTGlzdCwgTmFtZSkgdGhlbiBjb250aW51ZSBlbmQKICAgICAgICByZXR1cm4gT3ZlcndyaXRlcwogICAgZW5kCiAgICByZXR1cm4KZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrQ29uZmlnKENvbmZpZzogdGFibGUpCiAgICBsb2NhbCBOYW1lID0gaWRlbnRpZnlleGVjdXRvcigpOmxvd2VyKCkKCiAgICAtLS8vIEZvcmNlIGNvbmZpZ3VyYXRpb24gb3ZlcndyaXRlcyBmb3Igc3BlY2lmaWMgZXhlY3V0b3JzCiAgICBsb2NhbCBPdmVyd3JpdGVzID0gc2VsZjpHZXRDb25maWdPdmVyd3JpdGVzKE5hbWUpCiAgICBpZiBub3QgT3ZlcndyaXRlcyB0aGVuIHJldHVybiBlbmQKCiAgICBzZWxmOk1lcmdlKENvbmZpZywgT3ZlcndyaXRlcykKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkNsZWFuQ0Vycm9yKEVycm9yOiBzdHJpbmcpOiBzdHJpbmcKICAgIEVycm9yID0gRXJyb3I6Z3N1YigiOiVkKzogIiwgIiIpCiAgICBFcnJvciA9IEVycm9yOmdzdWIoIiwgZ290ICVhKyIsICIiKQogICAgRXJyb3IgPSBFcnJvcjpnc3ViKCJpbnZhbGlkIGFyZ3VtZW50IiwgIm1pc3NpbmcgYXJndW1lbnQiKQogICAgcmV0dXJuIEVycm9yCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpDb3VudE1hdGNoZXMoU3RyaW5nOiBzdHJpbmcsIE1hdGNoOiBzdHJpbmcpOiBudW1iZXIKCWxvY2FsIENvdW50ID0gMAoJZm9yIF8gaW4gU3RyaW5nOmdtYXRjaChNYXRjaCkgZG8KCQlDb3VudCArPTEgCgllbmQKCglyZXR1cm4gQ291bnQKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrVmFsdWUoVmFsdWUsIElnbm9yZTogdGFibGU/LCBDYWNoZTogdGFibGU/KQogICAgbG9jYWwgVHlwZSA9IHR5cGVvZihWYWx1ZSkKICAgIENvbW11bmljYXRpb246V2FpdENoZWNrKCkKICAgIAogICAgaWYgVHlwZSA9PSAidGFibGUiIHRoZW4KICAgICAgICBWYWx1ZSA9IHNlbGY6RGVlcENsb25lVGFibGUoVmFsdWUsIElnbm9yZSwgQ2FjaGUpCiAgICBlbHNlaWYgVHlwZSA9PSAiSW5zdGFuY2UiIHRoZW4KICAgICAgICBWYWx1ZSA9IGNsb25lcmVmKFZhbHVlKQogICAgZW5kCiAgICAKICAgIHJldHVybiBWYWx1ZQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6RGVlcENsb25lVGFibGUoVGFibGUsIElnbm9yZTogdGFibGU/LCBWaXNpdGVkOiB0YWJsZT8pOiB0YWJsZQogICAgaWYgdHlwZW9mKFRhYmxlKSB+PSAidGFibGUiIHRoZW4gcmV0dXJuIFRhYmxlIGVuZAogICAgbG9jYWwgQ2FjaGUgPSBWaXNpdGVkIG9yIHt9CgogICAgLS0vLyBDaGVjayBmb3IgY2FjaGVkCiAgICBpZiBDYWNoZVtUYWJsZV0gdGhlbgogICAgICAgIHJldHVybiBDYWNoZVtUYWJsZV0KICAgIGVuZAoKICAgIGxvY2FsIE5ldyA9IHt9CiAgICBDYWNoZVtUYWJsZV0gPSBOZXcKCiAgICBmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBUYWJsZSBkbwogICAgICAgIC0tLy8gQ2hlY2sgaWYgdGhlIHZhbHVlIGlzIGlnbm9yZWQKICAgICAgICBpZiBJZ25vcmUgYW5kIHRhYmxlLmZpbmQoSWdub3JlLCBWYWx1ZSkgdGhlbiBjb250aW51ZSBlbmQKICAgICAgICAKICAgICAgICBLZXkgPSBzZWxmOkNoZWNrVmFsdWUoS2V5LCBJZ25vcmUsIENhY2hlKQogICAgICAgIE5ld1tLZXldID0gc2VsZjpDaGVja1ZhbHVlKFZhbHVlLCBJZ25vcmUsIENhY2hlKQogICAgZW5kCgogICAgLS0vLyBNYXN0ZXIgY2xlYXIKICAgIGlmIG5vdCBWaXNpdGVkIHRoZW4KICAgICAgICB0YWJsZS5jbGVhcihDYWNoZSkKICAgIGVuZAogICAgCiAgICByZXR1cm4gTmV3CmVuZAoKZnVuY3Rpb24gUHJvY2VzczpVbnBhY2soVGFibGU6IHRhYmxlKQogICAgaWYgbm90IFRhYmxlIHRoZW4gcmV0dXJuIFRhYmxlIGVuZAoJbG9jYWwgTGVuZ3RoID0gdGFibGUubWF4bihUYWJsZSkKCXJldHVybiB1bnBhY2soVGFibGUsIDEsIExlbmd0aCkKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlB1c2hDb25maWcoT3ZlcndyaXRlcykKICAgIHNlbGY6TWVyZ2Uoc2VsZiwgT3ZlcndyaXRlcykKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkZ1bmNFeGlzdHMoTmFtZTogc3RyaW5nKQoJcmV0dXJuIFNpZ21hRU5WW05hbWVdCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpDaGVja0V4ZWN1dG9yKCk6IGJvb2xlYW4KICAgIGxvY2FsIEJsYWNrbGlzdGVkID0gewogICAgICAgICJ4ZW5vIiwKICAgICAgICAic29sYXJhIiwKICAgICAgICAiampzcGxvaXQiCiAgICB9CgogICAgbG9jYWwgTmFtZSA9IGlkZW50aWZ5ZXhlY3V0b3IoKTpsb3dlcigpCiAgICBsb2NhbCBJc0JsYWNrbGlzdGVkID0gdGFibGUuZmluZChCbGFja2xpc3RlZCwgTmFtZSkKCiAgICAtLS8vIFNvbWUgZXhlY3V0b3JzIGhhdmUgYnJva2VuIGZ1bmN0aW9uYWxpdHkKICAgIGlmIElzQmxhY2tsaXN0ZWQgdGhlbgogICAgICAgIFVpOlNob3dVbnN1cHBvcnRlZEV4ZWN1dG9yKE5hbWUpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKCiAgICByZXR1cm4gdHJ1ZQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6Q2hlY2tGdW5jdGlvbnMoKTogYm9vbGVhbgogICAgbG9jYWwgQ29yZUZ1bmN0aW9ucyA9IHsKICAgICAgICAiaG9va21ldGFtZXRob2QiLAogICAgICAgICJob29rZnVuY3Rpb24iLAogICAgICAgICJnZXRyYXdtZXRhdGFibGUiLAogICAgICAgICJzZXRyZWFkb25seSIKICAgIH0KCiAgICAtLS8vIENoZWNrIGlmIHRoZSBmdW5jdGlvbnMgZXhpc3QgaW4gdGhlIEVOVgogICAgZm9yIF8sIE5hbWUgaW4gQ29yZUZ1bmN0aW9ucyBkbwogICAgICAgIGxvY2FsIEZ1bmMgPSBzZWxmOkZ1bmNFeGlzdHMoTmFtZSkKICAgICAgICBpZiBGdW5jIHRoZW4gY29udGludWUgZW5kCgogICAgICAgIC0tLy8gRnVuY3Rpb24gbWlzc2luZyEKICAgICAgICBVaTpTaG93VW5zdXBwb3J0ZWQoTmFtZSkKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAoKICAgIHJldHVybiB0cnVlCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpDaGVja0lzU3VwcG9ydGVkKCk6IGJvb2xlYW4KICAgIC0tLy8gQ2hlY2sgaWYgdGhlIGV4ZWN1dG9yIGlzIGJsYWNrbGlzdGVkCiAgICBsb2NhbCBFeGVjdXRvclN1cHBvcnRlZCA9IHNlbGY6Q2hlY2tFeGVjdXRvcigpCiAgICBpZiBub3QgRXhlY3V0b3JTdXBwb3J0ZWQgdGhlbgogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgLS0vLyBDaGVjayBpZiB0aGUgY29yZSBmdW5jdGlvbnMgZXhpc3QKICAgIGxvY2FsIEZ1bmN0aW9uc1N1cHBvcnRlZCA9IHNlbGY6Q2hlY2tGdW5jdGlvbnMoKQogICAgaWYgbm90IEZ1bmN0aW9uc1N1cHBvcnRlZCB0aGVuCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKCiAgICByZXR1cm4gdHJ1ZQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6R2V0Q2xhc3NEYXRhKFJlbW90ZTogSW5zdGFuY2UpOiB0YWJsZT8KICAgIGxvY2FsIFJlbW90ZUNsYXNzRGF0YSA9IHNlbGYuUmVtb3RlQ2xhc3NEYXRhCiAgICBsb2NhbCBDbGFzc05hbWUgPSBIb29rOkluZGV4KFJlbW90ZSwgIkNsYXNzTmFtZSIpCgogICAgcmV0dXJuIFJlbW90ZUNsYXNzRGF0YVtDbGFzc05hbWVdCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpJc1Byb3RlY3RlZFJlbW90ZShSZW1vdGU6IEluc3RhbmNlKTogYm9vbGVhbgogICAgbG9jYWwgSXNEZWJ1ZyA9IFJlbW90ZSA9PSBDb21tdW5pY2F0aW9uLkRlYnVnSWRSZW1vdGUKICAgIGxvY2FsIElzQ2hhbm5lbCA9IFJlbW90ZSA9PSAoV3JhcHBlZENoYW5uZWwgYW5kIENoYW5uZWwuQ2hhbm5lbCBvciBDaGFubmVsKQoKICAgIHJldHVybiBJc0RlYnVnIG9yIElzQ2hhbm5lbAplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6UmVtb3RlQWxsb3dlZChSZW1vdGU6IEluc3RhbmNlLCBUcmFuc2ZlclR5cGU6IHN0cmluZywgTWV0aG9kOiBzdHJpbmc/KTogYm9vbGVhbj8KICAgIGlmIHR5cGVvZihSZW1vdGUpIH49ICdJbnN0YW5jZScgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIC0tLy8gQ2hlY2sgaWYgdGhlIFJlbW90ZSBpcyBwcm90ZWN0ZWQKICAgIGlmIHNlbGY6SXNQcm90ZWN0ZWRSZW1vdGUoUmVtb3RlKSB0aGVuIHJldHVybiBlbmQKCiAgICAtLS8vIEZldGNoIGNsYXNzIHRhYmxlCglsb2NhbCBDbGFzc0RhdGEgPSBzZWxmOkdldENsYXNzRGF0YShSZW1vdGUpCglpZiBub3QgQ2xhc3NEYXRhIHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tLy8gQ2hlY2sgaWYgdGhlIHRyYW5zZmVyIHR5cGUgaGFzIGRhdGEKCWxvY2FsIEFsbG93ZWQgPSBDbGFzc0RhdGFbVHJhbnNmZXJUeXBlXQoJaWYgbm90IEFsbG93ZWQgdGhlbiByZXR1cm4gZW5kCgogICAgLS0vLyBDaGVjayBpZiB0aGUgbWV0aG9kIGlzIGFsbG93ZWQKCWlmIE1ldGhvZCB0aGVuCgkJcmV0dXJuIHRhYmxlLmZpbmQoQWxsb3dlZCwgTWV0aG9kKSB+PSBuaWwKCWVuZAoKCXJldHVybiB0cnVlCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpTZXRFeHRyYURhdGEoRGF0YTogdGFibGUpCiAgICBpZiBub3QgRGF0YSB0aGVuIHJldHVybiBlbmQKICAgIHNlbGYuRXh0cmFEYXRhID0gRGF0YQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6R2V0UmVtb3RlU3Bvb2YoUmVtb3RlOiBJbnN0YW5jZSwgTWV0aG9kOiBzdHJpbmcsIC4uLik6IHRhYmxlPwogICAgbG9jYWwgU3Bvb2YgPSBSZXR1cm5TcG9vZnNbUmVtb3RlXQoKICAgIGlmIG5vdCBTcG9vZiB0aGVuIHJldHVybiBlbmQKICAgIGlmIFNwb29mLk1ldGhvZCB+PSBNZXRob2QgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgUmV0dXJuVmFsdWVzID0gU3Bvb2YuUmV0dXJuCgogICAgLS0vLyBDYWxsIHRoZSBSZXR1cm5WYWx1ZXMgZnVuY3Rpb24gdHlwZQogICAgaWYgdHlwZW9mKFJldHVyblZhbHVlcykgPT0gImZ1bmN0aW9uIiB0aGVuCiAgICAgICAgUmV0dXJuVmFsdWVzID0gUmV0dXJuVmFsdWVzKC4uLikKICAgIGVuZAoKCXJldHVybiBSZXR1cm5WYWx1ZXMKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlNldE5ld1JldHVyblNwb29mcyhOZXdSZXR1cm5TcG9vZnM6IHRhYmxlKQogICAgUmV0dXJuU3Bvb2ZzID0gTmV3UmV0dXJuU3Bvb2ZzCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpGaW5kQ2FsbGluZ0xDbG9zdXJlKE9mZnNldDogbnVtYmVyKQogICAgbG9jYWwgR2V0ZmVudiA9IEhvb2s6R2V0T3JpZ2luYWxGdW5jKGdldGZlbnYpCiAgICBPZmZzZXQgKz0gMQoKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICBPZmZzZXQgKz0gMQoKICAgICAgICAtLS8vIENoZWNrIGlmIHRoZSBzdGFjayBsZXZlbCBpcyB2YWxpZAogICAgICAgIGxvY2FsIElzVmFsaWQgPSBkZWJ1Zy5pbmZvKE9mZnNldCwgImwiKSB+PSAtMQogICAgICAgIGlmIG5vdCBJc1ZhbGlkIHRoZW4gY29udGludWUgZW5kCgogICAgICAgIC0tLy8gQ2hlY2sgaWYgdGhlIGZ1bmN0aW9uIGlzIHZhbGlkCiAgICAgICAgbG9jYWwgRnVuY3Rpb24gPSBkZWJ1Zy5pbmZvKE9mZnNldCwgImYiKQogICAgICAgIGlmIG5vdCBGdW5jdGlvbiB0aGVuIHJldHVybiBlbmQKICAgICAgICBpZiBHZXRmZW52KEZ1bmN0aW9uKSA9PSBTaWdtYUVOViB0aGVuIGNvbnRpbnVlIGVuZAoKICAgICAgICByZXR1cm4gRnVuY3Rpb24KICAgIGVuZAplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6RGVjb21waWxlKFNjcmlwdDogTG9jYWxTY3JpcHQgfCBNb2R1bGVTY3JpcHQpOiBzdHJpbmcKICAgIGxvY2FsIEtvbnN0YW50QVBJID0gImh0dHA6Ly9hcGkucGx1c2dpYW50NS5jb20va29uc3RhbnQvZGVjb21waWxlIgogICAgbG9jYWwgRm9yY2VLb25zdGFudCA9IENvbmZpZy5Gb3JjZUtvbnN0YW50RGVjb21waWxlcgoKICAgIC0tLy8gVXNlIGJ1aWx0LWluIGRlY29tcGlsZXIgaWYgdGhlIGV4ZWN1dG9yIHN1cHBvcnRzIGl0CiAgICBpZiBkZWNvbXBpbGUgYW5kIG5vdCBGb3JjZUtvbnN0YW50IHRoZW4gCiAgICAgICAgcmV0dXJuIGRlY29tcGlsZShTY3JpcHQpCiAgICBlbmQKCiAgICAtLS8vIGdldHNjcmlwdGJ5dGVjb2RlCiAgICBsb2NhbCBTdWNjZXNzLCBCeXRlY29kZSA9IHBjYWxsKGdldHNjcmlwdGJ5dGVjb2RlLCBTY3JpcHQpCiAgICBpZiBub3QgU3VjY2VzcyB0aGVuCiAgICAgICAgbG9jYWwgRXJyb3IgPSBgLS1GYWlsZWQgdG8gZ2V0IHNjcmlwdCBieXRlY29kZSwgZXJyb3I6XG5gCiAgICAgICAgRXJyb3IgLi49IGBcbi0tW1tcbntCeXRlY29kZX1cbl1dYAogICAgICAgIHJldHVybiBFcnJvciwgdHJ1ZQogICAgZW5kCiAgICAKICAgIC0tLy8gU2VuZCBQT1NUIHJlcXVlc3QgdG8gdGhlIEFQSQogICAgbG9jYWwgUmVzcG9uY2UgPSByZXF1ZXN0KHsKICAgICAgICBVcmwgPSBLb25zdGFudEFQSSwKICAgICAgICBCb2R5ID0gQnl0ZWNvZGUsCiAgICAgICAgTWV0aG9kID0gIlBPU1QiLAogICAgICAgIEhlYWRlcnMgPSB7CiAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAidGV4dC9wbGFpbiIKICAgICAgICB9LAogICAgfSkKCiAgICAtLS8vIEVycm9yIGNoZWNrCiAgICBpZiBSZXNwb25jZS5TdGF0dXNDb2RlIH49IDIwMCB0aGVuCiAgICAgICAgbG9jYWwgRXJyb3IgPSBgLS1bS09OU1RBTlRdIEVycm9yIG9jY3VyZWQgd2hpbGUgcmVxdWVzdGluZyB0aGUgQVBJLCBlcnJvcjpcbmAKICAgICAgICBFcnJvciAuLj0gYFxuLS1bW1xue1Jlc3BvbmNlLkJvZHl9XG5dXWAKICAgICAgICByZXR1cm4gRXJyb3IsIHRydWUKICAgIGVuZAoKICAgIHJldHVybiBSZXNwb25jZS5Cb2R5CmVuZAoKZnVuY3Rpb24gUHJvY2VzczpHZXRTY3JpcHRGcm9tRnVuYyhGdW5jOiAoLi4uYW55KSAtPiAuLi5hbnkpCiAgICBpZiBub3QgRnVuYyB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBTdWNjZXNzLCBFTlYgPSBwY2FsbChnZXRmZW52LCBGdW5jKQogICAgaWYgbm90IFN1Y2Nlc3MgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIC0tLy8gQmxhY2tsaXN0IHNpZ21hIHNweQogICAgaWYgc2VsZjpJc1NpZ21hU3B5RU5WKEVOVikgdGhlbiByZXR1cm4gZW5kCgogICAgcmV0dXJuIHJhd2dldChFTlYsICJzY3JpcHQiKQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6Q29ubmVjdGlvbklzVmFsaWQoQ29ubmVjdGlvbjogdGFibGUpOiBib29sZWFuCiAgICBsb2NhbCBWYWx1ZVJlcGxhY2VtZW50cyA9IHsKCQlbIlNjcmlwdCJdID0gZnVuY3Rpb24oQ29ubmVjdGlvbjogdGFibGUpOiBTY3JpcHQ/CgkJCWxvY2FsIEZ1bmN0aW9uID0gQ29ubmVjdGlvbi5GdW5jdGlvbgoJCQlpZiBub3QgRnVuY3Rpb24gdGhlbiByZXR1cm4gZW5kCgoJCQlyZXR1cm4gc2VsZjpHZXRTY3JpcHRGcm9tRnVuYyhGdW5jdGlvbikKCQllbmQKCX0KCiAgICAtLS8vIENoZWNrIGlmIHRoZXNlIHByb3BlcnRpZXMgYXJlIHZhbGlkCiAgICBsb2NhbCBUb0NoZWNrID0gewogICAgICAgICJTY3JpcHQiCiAgICB9CiAgICBmb3IgXywgUHJvcGVydHkgaW4gVG9DaGVjayBkbwogICAgICAgIGxvY2FsIFJlcGxhY2VtZW50ID0gVmFsdWVSZXBsYWNlbWVudHNbUHJvcGVydHldCiAgICAgICAgbG9jYWwgVmFsdWUKCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGVyZSdzIGEgZnVuY3Rpb24gZm9yIGEgcHJvcGVydHkKICAgICAgICBpZiBSZXBsYWNlbWVudCB0aGVuCiAgICAgICAgICAgIFZhbHVlID0gUmVwbGFjZW1lbnQoQ29ubmVjdGlvbikKICAgICAgICBlbmQKCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGUgcHJvcGVydHkgaGFzIGEgdmFsdWUKICAgICAgICBpZiBWYWx1ZSA9PSBuaWwgdGhlbiAKICAgICAgICAgICAgcmV0dXJuIGZhbHNlIAogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIHRydWUKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkZpbHRlckNvbm5lY3Rpb25zKFNpZ25hbDogUkJYU2NyaXB0U2lnbmFsKTogdGFibGUKICAgIGxvY2FsIFByb2Nlc3NlZCA9IHt9CgogICAgLS0vLyBGaWx0ZXIgZWFjaCBjb25uZWN0aW9uCiAgICBmb3IgXywgQ29ubmVjdGlvbiBpbiBnZXRjb25uZWN0aW9ucyhTaWduYWwpIGRvCiAgICAgICAgaWYgbm90IHNlbGY6Q29ubmVjdGlvbklzVmFsaWQoQ29ubmVjdGlvbikgdGhlbiBjb250aW51ZSBlbmQKICAgICAgICB0YWJsZS5pbnNlcnQoUHJvY2Vzc2VkLCBDb25uZWN0aW9uKQogICAgZW5kCgogICAgcmV0dXJuIFByb2Nlc3NlZAplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6SXNTaWdtYVNweUVOVihFbnY6IHRhYmxlKTogYm9vbGVhbgogICAgcmV0dXJuIEVudiA9PSBTaWdtYUVOVgplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6R2V0UmVtb3RlRGF0YShJZDogc3RyaW5nKQogICAgbG9jYWwgUmVtb3RlT3B0aW9ucyA9IHNlbGYuUmVtb3RlT3B0aW9ucwoKICAgIC0tLy8gQ2hlY2sgZm9yIGV4aXN0aW5nIHJlbW90ZSBkYXRhCglsb2NhbCBFeGlzdGluZyA9IFJlbW90ZU9wdGlvbnNbSWRdCglpZiBFeGlzdGluZyB0aGVuIHJldHVybiBFeGlzdGluZyBlbmQKCQogICAgLS0vLyBCYXNlIHJlbW90ZSBkYXRhCglsb2NhbCBEYXRhID0gewoJCUV4Y2x1ZGVkID0gZmFsc2UsCgkJQmxvY2tlZCA9IGZhbHNlCgl9CgoJUmVtb3RlT3B0aW9uc1tJZF0gPSBEYXRhCglyZXR1cm4gRGF0YQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6Q2FsbERpc2NvcmRSUEMoQm9keTogdGFibGUpCiAgICByZXF1ZXN0KHsKICAgICAgICBVcmwgPSAiaHR0cDovLzEyNy4wLjAuMTo2NDYzL3JwYz92PTEiLAogICAgICAgIE1ldGhvZCA9ICJQT1NUIiwKICAgICAgICBIZWFkZXJzID0gewogICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICBbIk9yaWdpbiJdID0gImh0dHBzOi8vZGlzY29yZC5jb20vIgogICAgICAgIH0sCiAgICAgICAgQm9keSA9IEh0dHBTZXJ2aWNlOkpTT05FbmNvZGUoQm9keSkKICAgIH0pCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpQcm9tcHREaXNjb3JkSW52aXRlKEludml0ZUNvZGU6IHN0cmluZykKICAgIHNlbGY6Q2FsbERpc2NvcmRSUEMoewogICAgICAgIGNtZCA9ICJJTlZJVEVfQlJPV1NFUiIsCiAgICAgICAgbm9uY2UgPSBIdHRwU2VydmljZTpHZW5lcmF0ZUdVSUQoZmFsc2UpLAogICAgICAgIGFyZ3MgPSB7CiAgICAgICAgICAgIGNvZGUgPSBJbnZpdGVDb2RlCiAgICAgICAgfQogICAgfSkKZW5kCgpsb2NhbCBQcm9jZXNzQ2FsbGJhY2sgPSBuZXdjY2xvc3VyZShmdW5jdGlvbihEYXRhOiBSZW1vdGVEYXRhLCBSZW1vdGUsIC4uLik6IHRhYmxlPwogICAgLS0vLyBVbnBhY2sgRGF0YQogICAgbG9jYWwgT3JpZ2luYWxGdW5jID0gRGF0YS5PcmlnaW5hbEZ1bmMKICAgIGxvY2FsIElkID0gRGF0YS5JZAogICAgbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKCiAgICAtLS8vIENoZWNrIGlmIHRoZSBSZW1vdGUgaXMgQmxvY2tlZAogICAgbG9jYWwgUmVtb3RlRGF0YSA9IFByb2Nlc3M6R2V0UmVtb3RlRGF0YShJZCkKICAgIGlmIFJlbW90ZURhdGEuQmxvY2tlZCB0aGVuIHJldHVybiB7fSBlbmQKCiAgICAtLS8vIENoZWNrIGZvciBhIHNwb29mCiAgICBsb2NhbCBTcG9vZiA9IFByb2Nlc3M6R2V0UmVtb3RlU3Bvb2YoUmVtb3RlLCBNZXRob2QsIE9yaWdpbmFsRnVuYywgLi4uKQogICAgaWYgU3Bvb2YgdGhlbiByZXR1cm4gU3Bvb2YgZW5kCgogICAgLS0vLyBDaGVjayBpZiB0aGUgb3JpZ25hbCBmdW5jdGlvbiB3YXMgcGFzc2VkCiAgICBpZiBub3QgT3JpZ2luYWxGdW5jIHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tLy8gSW52b2tlIG9yaWduYWwgZnVuY3Rpb24KICAgIHJldHVybiB7CiAgICAgICAgT3JpZ2luYWxGdW5jKFJlbW90ZSwgLi4uKQogICAgfQplbmQpCgpmdW5jdGlvbiBQcm9jZXNzOlByb2Nlc3NSZW1vdGUoRGF0YTogUmVtb3RlRGF0YSwgUmVtb3RlLCAuLi4pOiB0YWJsZT8KICAgIC0tLy8gVW5wYWNrIERhdGEKCWxvY2FsIE1ldGhvZCA9IERhdGEuTWV0aG9kCiAgICBsb2NhbCBUcmFuc2ZlclR5cGUgPSBEYXRhLlRyYW5zZmVyVHlwZQogICAgbG9jYWwgSXNSZWNlaXZlID0gRGF0YS5Jc1JlY2VpdmUKCgktLS8vIENoZWNrIGlmIHRoZSB0cmFuc2ZlcnR5cGUgbWV0aG9kIGlzIGFsbG93ZWQKCWlmIFRyYW5zZmVyVHlwZSBhbmQgbm90IHNlbGY6UmVtb3RlQWxsb3dlZChSZW1vdGUsIFRyYW5zZmVyVHlwZSwgTWV0aG9kKSB0aGVuIHJldHVybiBlbmQKCiAgICAtLS8vIEZldGNoIGRldGFpbHMKICAgIGxvY2FsIElkID0gQ29tbXVuaWNhdGlvbjpHZXREZWJ1Z0lkKFJlbW90ZSkKICAgIGxvY2FsIENsYXNzRGF0YSA9IHNlbGY6R2V0Q2xhc3NEYXRhKFJlbW90ZSkKICAgIGxvY2FsIFRpbWVzdGFtcCA9IHRpY2soKQoKICAgIGxvY2FsIENhbGxpbmdGdW5jdGlvbgogICAgbG9jYWwgU291cmNlU2NyaXB0CgogICAgLS0vLyBBZGQgZXh0cmEgZGF0YSBpbnRvIHRoZSBsb2cgaWYgbmVlZGVkCiAgICBsb2NhbCBFeHRyYURhdGEgPSBzZWxmLkV4dHJhRGF0YQogICAgaWYgRXh0cmFEYXRhIHRoZW4KICAgICAgICBzZWxmOk1lcmdlKERhdGEsIEV4dHJhRGF0YSkKICAgIGVuZAoKICAgIC0tLy8gR2V0IGNhbGxlciBpbmZvcm1hdGlvbgogICAgaWYgbm90IElzUmVjZWl2ZSB0aGVuCiAgICAgICAgQ2FsbGluZ0Z1bmN0aW9uID0gc2VsZjpGaW5kQ2FsbGluZ0xDbG9zdXJlKDYpCiAgICAgICAgU291cmNlU2NyaXB0ID0gQ2FsbGluZ0Z1bmN0aW9uIGFuZCBzZWxmOkdldFNjcmlwdEZyb21GdW5jKENhbGxpbmdGdW5jdGlvbikgb3IgbmlsCiAgICBlbmQKCiAgICAtLS8vIEFkZCB0byBxdWV1ZQogICAgc2VsZjpNZXJnZShEYXRhLCB7CiAgICAgICAgUmVtb3RlID0gY2xvbmVyZWYoUmVtb3RlKSwKCQlDYWxsaW5nU2NyaXB0ID0gZ2V0Y2FsbGluZ3NjcmlwdCgpLAogICAgICAgIENhbGxpbmdGdW5jdGlvbiA9IENhbGxpbmdGdW5jdGlvbiwKICAgICAgICBTb3VyY2VTY3JpcHQgPSBTb3VyY2VTY3JpcHQsCiAgICAgICAgSWQgPSBJZCwKCQlDbGFzc0RhdGEgPSBDbGFzc0RhdGEsCiAgICAgICAgVGltZXN0YW1wID0gVGltZXN0YW1wLAogICAgICAgIEFyZ3MgPSB7Li4ufQogICAgfSkKCiAgICAtLS8vIEludm9rZSB0aGUgUmVtb3RlIGFuZCBsb2cgcmV0dXJuIHZhbHVlcwogICAgbG9jYWwgUmV0dXJuVmFsdWVzID0gUHJvY2Vzc0NhbGxiYWNrKERhdGEsIFJlbW90ZSwgLi4uKQogICAgRGF0YS5SZXR1cm5WYWx1ZXMgPSBSZXR1cm5WYWx1ZXMKCiAgICAtLS8vIFF1ZXVlIGxvZwogICAgQ29tbXVuaWNhdGlvbjpRdWV1ZUxvZyhEYXRhKQoKICAgIHJldHVybiBSZXR1cm5WYWx1ZXMKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlNldEFsbFJlbW90ZURhdGEoS2V5OiBzdHJpbmcsIFZhbHVlKQogICAgbG9jYWwgUmVtb3RlT3B0aW9ucyA9IHNlbGYuUmVtb3RlT3B0aW9ucwoJZm9yIFJlbW90ZUlELCBEYXRhIGluIG5leHQsIFJlbW90ZU9wdGlvbnMgZG8KCQlEYXRhW0tleV0gPSBWYWx1ZQoJZW5kCmVuZAoKLS0vLyBUaGUgY29tbXVuaWNhdGlvbiBjcmVhdGVzIGEgZGlmZmVyZW50IHRhYmxlIGFkZHJlc3MKLS0vLyBSZWNpdmVkIHRhYmxlcyB3aWxsIG5vdCBiZSB0aGUgc2FtZQpmdW5jdGlvbiBQcm9jZXNzOlNldFJlbW90ZURhdGEoSWQ6IHN0cmluZywgUmVtb3RlRGF0YTogdGFibGUpCiAgICBsb2NhbCBSZW1vdGVPcHRpb25zID0gc2VsZi5SZW1vdGVPcHRpb25zCiAgICBSZW1vdGVPcHRpb25zW0lkXSA9IFJlbW90ZURhdGEKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlVwZGF0ZVJlbW90ZURhdGEoSWQ6IHN0cmluZywgUmVtb3RlRGF0YTogdGFibGUpCiAgICBDb21tdW5pY2F0aW9uOkNvbW11bmljYXRlKCJSZW1vdGVEYXRhIiwgSWQsIFJlbW90ZURhdGEpCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpVcGRhdGVBbGxSZW1vdGVEYXRhKEtleTogc3RyaW5nLCBWYWx1ZSkKICAgIENvbW11bmljYXRpb246Q29tbXVuaWNhdGUoIkFsbFJlbW90ZURhdGEiLCBLZXksIFZhbHVlKQplbmQKCnJldHVybiBQcm9jZXNz]]
},Hook={'base64',
[[LS1bWwoKCVRha2luZyBteSBtZXRob2RzIPCfkpbwn5KWCglJIGxvdmUgYSBwYXN0ZXIgYW5kIGEgc2tpZCwgcHV0cyBkaXNndXN0IGluIG15IGZhY2UKCl1dCgpsb2NhbCBIb29rID0gewoJT3JpZ2luYWxOYW1lY2FsbCA9IG5pbCwKCU9yaWdpbmFsSW5kZXggPSBuaWwsCglQcmV2aW91c0Z1bmN0aW9ucyA9IHt9LAoJRGVmYXVsdENvbmZpZyA9IHsKCQlGdW5jdGlvblBhdGNoZXMgPSB0cnVlCgl9Cn0KCnR5cGUgdGFibGUgPSB7CglbYW55XTogYW55Cn0KCnR5cGUgTWV0YUZ1bmMgPSAoSW5zdGFuY2UsIC4uLmFueSkgLT4gLi4uYW55CnR5cGUgVW5rRnVuYyA9ICguLi5hbnkpIC0+IC4uLmFueQoKLS0vLyBNb2R1bGVzCmxvY2FsIE1vZHVsZXMKbG9jYWwgUHJvY2Vzcwpsb2NhbCBDb25maWd1cmF0aW9uCmxvY2FsIENvbmZpZwpsb2NhbCBDb21tdW5pY2F0aW9uCgpsb2NhbCBFeGVFTlYgPSBnZXRmZW52KDEpCgpmdW5jdGlvbiBIb29rOkluaXQoRGF0YSkKICAgIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKCglQcm9jZXNzID0gTW9kdWxlcy5Qcm9jZXNzCglDb21tdW5pY2F0aW9uID0gTW9kdWxlcy5Db21tdW5pY2F0aW9uIG9yIENvbW11bmljYXRpb24KCUNvbmZpZyA9IE1vZHVsZXMuQ29uZmlnIG9yIENvbmZpZwoJQ29uZmlndXJhdGlvbiA9IE1vZHVsZXMuQ29uZmlndXJhdGlvbiBvciBDb25maWd1cmF0aW9uCmVuZAoKLS0vLyBUaGUgY2FsbGJhY2sgaXMgZXhwZWN0ZWQgdG8gcmV0dXJuIGEgbmlsIHZhbHVlIHNvbWV0aW1lcyB3aGljaCBzaG91bGQgYmUgaW5nb3JlZApsb2NhbCBIb29rTWlkZGxlID0gbmV3Y2Nsb3N1cmUoZnVuY3Rpb24oT3JpZ2luYWxGdW5jLCBDYWxsYmFjaywgQWx3YXlzVGFibGU6IGJvb2xlYW4/LCAuLi4pCgktLS8vIEludm9rZSBjYWxsYmFjayBhbmQgY2hlY2sgZm9yIGEgcmVwb25jZSBvdGhlcndpc2UgaWdub3JlZAoJbG9jYWwgUmV0dXJuVmFsdWVzID0gQ2FsbGJhY2soLi4uKQoJaWYgUmV0dXJuVmFsdWVzIHRoZW4KCQktLS8vIFVucGFjawoJCWlmIG5vdCBBbHdheXNUYWJsZSB0aGVuCgkJCXJldHVybiBQcm9jZXNzOlVucGFjayhSZXR1cm5WYWx1ZXMpCgkJZW5kCgoJCS0tLy8gUmV0dXJuIHBhY2tlZCByZXNwb25jZQoJCXJldHVybiBSZXR1cm5WYWx1ZXMKCWVuZAoKCS0tLy8gUmV0dXJuIHBhY2tlZCByZXNwb25jZQoJaWYgQWx3YXlzVGFibGUgdGhlbgoJCXJldHVybiB7T3JpZ2luYWxGdW5jKC4uLil9CgllbmQKCgktLS8vIFVucGFja2VkCglyZXR1cm4gT3JpZ2luYWxGdW5jKC4uLikKZW5kKQoKbG9jYWwgZnVuY3Rpb24gTWVyZ2UoQmFzZTogdGFibGUsIE5ldzogdGFibGUpCglmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBOZXcgZG8KCQlCYXNlW0tleV0gPSBWYWx1ZQoJZW5kCmVuZAoKZnVuY3Rpb24gSG9vazpJbmRleChPYmplY3Q6IEluc3RhbmNlLCBLZXk6IHN0cmluZykKCXJldHVybiBPYmplY3RbS2V5XQplbmQKCmZ1bmN0aW9uIEhvb2s6UHVzaENvbmZpZyhPdmVyd3JpdGVzKQogICAgTWVyZ2Uoc2VsZiwgT3ZlcndyaXRlcykKZW5kCgotLS8vIGdldHJhd21ldGF0YWJsZQpmdW5jdGlvbiBIb29rOlJlcGxhY2VNZXRhTWV0aG9kKE9iamVjdDogSW5zdGFuY2UsIENhbGw6IHN0cmluZywgQ2FsbGJhY2s6IE1ldGFGdW5jKTogTWV0YUZ1bmMKCWxvY2FsIE1ldGF0YWJsZSA9IGdldHJhd21ldGF0YWJsZShPYmplY3QpCglsb2NhbCBPcmlnaW5hbEZ1bmMgPSBjbG9uZWZ1bmN0aW9uKE1ldGF0YWJsZVtDYWxsXSkKCQoJLS0vLyBSZXBsYWNlIGZ1bmN0aW9uCglzZXRyZWFkb25seShNZXRhdGFibGUsIGZhbHNlKQoJTWV0YXRhYmxlW0NhbGxdID0gbmV3Y2Nsb3N1cmUoZnVuY3Rpb24oLi4uKQoJCXJldHVybiBIb29rTWlkZGxlKE9yaWdpbmFsRnVuYywgQ2FsbGJhY2ssIGZhbHNlLCAuLi4pCgllbmQpCglzZXRyZWFkb25seShNZXRhdGFibGUsIHRydWUpCgoJcmV0dXJuIE9yaWdpbmFsRnVuYwplbmQKCi0tLy8gaG9va2Z1bmN0aW9uCmZ1bmN0aW9uIEhvb2s6SG9va0Z1bmN0aW9uKEZ1bmM6IFVua0Z1bmMsIENhbGxiYWNrOiBVbmtGdW5jKQoJbG9jYWwgT3JpZ2luYWxGdW5jCglsb2NhbCBXcmFwcGVkQ2FsbGJhY2sgPSBuZXdjY2xvc3VyZShDYWxsYmFjaykKCU9yaWdpbmFsRnVuYyA9IGNsb25lZnVuY3Rpb24oaG9va2Z1bmN0aW9uKEZ1bmMsIGZ1bmN0aW9uKC4uLikKCQlyZXR1cm4gSG9va01pZGRsZShPcmlnaW5hbEZ1bmMsIFdyYXBwZWRDYWxsYmFjaywgZmFsc2UsIC4uLikKCWVuZCkpCglyZXR1cm4gT3JpZ2luYWxGdW5jCmVuZAoKLS0vLyBob29rbWV0YW1ldGhvZApmdW5jdGlvbiBIb29rOkhvb2tNZXRhQ2FsbChPYmplY3Q6IEluc3RhbmNlLCBDYWxsOiBzdHJpbmcsIENhbGxiYWNrOiBNZXRhRnVuYyk6IE1ldGFGdW5jCglsb2NhbCBNZXRhdGFibGUgPSBnZXRyYXdtZXRhdGFibGUoT2JqZWN0KQoJbG9jYWwgVW5ob29rZWQKCQoJVW5ob29rZWQgPSBzZWxmOkhvb2tGdW5jdGlvbihNZXRhdGFibGVbQ2FsbF0sIGZ1bmN0aW9uKC4uLikKCQlyZXR1cm4gSG9va01pZGRsZShVbmhvb2tlZCwgQ2FsbGJhY2ssIHRydWUsIC4uLikKCWVuZCkKCXJldHVybiBVbmhvb2tlZAplbmQKCmZ1bmN0aW9uIEhvb2s6SG9va01ldGFNZXRob2QoT2JqZWN0OiBJbnN0YW5jZSwgQ2FsbDogc3RyaW5nLCBDYWxsYmFjazogTWV0YUZ1bmMpOiBNZXRhRnVuYwoJbG9jYWwgRnVuYyA9IG5ld2NjbG9zdXJlKENhbGxiYWNrKQoJCgktLS8vIEdldHJhd21ldGF0YWJsZQoJaWYgQ29uZmlnLlJlcGxhY2VNZXRhQ2FsbEZ1bmMgdGhlbgoJCXJldHVybiBzZWxmOlJlcGxhY2VNZXRhTWV0aG9kKE9iamVjdCwgQ2FsbCwgRnVuYykKCWVuZAoJCgktLS8vIEhvb2ttZXRhbWV0aG9kCglyZXR1cm4gc2VsZjpIb29rTWV0YUNhbGwoT2JqZWN0LCBDYWxsLCBGdW5jKQplbmQKCi0tLy8gVGhpcyBpbmNsdWRlcyBhIGZldyBwYXRjaGVzIGZvciBleGVjdXRvciBmdW5jdGlvbnMgdGhhdCByZXN1bHQgaW4gZGV0ZWN0aW9uCi0tLy8gVGhpcyBpc24ndCBidWxsZXRwcm9vZiBzaW5jZSBzb21lIGZ1bmN0aW9ucyBsaWtlIGhvb2tmdW5jdGlvbiBJIGNhbid0IHBhdGNoCi0tLy8gQnkgdGhlIHdheSwgdGhhbmtzIGZvciBjb3B5aW5nIHRoaXMgZ3V5cyEgU3VwZXIgYXBwcmVjaWF0ZSB0aGUgY29weWNhdApmdW5jdGlvbiBIb29rOlBhdGNoRnVuY3Rpb25zKCkKCS0tLy8gQ2hlY2sgaWYgdGhpcyBmdW5jdGlvbiBpcyBkaXNhYmxlZCBpbiB0aGUgY29uZmlndXJhdGlvbgoJaWYgQ29uZmlnLk5vRnVuY3Rpb25QYXRjaGluZyB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBQYXRjaGVzID0gewoJCS0tLy8gRXJyb3IgZGV0ZWN0aW9uIHBhdGNoCgkJLS0vLyBob29rZnVuY3Rpb24gbWF5IHN0aWxsIGJlIGRldGVjdGVkIGRlcGVuZGluZyBvbiB0aGUgZXhlY3V0b3IKCQlbcGNhbGxdID0gIGZ1bmN0aW9uKE9sZEZ1bmMsIEZ1bmMsIC4uLikKCQkJbG9jYWwgUmVzcG9uY2UgPSB7T2xkRnVuYyhGdW5jLCAuLi4pfQoJCQlsb2NhbCBTdWNjZXNzLCBFcnJvciA9IFJlc3BvbmNlWzFdLCBSZXNwb25jZVsyXQoJCQlsb2NhbCBJc0MgPSBpc2NjbG9zdXJlKEZ1bmMpCgoJCQktLS8vIFBhdGNoIGMtY2xvc3VyZSBlcnJvciBkZXRlY3Rpb24KCQkJaWYgU3VjY2VzcyA9PSBmYWxzZSBhbmQgSXNDIHRoZW4KCQkJCWxvY2FsIE5ld0Vycm9yID0gUHJvY2VzczpDbGVhbkNFcnJvcihFcnJvcikKCQkJCVJlc3BvbmNlWzJdID0gTmV3RXJyb3IKCQkJZW5kCgoJCQktLS8vIFN0YWNrLW92ZXJmbG93IGRldGVjdGlvbiBwYXRjaAoJCQlpZiBTdWNjZXNzID09IGZhbHNlIGFuZCBub3QgSXNDIGFuZCBFcnJvcjpmaW5kKCJDIHN0YWNrIG92ZXJmbG93IikgdGhlbgoJCQkJbG9jYWwgVHJhY2V0YWJsZSA9IEVycm9yOnNwbGl0KCI6IikKCQkJCWxvY2FsIENhbGxlciwgTGluZSA9IFRyYWNldGFibGVbMV0sIFRyYWNldGFibGVbMl0KCQkJCWxvY2FsIENvdW50ID0gUHJvY2VzczpDb3VudE1hdGNoZXMoRXJyb3IsIENhbGxlcikKCgkJCQlpZiBDb3VudCA9PSAxOTYgdGhlbgoJCQkJCUNvbW11bmljYXRpb246Q29uc29sZVByaW50KGBDIHN0YWNrIG92ZXJmbG93IHBhdGNoZWQsIGNvdW50IHdhcyB7Q291bnR9YCkKCQkJCQlSZXNwb25jZVsyXSA9IEVycm9yOmdzdWIoYHtDYWxsZXJ9OntMaW5lfTogYCwgQ2FsbGVyLCAxKQoJCQkJZW5kCgkJCWVuZAoKCQkJcmV0dXJuIFJlc3BvbmNlCgkJZW5kLAoJCVtnZXRmZW52XSA9IGZ1bmN0aW9uKE9sZEZ1bmMsIExldmVsOiBudW1iZXIsIC4uLikKCQkJTGV2ZWwgPSBMZXZlbCBvciAxCgoJCQktLS8vIFByZXZlbnQgY2F0cHVyZSBvZiBleGVjdXRvcidzIGVudgoJCQlpZiB0eXBlKExldmVsKSA9PSAibnVtYmVyIiB0aGVuCgkJCQlMZXZlbCArPSAyCgkJCWVuZAoKCQkJbG9jYWwgUmVzcG9uY2UgPSB7T2xkRnVuYyhMZXZlbCwgLi4uKX0KCQkJbG9jYWwgRU5WID0gUmVzcG9uY2VbMV0KCgkJCS0tLy8gX190b3N0cmluZyBFTlYgZGV0ZWN0aW9uIHBhdGNoCgkJCWlmIG5vdCBjaGVja2NhbGxlcigpIGFuZCBFTlYgPT0gRXhlRU5WIHRoZW4KCQkJCUNvbW11bmljYXRpb246Q29uc29sZVByaW50KCJFTlYgZXNjYXBlIHBhdGNoZWQiKQoJCQkJcmV0dXJuIE9sZEZ1bmMoOTk5OTk5LCAuLi4pCgkJCWVuZAoKCQkJcmV0dXJuIFJlc3BvbmNlCgkJZW5kCgl9CgoJLS0vLyBIb29rIGVhY2ggZnVuY3Rpb24KCWZvciBGdW5jLCBDYWxsQmFjayBpbiBQYXRjaGVzIGRvCgkJbG9jYWwgV3JhcHBlZCA9IG5ld2NjbG9zdXJlKENhbGxCYWNrKQoJCWxvY2FsIE9sZEZ1bmM7IE9sZEZ1bmMgPSBzZWxmOkhvb2tGdW5jdGlvbihGdW5jLCBmdW5jdGlvbiguLi4pCgkJCXJldHVybiBXcmFwcGVkKE9sZEZ1bmMsIC4uLikKCQllbmQpCgoJCS0tLy8gQ2FjaGUgcHJldmlvdXMgZnVuY3Rpb24KCQlzZWxmLlByZXZpb3VzRnVuY3Rpb25zW0Z1bmNdID0gT2xkRnVuYwoJZW5kCmVuZAoKZnVuY3Rpb24gSG9vazpHZXRPcmlnaW5hbEZ1bmMoRnVuYykKCXJldHVybiBzZWxmLlByZXZpb3VzRnVuY3Rpb25zW0Z1bmNdIG9yIEZ1bmMKZW5kCgpmdW5jdGlvbiBIb29rOlJ1bk9uQWN0b3JzKENvZGU6IHN0cmluZywgQ2hhbm5lbElkOiBudW1iZXIpCglpZiBub3QgZ2V0YWN0b3JzIG9yIG5vdCBydW5fb25fYWN0b3IgdGhlbiByZXR1cm4gZW5kCgkKCWxvY2FsIEFjdG9ycyA9IGdldGFjdG9ycygpCglpZiBub3QgQWN0b3JzIHRoZW4gcmV0dXJuIGVuZAoJCglmb3IgXywgQWN0b3IgaW4gQWN0b3JzIGRvIAoJCXBjYWxsKHJ1bl9vbl9hY3RvciwgQWN0b3IsIENvZGUsIENoYW5uZWxJZCkKCWVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIFByb2Nlc3NSZW1vdGUoT3JpZ2luYWxGdW5jLCBNZXRhTWV0aG9kOiBzdHJpbmcsIHNlbGYsIE1ldGhvZDogc3RyaW5nLCAuLi4pCglyZXR1cm4gUHJvY2VzczpQcm9jZXNzUmVtb3RlKHsKCQlNZXRob2QgPSBNZXRob2QsCgkJT3JpZ2luYWxGdW5jID0gT3JpZ2luYWxGdW5jLAoJCU1ldGFNZXRob2QgPSBNZXRhTWV0aG9kLAoJCVRyYW5zZmVyVHlwZSA9ICJTZW5kIiwKCQlJc0V4cGxvaXQgPSBjaGVja2NhbGxlcigpCgl9LCBzZWxmLCAuLi4pCmVuZAoKZnVuY3Rpb24gSG9vazpIb29rUmVtb3RlVHlwZUluZGV4KENsYXNzTmFtZTogc3RyaW5nLCBGdW5jTmFtZTogc3RyaW5nKQoJbG9jYWwgUmVtb3RlID0gSW5zdGFuY2UubmV3KENsYXNzTmFtZSkKCWxvY2FsIEZ1bmMgPSBSZW1vdGVbRnVuY05hbWVdCglsb2NhbCBPcmlnaW5hbEZ1bmMKCgktLS8vIFJlbW90ZXMgd2lsbCBzaGFyZSB0aGUgc2FtZSBmdW5jdGlvbnMKCS0tLy8gCUZvciBleGFtcGxlIEZpcmVTZXJ2ZXIgd2lsbCBiZSBpZGVudGljYWwKCS0tLy8gQWRkaW9uYWxseSwgdGhpcyBpcyBmb3IgX19pbmRleCBjYWxscy4KCS0tLy8gCUEgX19uYW1lY2FsbCBob29rIHdpbGwgbm90IGRldGVjdCB0aGlzCglPcmlnaW5hbEZ1bmMgPSBzZWxmOkhvb2tGdW5jdGlvbihGdW5jLCBmdW5jdGlvbihzZWxmLCAuLi4pCgkJLS0vLyBDaGVjayBpZiB0aGUgT2JqZWN0IGlzIGFsbG93ZWQgCgkJaWYgbm90IFByb2Nlc3M6UmVtb3RlQWxsb3dlZChzZWxmLCAiU2VuZCIsIEZ1bmNOYW1lKSB0aGVuIHJldHVybiBlbmQKCgkJLS0vLyBQcm9jZXNzIHRoZSByZW1vdGUgZGF0YQoJCXJldHVybiBQcm9jZXNzUmVtb3RlKE9yaWdpbmFsRnVuYywgIl9faW5kZXgiLCBzZWxmLCBGdW5jTmFtZSwgLi4uKQoJZW5kKQplbmQKCmZ1bmN0aW9uIEhvb2s6SG9va1JlbW90ZUluZGV4ZXMoKQoJbG9jYWwgUmVtb3RlQ2xhc3NEYXRhID0gUHJvY2Vzcy5SZW1vdGVDbGFzc0RhdGEKCWZvciBDbGFzc05hbWUsIERhdGEgaW4gUmVtb3RlQ2xhc3NEYXRhIGRvCgkJbG9jYWwgRnVuY05hbWUgPSBEYXRhLlNlbmRbMV0KCQlzZWxmOkhvb2tSZW1vdGVUeXBlSW5kZXgoQ2xhc3NOYW1lLCBGdW5jTmFtZSkKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6QmVnaW5Ib29rcygpCgktLS8vIEhvb2sgUmVtb3RlIGZ1bmN0aW9ucwoJc2VsZjpIb29rUmVtb3RlSW5kZXhlcygpCgoJLS0vLyBOYW1lY2FsbCBob29rCglsb2NhbCBPcmlnaW5hbE5hbWVDYWxsCglPcmlnaW5hbE5hbWVDYWxsID0gc2VsZjpIb29rTWV0YU1ldGhvZChnYW1lLCAiX19uYW1lY2FsbCIsIGZ1bmN0aW9uKHNlbGYsIC4uLikKCQlsb2NhbCBNZXRob2QgPSBnZXRuYW1lY2FsbG1ldGhvZCgpCgkJcmV0dXJuIFByb2Nlc3NSZW1vdGUoT3JpZ2luYWxOYW1lQ2FsbCwgIl9fbmFtZWNhbGwiLCBzZWxmLCBNZXRob2QsIC4uLikKCWVuZCkKCglNZXJnZShzZWxmLCB7CgkJT3JpZ2luYWxOYW1lY2FsbCA9IE9yaWdpbmFsTmFtZUNhbGwsCgkJLS1PcmlnaW5hbEluZGV4ID0gT2kKCX0pCmVuZAoKZnVuY3Rpb24gSG9vazpIb29rQ2xpZW50SW52b2tlKFJlbW90ZSwgTWV0aG9kLCBDYWxsYmFjaykKCWxvY2FsIFN1Y2Nlc3MsIEZ1bmN0aW9uID0gcGNhbGwoZnVuY3Rpb24oKQoJCXJldHVybiBnZXRjYWxsYmFja3ZhbHVlKFJlbW90ZSwgTWV0aG9kKQoJZW5kKQoKCS0tLy8gU29tZSBleGVjdXRvcnMgbGlrZSBQb3Rhc3NpdW0gd2lsbCB0aHJvdyBhIGVycm9yIGlmIHRoZSBDYWxsYmFjayB2YWx1ZSBpcyBuaWwKCWlmIG5vdCBTdWNjZXNzIHRoZW4gcmV0dXJuIGVuZAoJaWYgbm90IEZ1bmN0aW9uIHRoZW4gcmV0dXJuIGVuZAoJCgktLS8vIFRlc3QgaG9va2Z1bmN0aW9uCglsb2NhbCBIb29rU3VjY2VzcyA9IHBjYWxsKGZ1bmN0aW9uKCkKCQlzZWxmOkhvb2tGdW5jdGlvbihGdW5jdGlvbiwgQ2FsbGJhY2spCgllbmQpCglpZiBIb29rU3VjY2VzcyB0aGVuIHJldHVybiBlbmQKCgktLS8vIFJlcGxhY2UgY2FsbGJhY2sgZnVuY3Rpb24gb3RoZXJ3aXNlCglSZW1vdGVbTWV0aG9kXSA9IGZ1bmN0aW9uKC4uLikKCQlyZXR1cm4gSG9va01pZGRsZShGdW5jdGlvbiwgQ2FsbGJhY2ssIGZhbHNlLCAuLi4pCgllbmQKZW5kCgpmdW5jdGlvbiBIb29rOk11bHRpQ29ubmVjdChSZW1vdGVzKQoJZm9yIF8sIFJlbW90ZSBpbiBuZXh0LCBSZW1vdGVzIGRvCgkJc2VsZjpDb25uZWN0Q2xpZW50UmVjaXZlKFJlbW90ZSkKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6Q29ubmVjdENsaWVudFJlY2l2ZShSZW1vdGUpCgktLS8vIENoZWNrIGlmIHRoZSBSZW1vdGUgY2xhc3MgaXMgYWxsb3dlZCBmb3IgcmVjZWl2aW5nCglsb2NhbCBBbGxvd2VkID0gUHJvY2VzczpSZW1vdGVBbGxvd2VkKFJlbW90ZSwgIlJlY2VpdmUiKQoJaWYgbm90IEFsbG93ZWQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBDaGVjayBpZiB0aGUgT2JqZWN0IGhhcyBSZW1vdGUgY2xhc3MgZGF0YQogICAgbG9jYWwgQ2xhc3NEYXRhID0gUHJvY2VzczpHZXRDbGFzc0RhdGEoUmVtb3RlKQogICAgbG9jYWwgSXNSZW1vdGVGdW5jdGlvbiA9IENsYXNzRGF0YS5Jc1JlbW90ZUZ1bmN0aW9uCglsb2NhbCBOb1JlY2l2ZUhvb2sgPSBDbGFzc0RhdGEuTm9SZWNpdmVIb29rCiAgICBsb2NhbCBNZXRob2QgPSBDbGFzc0RhdGEuUmVjZWl2ZVsxXQoKCS0tLy8gQ2hlY2sgaWYgdGhlIFJlY2l2ZSBzaG91bGQgYmUgaG9va2VkCglpZiBOb1JlY2l2ZUhvb2sgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBOZXcgY2FsbGJhY2sgZnVuY3Rpb24KCWxvY2FsIGZ1bmN0aW9uIENhbGxiYWNrKC4uLikKICAgICAgICByZXR1cm4gUHJvY2VzczpQcm9jZXNzUmVtb3RlKHsKICAgICAgICAgICAgTWV0aG9kID0gTWV0aG9kLAogICAgICAgICAgICBJc1JlY2VpdmUgPSB0cnVlLAogICAgICAgICAgICBNZXRhTWV0aG9kID0gIkNvbm5lY3QiLAoJCQlJc0V4cGxvaXQgPSBjaGVja2NhbGxlcigpCiAgICAgICAgfSwgUmVtb3RlLCAuLi4pCgllbmQKCgktLS8vIENvbm5lY3QgcmVtb3RlCglpZiBub3QgSXNSZW1vdGVGdW5jdGlvbiB0aGVuCiAgIAkJUmVtb3RlW01ldGhvZF06Q29ubmVjdChDYWxsYmFjaykKCWVsc2UgLS0gUmVtb3RlIGZ1bmN0aW9ucwoJCXNlbGY6SG9va0NsaWVudEludm9rZShSZW1vdGUsIE1ldGhvZCwgQ2FsbGJhY2spCgllbmQKZW5kCgpmdW5jdGlvbiBIb29rOkJlZ2luU2VydmljZShMaWJyYXJpZXMsIEV4dHJhRGF0YSwgQ2hhbm5lbElkLCAuLi4pCgktLS8vIExpYnJhcmVpcwoJbG9jYWwgUmV0dXJuU3Bvb2ZzID0gTGlicmFyaWVzLlJldHVyblNwb29mcwoJbG9jYWwgUHJvY2Vzc0xpYiA9IExpYnJhcmllcy5Qcm9jZXNzCglsb2NhbCBDb21tdW5pY2F0aW9uID0gTGlicmFyaWVzLkNvbW11bmljYXRpb24KCWxvY2FsIEdlbmVyYXRpb24gPSBMaWJyYXJpZXMuR2VuZXJhdGlvbgoJbG9jYWwgQ29uZmlnID0gTGlicmFyaWVzLkNvbmZpZwoKCS0tLy8gQ2hlY2sgZm9yIGNvbmZpZ3VyYXRpb24gb3ZlcndyaXRlcwoJUHJvY2Vzc0xpYjpDaGVja0NvbmZpZyhDb25maWcpCgoJLS0vLyBJbml0IGRhdGEKCWxvY2FsIEluaXREYXRhID0gewoJCU1vZHVsZXMgPSB7CgkJCVJldHVyblNwb29mcyA9IFJldHVyblNwb29mcywKCQkJR2VuZXJhdGlvbiA9IEdlbmVyYXRpb24sCgkJCUNvbW11bmljYXRpb24gPSBDb21tdW5pY2F0aW9uLAoJCQlQcm9jZXNzID0gUHJvY2Vzc0xpYiwKCQkJQ29uZmlnID0gQ29uZmlnLAoJCQlIb29rID0gc2VsZgoJCX0sCgkJU2VydmljZXMgPSBzZXRtZXRhdGFibGUoe30sIHsKCQkJX19pbmRleCA9IGZ1bmN0aW9uKHNlbGYsIE5hbWU6IHN0cmluZyk6IEluc3RhbmNlCgkJCQlsb2NhbCBTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKE5hbWUpCgkJCQlyZXR1cm4gY2xvbmVyZWYoU2VydmljZSkKCQkJZW5kLAoJCX0pCgl9CgoJLS0vLyBJbml0IGxpYnJhcmllcwoJQ29tbXVuaWNhdGlvbjpJbml0KEluaXREYXRhKQoJUHJvY2Vzc0xpYjpJbml0KEluaXREYXRhKQoKCS0tLy8gQ29tbXVuaWNhdGlvbiBjb25maWd1cmF0aW9uCglsb2NhbCBDaGFubmVsLCBJc1dyYXBwZWQgPSBDb21tdW5pY2F0aW9uOkdldENvbW1DaGFubmVsKENoYW5uZWxJZCkKCUNvbW11bmljYXRpb246U2V0Q2hhbm5lbChDaGFubmVsKQoJQ29tbXVuaWNhdGlvbjpBZGRUeXBlQ2FsbGJhY2tzKHsKCQlbIlJlbW90ZURhdGEiXSA9IGZ1bmN0aW9uKElkOiBzdHJpbmcsIFJlbW90ZURhdGEpCgkJCVByb2Nlc3NMaWI6U2V0UmVtb3RlRGF0YShJZCwgUmVtb3RlRGF0YSkKCQllbmQsCgkJWyJBbGxSZW1vdGVEYXRhIl0gPSBmdW5jdGlvbihLZXk6IHN0cmluZywgVmFsdWUpCgkJCVByb2Nlc3NMaWI6U2V0QWxsUmVtb3RlRGF0YShLZXksIFZhbHVlKQoJCWVuZCwKCQlbIlVwZGF0ZVNwb29mcyJdID0gZnVuY3Rpb24oQ29udGVudDogc3RyaW5nKQoJCQlsb2NhbCBTcG9vZnMgPSBsb2Fkc3RyaW5nKENvbnRlbnQpKCkKCQkJUHJvY2Vzc0xpYjpTZXROZXdSZXR1cm5TcG9vZnMoU3Bvb2ZzKQoJCWVuZCwKCQlbIkJlZ2luSG9va3MiXSA9IGZ1bmN0aW9uKENvbmZpZykKCQkJaWYgQ29uZmlnLlBhdGNoRnVuY3Rpb25zIHRoZW4KCQkJCXNlbGY6UGF0Y2hGdW5jdGlvbnMoKQoJCQllbmQKCQkJc2VsZjpCZWdpbkhvb2tzKCkKCQkJQ29tbXVuaWNhdGlvbjpDb25zb2xlUHJpbnQoIkhvb2tzIGxvYWRlZCIpCgkJZW5kCgl9KQoJCgktLS8vIFByb2Nlc3MgY29uZmlndXJhdGlvbgoJUHJvY2Vzc0xpYjpTZXRDaGFubmVsKENoYW5uZWwsIElzV3JhcHBlZCkKCVByb2Nlc3NMaWI6U2V0RXh0cmFEYXRhKEV4dHJhRGF0YSkKCgktLS8vIEhvb2sgY29uZmlndXJhdGlvbgoJc2VsZjpJbml0KEluaXREYXRhKQoKCWlmIEV4dHJhRGF0YSBhbmQgRXh0cmFEYXRhLklzQWN0b3IgdGhlbgoJCUNvbW11bmljYXRpb246Q29uc29sZVByaW50KCJBY3RvciBjb25uZWN0ZWQhIikKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6TG9hZE1ldGFIb29rcyhBY3RvckNvZGU6IHN0cmluZywgQ2hhbm5lbElkOiBudW1iZXIpCgktLS8vIEhvb2sgYWN0b3JzCglpZiBub3QgQ29uZmlndXJhdGlvbi5Ob0FjdG9ycyB0aGVuCgkJc2VsZjpSdW5PbkFjdG9ycyhBY3RvckNvZGUsIENoYW5uZWxJZCkKCWVuZAoKCS0tLy8gSG9vayBjdXJyZW50IHRocmVhZAoJc2VsZjpCZWdpblNlcnZpY2UoTW9kdWxlcywgbmlsLCBDaGFubmVsSWQpIAplbmQKCmZ1bmN0aW9uIEhvb2s6TG9hZFJlY2VpdmVIb29rcygpCglsb2NhbCBOb1JlY2VpdmVIb29raW5nID0gQ29uZmlnLk5vUmVjZWl2ZUhvb2tpbmcKCWxvY2FsIEJsYWNrTGlzdGVkU2VydmljZXMgPSBDb25maWcuQmxhY2tMaXN0ZWRTZXJ2aWNlcwoKCWlmIE5vUmVjZWl2ZUhvb2tpbmcgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBSZW1vdGUgYWRkZWQKCWdhbWUuRGVzY2VuZGFudEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oUmVtb3RlKSAtLSBUT0RPCgkJc2VsZjpDb25uZWN0Q2xpZW50UmVjaXZlKFJlbW90ZSkKCWVuZCkKCgktLS8vIENvbGxlY3QgcmVtb3RlcyB3aXRoIG5pbCBwYXJlbnRzCglzZWxmOk11bHRpQ29ubmVjdChnZXRuaWxpbnN0YW5jZXMoKSkKCgktLS8vIFNlYXJjaCBmb3IgcmVtb3RlcwoJZm9yIF8sIFNlcnZpY2UgaW4gbmV4dCwgZ2FtZTpHZXRDaGlsZHJlbigpIGRvCgkJaWYgdGFibGUuZmluZChCbGFja0xpc3RlZFNlcnZpY2VzLCBTZXJ2aWNlLkNsYXNzTmFtZSkgdGhlbiBjb250aW51ZSBlbmQKCQlzZWxmOk11bHRpQ29ubmVjdChTZXJ2aWNlOkdldERlc2NlbmRhbnRzKCkpCgllbmQKZW5kCgpmdW5jdGlvbiBIb29rOkxvYWRIb29rcyhBY3RvckNvZGU6IHN0cmluZywgQ2hhbm5lbElkOiBudW1iZXIpCglzZWxmOkxvYWRNZXRhSG9va3MoQWN0b3JDb2RlLCBDaGFubmVsSWQpCglzZWxmOkxvYWRSZWNlaXZlSG9va3MoKQplbmQKCnJldHVybiBIb29rCg==]]
},Flags={'base64',
[[dHlwZSBGbGFnVmFsdWUgPSBib29sZWFufG51bWJlcnxhbnkKdHlwZSBGbGFnID0gewogICAgVmFsdWU6IEZsYWdWYWx1ZSwKICAgIExhYmVsOiBzdHJpbmcsCiAgICBDYXRlZ29yeTogc3RyaW5nCn0KdHlwZSBGbGFncyA9IHsKICAgIFtzdHJpbmddOiBGbGFnCn0KdHlwZSB0YWJsZSA9IHsKICAgIFthbnldOiBhbnkKfQoKbG9jYWwgTW9kdWxlID0gewogICAgRmxhZ3MgPSB7CiAgICAgICAgLS0gUHJldmVudFJlbmFtaW5nID0gewogICAgICAgIC0tICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgIC0tICAgICBMYWJlbCA9ICJObyByZW5hbWluZyIsCiAgICAgICAgLS0gfSwKICAgICAgICAtLSBQcmV2ZW50UGFyZW50aW5nID0gewogICAgICAgIC0tICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgIC0tICAgICBMYWJlbCA9ICJObyBwYXJlbnRpbmciLAogICAgICAgIC0tIH0sCiAgICAgICAgTm9Db21tZW50cyA9IHsKICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICAgICAgTGFiZWwgPSAiTm8gY29tbWVudHMiLAogICAgICAgIH0sCiAgICAgICAgU2VsZWN0TmV3ZXN0ID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJBdXRvIHNlbGVjdCBuZXdlc3QiLAogICAgICAgIH0sCiAgICAgICAgRGVjb21waWxlUG9wb3V0ID0geyAtLSBMb3ZyZSBTSFVTSAogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJQb3Atb3V0IGRlY29tcGlsZXMiLAogICAgICAgIH0sCiAgICAgICAgSWdub3JlTmlsID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIklnbm9yZSBuaWwgcGFyZW50cyIsCiAgICAgICAgfSwKICAgICAgICBMb2dFeHBsb2l0ID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIkxvZyBleHBsb2l0IGNhbGxzIiwKICAgICAgICB9LAogICAgICAgIExvZ1JlY2l2ZXMgPSB7CiAgICAgICAgICAgIFZhbHVlID0gdHJ1ZSwKICAgICAgICAgICAgTGFiZWwgPSAiTG9nIHJlY2VpdmVzIiwKICAgICAgICB9LAogICAgICAgIFBhdXNlZCA9IHsKICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICAgICAgTGFiZWwgPSAiUGF1c2VkIiwKICAgICAgICAgICAgS2V5YmluZCA9IEVudW0uS2V5Q29kZS5RCiAgICAgICAgfSwKICAgICAgICBLZXliaW5kc0VuYWJsZWQgPSB7CiAgICAgICAgICAgIFZhbHVlID0gdHJ1ZSwKICAgICAgICAgICAgTGFiZWwgPSAiS2V5YmluZHMgRW5hYmxlZCIKICAgICAgICB9LAogICAgICAgIEZpbmRTdHJpbmdGb3JOYW1lID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIkZpbmQgYXJnIGZvciBuYW1lIgogICAgICAgIH0sCiAgICAgICAgVWlWaXNpYmxlID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIlVJIFZpc2libGUiLAogICAgICAgICAgICBLZXliaW5kID0gRW51bS5LZXlDb2RlLlAKICAgICAgICB9LAogICAgICAgIE5vVHJlZU5vZGVzID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJObyBncm91cGluZyIKICAgICAgICB9LAogICAgICAgIFRhYmxlQXJncyA9IHsKICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICAgICAgTGFiZWwgPSAiVGFibGUgYXJncyIKICAgICAgICB9LAogICAgICAgIE5vVmFyaWFibGVzID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJObyBjb21wcmVzc2lvbiIKICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIE1vZHVsZTpHZXRGbGFnVmFsdWUoTmFtZTogc3RyaW5nKTogRmxhZ1ZhbHVlCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpCiAgICByZXR1cm4gRmxhZy5WYWx1ZQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpTZXRGbGFnVmFsdWUoTmFtZTogc3RyaW5nLCBWYWx1ZTogRmxhZ1ZhbHVlKQogICAgbG9jYWwgRmxhZyA9IHNlbGY6R2V0RmxhZyhOYW1lKQogICAgRmxhZy5WYWx1ZSA9IFZhbHVlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOlNldEZsYWdDYWxsYmFjayhOYW1lOiBzdHJpbmcsIENhbGxiYWNrOiAoLi4uYW55KSAtPiAuLi5hbnkpCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpCiAgICBGbGFnLkNhbGxiYWNrID0gQ2FsbGJhY2sKZW5kCgpmdW5jdGlvbiBNb2R1bGU6U2V0RmxhZ0NhbGxiYWNrcyhEaWN0OiB7fSkKICAgIGZvciBOYW1lLCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55IGluIG5leHQsIERpY3QgZG8gCiAgICAgICAgc2VsZjpTZXRGbGFnQ2FsbGJhY2soTmFtZSwgQ2FsbGJhY2spCiAgICBlbmQKZW5kCgpmdW5jdGlvbiBNb2R1bGU6R2V0RmxhZyhOYW1lOiBzdHJpbmcpOiBGbGFnCiAgICBsb2NhbCBBbGxGbGFncyA9IHNlbGY6R2V0RmxhZ3MoKQogICAgbG9jYWwgRmxhZyA9IEFsbEZsYWdzW05hbWVdCiAgICBhc3NlcnQoRmxhZywgIkZsYWcgZG9lcyBub3QgZXhpc3QhIikKICAgIHJldHVybiBGbGFnCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkFkZEZsYWcoTmFtZTogc3RyaW5nLCBGbGFnOiBGbGFnKQogICAgbG9jYWwgQWxsRmxhZ3MgPSBzZWxmOkdldEZsYWdzKCkKICAgIEFsbEZsYWdzW05hbWVdID0gRmxhZwplbmQKCmZ1bmN0aW9uIE1vZHVsZTpHZXRGbGFncygpOiBGbGFncwogICAgcmV0dXJuIHNlbGYuRmxhZ3MKZW5kCgpyZXR1cm4gTW9kdWxl]]
},Ui={'base64',
[[bG9jYWwgVWkgPSB7CglEZWZhdWx0RWRpdG9yQ29udGVudCA9IFs9Wy0tW1sKCVNpZ21hIFNweSwgd3JpdHRlbiBieSBkZXBzbwoJSG9va3MgcmV3cml0dGVuIGFuZCBtYW55IG1vcmUgZml4ZXMhCgoJRGlzY29yZDogaHR0cHM6Ly9kaXNjb3JkLmdnL2JrVWttMnZTYnYKXV1dPV0sCglMb2dMaW1pdCA9IDEwMCwKICAgIFNlYXNvbkxhYmVscyA9IHsgCiAgICAgICAgSmFudWFyeSA9ICLim4QgJXMg4puEIiwgCiAgICAgICAgRmVicnVhcnkgPSAi8J+MqO+4jyAlcyDwn4+CIiwgCiAgICAgICAgTWFyY2ggPSAi8J+MuSAlc/CfjLogIiwgCiAgICAgICAgQXByaWwgPSAi8J+QoyAlcyDinJ3vuI8iLCAKICAgICAgICBNYXkgPSAi8J+QnSAlcyDwn4yeIiwgCiAgICAgICAgSnVuZSA9ICLwn4yyICVzIPCfpZUiLCAKICAgICAgICBKdWx5ID0gIvCfjIogJXMg8J+MhSIsIAogICAgICAgIEF1Z3VzdCA9ICLimIDvuI8gJXMg8J+MniIsIAogICAgICAgIFNlcHRlbWJlciA9ICLwn42BICVzIPCfjYEiLCAKICAgICAgICBPY3RvYmVyID0gIvCfjoMgJXMg8J+OgyIsIAogICAgICAgIE5vdmVtYmVyID0gIvCfjYIgJXMg8J+NgiIsIAogICAgICAgIERlY2VtYmVyID0gIvCfjoQgJXMg8J+OgSIKICAgIH0sCglTY2FsZXMgPSB7CgkJWyJNb2JpbGUiXSA9IFVEaW0yLmZyb21PZmZzZXQoNDgwLCAyODApLAoJCVsiRGVza3RvcCJdID0gVURpbTIuZnJvbU9mZnNldCg2MDAsIDQwMCksCgl9LAogICAgQmFzZUNvbmZpZyA9IHsKICAgICAgICBUaGVtZSA9ICJTaWdtYVNweSIsCiAgICAgICAgTm9TY3JvbGwgPSB0cnVlLAogICAgfSwKCU9wdGlvblR5cGVzID0gewoJCWJvb2xlYW4gPSAiQ2hlY2tib3giLAoJfSwKCURpc3BsYXlSZW1vdGVJbmZvID0gewoJCSJNZXRhTWV0aG9kIiwKCQkiTWV0aG9kIiwKCQkiUmVtb3RlIiwKCQkiQ2FsbGluZ1NjcmlwdCIsCgkJIklzQWN0b3IiLAoJCSJJZCIKCX0sCgogICAgV2luZG93ID0gbmlsLAogICAgUmFuZG9tU2VlZCA9IFJhbmRvbS5uZXcodGljaygpKSwKCUxvZ3MgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAiayJ9KSwKCUxvZ1F1ZXVlID0gc2V0bWV0YXRhYmxlKHt9LCB7X19tb2RlID0gInYifSksCn0gCgp0eXBlIHRhYmxlID0gewoJW2FueV06IGFueQp9Cgp0eXBlIExvZyA9IHsKCVJlbW90ZTogSW5zdGFuY2UsCglNZXRob2Q6IHN0cmluZywKCUFyZ3M6IHRhYmxlLAoJSXNSZWNlaXZlOiBib29sZWFuPywKCU1ldGFNZXRob2Q6IHN0cmluZz8sCglPcmlnbmFsRnVuYzogKCguLi5hbnkpIC0+IC4uLmFueSk/LAoJQ2FsbGluZ1NjcmlwdDogSW5zdGFuY2U/LAoJQ2FsbGluZ0Z1bmN0aW9uOiAoKC4uLmFueSkgLT4gLi4uYW55KT8sCglDbGFzc0RhdGE6IHRhYmxlPywKCVJldHVyblZhbHVlczogdGFibGU/LAoJUmVtb3RlRGF0YTogdGFibGU/LAoJSWQ6IHN0cmluZywKCVNlbGVjdGFibGU6IHRhYmxlLAoJSGVhZGVyRGF0YTogdGFibGUsCglWYWx1ZVN3YXBzOiB0YWJsZSwKCVRpbWVzdGFtcDogbnVtYmVyLAoJSXNFeHBsb2l0OiBib29sZWFuCn0KCi0tLy8gQ29tcGF0aWJpbGl0eQpsb2NhbCBTZXRDbGlwYm9hcmQgPSBzZXRjbGlwYm9hcmQgb3IgdG9jbGlwYm9hcmQgb3Igc2V0X2NsaXBib2FyZAoKLS0vLyBMaWJyYXJpZXMKbG9jYWwgUmVHdWkgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0pzc3NpZWUvRGVhci1SZUd1aS9yZWZzL2hlYWRzL21haW4vUmVHdWkubHVhJyksICJSZUd1aSIpKCkKCi0tLy8gTW9kdWxlcwpsb2NhbCBGbGFncwpsb2NhbCBHZW5lcmF0aW9uCmxvY2FsIFByb2Nlc3MKbG9jYWwgSG9vayAKbG9jYWwgQ29uZmlnCmxvY2FsIENvbW11bmljYXRpb24KbG9jYWwgRmlsZXMKCmxvY2FsIEFjdGl2ZURhdGEgPSBuaWwKbG9jYWwgUmVtb3Rlc0NvdW50ID0gMAoKbG9jYWwgVGV4dEZvbnQgPSBGb250LmZyb21FbnVtKEVudW0uRm9udC5Db2RlKQpsb2NhbCBGb250U3VjY2VzcyA9IGZhbHNlCmxvY2FsIENvbW1DaGFubmVsCgpmdW5jdGlvbiBVaTpJbml0KERhdGEpCiAgICBsb2NhbCBNb2R1bGVzID0gRGF0YS5Nb2R1bGVzCgoJLS0vLyBNb2R1bGVzCglGbGFncyA9IE1vZHVsZXMuRmxhZ3MKCUdlbmVyYXRpb24gPSBNb2R1bGVzLkdlbmVyYXRpb24KCVByb2Nlc3MgPSBNb2R1bGVzLlByb2Nlc3MKCUhvb2sgPSBNb2R1bGVzLkhvb2sKCUNvbmZpZyA9IE1vZHVsZXMuQ29uZmlnCglDb21tdW5pY2F0aW9uID0gTW9kdWxlcy5Db21tdW5pY2F0aW9uCglGaWxlcyA9IE1vZHVsZXMuRmlsZXMKCgktLS8vIFJlR3VpCglzZWxmOkxvYWRGb250KCkKCXNlbGY6TG9hZFJlR3VpKCkKCXNlbGY6Q2hlY2tTY2FsZSgpCmVuZAoKZnVuY3Rpb24gVWk6U2V0Q29tbUNoYW5uZWwoTmV3Q29tbUNoYW5uZWw6IEJpbmRhYmxlRXZlbnQpCglDb21tQ2hhbm5lbCA9IE5ld0NvbW1DaGFubmVsCmVuZAoKZnVuY3Rpb24gVWk6Q2hlY2tTY2FsZSgpCglsb2NhbCBCYXNlQ29uZmlnID0gc2VsZi5CYXNlQ29uZmlnCglsb2NhbCBTY2FsZXMgPSBzZWxmLlNjYWxlcwoKCWxvY2FsIElzTW9iaWxlID0gUmVHdWk6SXNNb2JpbGVEZXZpY2UoKQoJbG9jYWwgRGV2aWNlID0gSXNNb2JpbGUgYW5kICJNb2JpbGUiIG9yICJEZXNrdG9wIgoKCUJhc2VDb25maWcuU2l6ZSA9IFNjYWxlc1tEZXZpY2VdCmVuZAoKZnVuY3Rpb24gVWk6U2V0Q2xpcGJvYXJkKENvbnRlbnQ6IHN0cmluZykKCVNldENsaXBib2FyZChDb250ZW50KQplbmQKCmZ1bmN0aW9uIFVpOlR1cm5TZWFzb25hbChUZXh0OiBzdHJpbmcpOiBzdHJpbmcKICAgIGxvY2FsIFNlYXNvbkxhYmVscyA9IHNlbGYuU2Vhc29uTGFiZWxzCiAgICBsb2NhbCBNb250aCA9IG9zLmRhdGUoIiVCIikKICAgIGxvY2FsIEJhc2UgPSBTZWFzb25MYWJlbHNbTW9udGhdCgogICAgcmV0dXJuIEJhc2U6Zm9ybWF0KFRleHQpCmVuZAoKZnVuY3Rpb24gVWk6TG9hZEZvbnQoKQoJbG9jYWwgRm9udEZpbGUgPSBzZWxmLkZvbnRKc29uRmlsZQoKCS0tLy8gR2V0IEZvbnRGYWNlIEFzc2V0SWQKCWxvY2FsIEFzc2V0SWQgPSBGaWxlczpMb2FkQ3VzdG9tYXNzZXQoRm9udEZpbGUpCglpZiBub3QgQXNzZXRJZCB0aGVuIHJldHVybiBlbmQKCgktLS8vIENyZWF0ZSBjdXN0b20gRm9udEZhY2UKCWxvY2FsIE5ld0ZvbnQgPSBGb250Lm5ldyhBc3NldElkKQoJVGV4dEZvbnQgPSBOZXdGb250CglGb250U3VjY2VzcyA9IHRydWUKZW5kCgpmdW5jdGlvbiBVaTpTZXRGb250RmlsZShGb250RmlsZTogc3RyaW5nKQoJc2VsZi5Gb250SnNvbkZpbGUgPSBGb250RmlsZQplbmQKCmZ1bmN0aW9uIFVpOkZvbnRXYXNTdWNjZXNzZnVsKCkKCWlmIEZvbnRTdWNjZXNzIHRoZW4gcmV0dXJuIGVuZAoKCS0tLy8gRXJyb3IgbWVzc2FnZQoJc2VsZjpTaG93TW9kYWwoewoJCSJVbmZvcnR1bmF0ZWx5IHlvdXIgZXhlY3V0b3Igd2FzIHVuYWJsZSB0byBkb3dubG9hZCB0aGUgZm9udCBhbmQgdGhlcmVmb3JlIHN3aXRjaGVkIHRvIHRoZSBEYXJrIHRoZW1lIiwKCQkiXG5JZiB5b3Ugd291bGQgbGlrZSB0byB1c2UgdGhlIEltR3VpIHRoZW1lLCBcbnBsZWFzZSBkb3dubG9hZCB0aGUgZm9udCAoYXNzZXRzL1Byb2dneUNsZWFuLnR0ZikiLAoJCSJhbmQgcHV0IHB1dCBpdCBpbiB5b3VyIHdvcmtzcGFjZSBmb2xkZXJcbihTaWdtYSBTcHkvYXNzZXRzKSIKCX0pCmVuZAoKZnVuY3Rpb24gVWk6TG9hZFJlR3VpKCkKCWxvY2FsIFRoZW1lQ29uZmlnID0gQ29uZmlnLlRoZW1lQ29uZmlnCglUaGVtZUNvbmZpZy5UZXh0Rm9udCA9IFRleHRGb250CgoJLS0vLyBSZUd1aQoJUmVHdWk6RGVmaW5lVGhlbWUoIlNpZ21hU3B5IiwgVGhlbWVDb25maWcpCmVuZAoKdHlwZSBDcmVhdGVCdXR0b25zID0gewoJQmFzZTogdGFibGU/LAoJQnV0dG9uczogdGFibGUsCglOb1RhYmxlOiBib29sZWFuPwp9CmZ1bmN0aW9uIFVpOkNyZWF0ZUJ1dHRvbnMoUGFyZW50LCBEYXRhOiBDcmVhdGVCdXR0b25zKQoJbG9jYWwgQmFzZSA9IERhdGEuQmFzZSBvciB7fQoJbG9jYWwgQnV0dG9ucyA9IERhdGEuQnV0dG9ucwoJbG9jYWwgTm9UYWJsZSA9IERhdGEuTm9UYWJsZQoKCS0tLy8gQ3JlYXRlIHRhYmxlIGxheW91dAoJaWYgbm90IE5vVGFibGUgdGhlbgoJCVBhcmVudCA9IFBhcmVudDpUYWJsZSh7CgkJCU1heENvbHVtbnMgPSAzCgkJfSk6TmV4dFJvdygpCgllbmQKCgktLS8vIENyZWF0ZSBidXR0b25zCglmb3IgXywgQnV0dG9uIGluIG5leHQsIEJ1dHRvbnMgZG8KCQlsb2NhbCBDb250YWluZXIgPSBQYXJlbnQKCQlpZiBub3QgTm9UYWJsZSB0aGVuCgkJCUNvbnRhaW5lciA9IFBhcmVudDpOZXh0Q29sdW1uKCkKCQllbmQKCgkJUmVHdWk6Q2hlY2tDb25maWcoQnV0dG9uLCBCYXNlKQoJCUNvbnRhaW5lcjpCdXR0b24oQnV0dG9uKQoJZW5kCmVuZAoKZnVuY3Rpb24gVWk6Q3JlYXRlV2luZG93KFdpbmRvd0NvbmZpZykKICAgIGxvY2FsIEJhc2VDb25maWcgPSBzZWxmLkJhc2VDb25maWcKCWxvY2FsIENvbmZpZyA9IFByb2Nlc3M6RGVlcENsb25lVGFibGUoQmFzZUNvbmZpZykKCVByb2Nlc3M6TWVyZ2UoQ29uZmlnLCBXaW5kb3dDb25maWcpCgoJLS0vLyBDcmVhdGUgV2luZG93Cglsb2NhbCBXaW5kb3cgPSBSZUd1aTpXaW5kb3coQ29uZmlnKQoKCS0tLy8gU3dpdGNoIHRvIERhcmtUaGVtZSBpbnN0ZWFkIG9mIHRoZSBJbUd1aSB0aGVtZSBpZiB0aGUgZm9udCBjYW5ub3QgYmUgbG9hZGVkCglpZiBub3QgRm9udFN1Y2Nlc3MgdGhlbiAKCQlXaW5kb3c6U2V0VGhlbWUoIkRhcmtUaGVtZSIpCgllbmQKCQoJLS0vLyBDcmVhdGUgV2luZG93CglyZXR1cm4gV2luZG93CmVuZAoKdHlwZSBBc2tDb25maWcgPSB7CglUaXRsZTogc3RyaW5nLAoJQ29udGVudDogdGFibGUsCglPcHRpb25zOiB0YWJsZQp9CmZ1bmN0aW9uIFVpOkFza1VzZXIoQ29uZmlnOiBBc2tDb25maWcpOiBzdHJpbmcKCWxvY2FsIFdpbmRvdyA9IHNlbGYuV2luZG93Cglsb2NhbCBBbnN3ZXJlZCA9IGZhbHNlCgoJLS0vLyBDcmVhdGUgbW9kYWwKCWxvY2FsIE1vZGFsV2luZG93ID0gV2luZG93OlBvcHVwTW9kYWwoewoJCVRpdGxlID0gQ29uZmlnLlRpdGxlCgl9KQoJTW9kYWxXaW5kb3c6TGFiZWwoewoJCVRleHQgPSB0YWJsZS5jb25jYXQoQ29uZmlnLkNvbnRlbnQsICJcbiIpLAoJCVRleHRXcmFwcGVkID0gdHJ1ZQoJfSkKCU1vZGFsV2luZG93OlNlcGFyYXRvcigpCgoJLS0vLyBBbnN3ZXJzCglsb2NhbCBSb3cgPSBNb2RhbFdpbmRvdzpSb3coewoJCUV4cGFuZGVkID0gdHJ1ZQoJfSkKCWZvciBfLCBBbnN3ZXIgaW4gbmV4dCwgQ29uZmlnLk9wdGlvbnMgZG8KCQlSb3c6QnV0dG9uKHsKCQkJVGV4dCA9IEFuc3dlciwKCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQlBbnN3ZXJlZCA9IEFuc3dlcgoJCQkJTW9kYWxXaW5kb3c6Q2xvc2VQb3B1cCgpCgkJCWVuZCwKCQl9KQoJZW5kCgoJcmVwZWF0IHdhaXQoKSB1bnRpbCBBbnN3ZXJlZAoJcmV0dXJuIEFuc3dlcmVkCmVuZAoKZnVuY3Rpb24gVWk6Q3JlYXRlTWFpbldpbmRvdygpCglsb2NhbCBXaW5kb3cgPSBzZWxmOkNyZWF0ZVdpbmRvdygpCglzZWxmLldpbmRvdyA9IFdpbmRvdwoKCS0tLy8gQ2hlY2sgaWYgdGhlIGZvbnQgd2FzIHN1Y2Nlc3NmdWxseSBkb3dubG9hZGVkCglzZWxmOkZvbnRXYXNTdWNjZXNzZnVsKCkKCXNlbGY6QXVyYUNvdW50ZXJTZXJ2aWNlKCkKCgktLS8vIFVpVmlzaWJsZSBmbGFnIGNhbGxiYWNrCglGbGFnczpTZXRGbGFnQ2FsbGJhY2soIlVpVmlzaWJsZSIsIGZ1bmN0aW9uKHNlbGYsIFZpc2libGUpCgkJV2luZG93OlNldFZpc2libGUoVmlzaWJsZSkKCWVuZCkKCglyZXR1cm4gV2luZG93CmVuZAoKZnVuY3Rpb24gVWk6U2hvd01vZGFsKExpbmVzOiB0YWJsZSkKCWxvY2FsIFdpbmRvdyA9IHNlbGYuV2luZG93Cglsb2NhbCBNZXNzYWdlID0gdGFibGUuY29uY2F0KExpbmVzLCAiXG4iKQoKCS0tLy8gTW9kYWwgV2luZG93Cglsb2NhbCBNb2RhbFdpbmRvdyA9IFdpbmRvdzpQb3B1cE1vZGFsKHsKCQlUaXRsZSA9ICJTaWdtYSBTcHkiCgl9KQoJTW9kYWxXaW5kb3c6TGFiZWwoewoJCVRleHQgPSBNZXNzYWdlLAoJCVJpY2hUZXh0ID0gdHJ1ZSwKCQlUZXh0V3JhcHBlZCA9IHRydWUKCX0pCglNb2RhbFdpbmRvdzpCdXR0b24oewoJCVRleHQgPSAiT2theSIsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCU1vZGFsV2luZG93OkNsb3NlUG9wdXAoKQoJCWVuZCwKCX0pCmVuZAoKZnVuY3Rpb24gVWk6U2hvd1Vuc3VwcG9ydGVkRXhlY3V0b3IoTmFtZTogc3RyaW5nKQoJVWk6U2hvd01vZGFsKHsKCQkiVW5mb3J0dW5hdGVseSBTaWdtYSBTcHkgaXMgbm90IHN1cHBvcnRlZCBvbiB5b3VyIGV4ZWN1dG9yIiwKCQkiVGhlIGJlc3QgZnJlZSBvcHRpb24gaXMgU3dpZnQgKGRpc2NvcmQuZ2cvZ2V0c3dpZnRnZykiLAoJCWBcbllvdXIgZXhlY3V0b3I6IHtOYW1lfWAKCX0pCmVuZAoKZnVuY3Rpb24gVWk6U2hvd1Vuc3VwcG9ydGVkKEZ1bmNOYW1lOiBzdHJpbmcpCglVaTpTaG93TW9kYWwoewoJCSJVbmZvcnR1bmF0ZWx5IFNpZ21hIFNweSBpcyBub3Qgc3VwcG9ydGVkIG9uIHlvdXIgZXhlY3V0b3IiLAoJCWBcbk1pc3NpbmcgZnVuY3Rpb246IHtGdW5jTmFtZX1gCgl9KQplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZU9wdGlvbnNGb3JEaWN0KFBhcmVudCwgRGljdDogdGFibGUsIENhbGxiYWNrKQoJbG9jYWwgT3B0aW9ucyA9IHt9CgoJLS0vLyBEaWN0b25hcnkgd3JhcAoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgRGljdCBkbwoJCU9wdGlvbnNbS2V5XSA9IHsKCQkJVmFsdWUgPSBWYWx1ZSwKCQkJTGFiZWwgPSBLZXksCgkJCUNhbGxiYWNrID0gZnVuY3Rpb24oXywgVmFsdWUpCgkJCQlEaWN0W0tleV0gPSBWYWx1ZQoKCQkJCS0tLy8gSW52b2tlIGNhbGxiYWNrCgkJCQlpZiBub3QgQ2FsbGJhY2sgdGhlbiByZXR1cm4gZW5kCgkJCQlDYWxsYmFjaygpCgkJCWVuZAoJCX0KCWVuZAoKCS0tLy8gQ3JlYXRlIGVsZW1lbnRzCglzZWxmOkNyZWF0ZUVsZW1lbnRzKFBhcmVudCwgT3B0aW9ucykKZW5kCgpmdW5jdGlvbiBVaTpDaGVja0tleWJpbmRMYXlvdXQoQ29udGFpbmVyLCBLZXlDb2RlOiBFbnVtLktleUNvZGUsIENhbGxiYWNrKQoJaWYgbm90IEtleUNvZGUgdGhlbiByZXR1cm4gQ29udGFpbmVyIGVuZAoKCS0tLy8gQ3JlYXRlIFJvdyBsYXlvdXQKCUNvbnRhaW5lciA9IENvbnRhaW5lcjpSb3coewoJCUhvcml6b250YWxGbGV4ID0gRW51bS5VSUZsZXhBbGlnbm1lbnQuU3BhY2VCZXR3ZWVuCgl9KQoKCS0tLy8gQWRkIEtleWJpbmQgZWxlbWVudAoJQ29udGFpbmVyOktleWJpbmQoewoJCUxhYmVsID0gIiIsCgkJVmFsdWUgPSBLZXlDb2RlLAoJCUxheW91dE9yZGVyID0gMiwKCQlJZ25vcmVHYW1lUHJvY2Vzc2VkID0gZmFsc2UsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCS0tLy8gQ2hlY2sgaWYga2V5YmluZHMgYXJlIGVuYWJsZWQKCQkJbG9jYWwgRW5hYmxlZCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiS2V5YmluZHNFbmFibGVkIikKCQkJaWYgbm90IEVuYWJsZWQgdGhlbiByZXR1cm4gZW5kCgoJCQktLS8vIEludm9rZSBjYWxsYmFjawoJCQlDYWxsYmFjaygpCgkJZW5kLAoJfSkKCglyZXR1cm4gQ29udGFpbmVyCmVuZAoKZnVuY3Rpb24gVWk6Q3JlYXRlRWxlbWVudHMoUGFyZW50LCBPcHRpb25zKQoJbG9jYWwgT3B0aW9uVHlwZXMgPSBzZWxmLk9wdGlvblR5cGVzCgkKCS0tLy8gQ3JlYXRlIHRhYmxlIGxheW91dAoJbG9jYWwgVGFibGUgPSBQYXJlbnQ6VGFibGUoewoJCU1heENvbHVtbnMgPSAzCgl9KTpOZXh0Um93KCkKCglmb3IgTmFtZSwgRGF0YSBpbiBPcHRpb25zIGRvCgkJbG9jYWwgVmFsdWUgPSBEYXRhLlZhbHVlCgkJbG9jYWwgVHlwZSA9IHR5cGVvZihWYWx1ZSkKCgkJLS0vLyBBZGQgbWlzc2luZyB2YWx1ZXMgaW50byBvcHRpb25zIHRhYmxlCgkJUmVHdWk6Q2hlY2tDb25maWcoRGF0YSwgewoJCQlDbGFzcyA9IE9wdGlvblR5cGVzW1R5cGVdLAoJCQlMYWJlbCA9IE5hbWUsCgkJfSkKCQkKCQktLS8vIENoZWNrIGlmIGEgZWxlbWVudCB0eXBlIGV4aXN0cyBmb3IgdmFsdWUgdHlwZQoJCWxvY2FsIENsYXNzID0gRGF0YS5DbGFzcwoJCWFzc2VydChDbGFzcywgYE5vIHtUeXBlfSB0eXBlIGV4aXN0cyBmb3Igb3B0aW9uYCkKCgkJbG9jYWwgQ29udGFpbmVyID0gVGFibGU6TmV4dENvbHVtbigpCgkJbG9jYWwgQ2hlY2tib3ggPSBuaWwKCgkJLS0vLyBDaGVjayBmb3IgYSBrZXliaW5kIGxheW91dAoJCWxvY2FsIEtleWJpbmQgPSBEYXRhLktleWJpbmQKCQlDb250YWluZXIgPSBzZWxmOkNoZWNrS2V5YmluZExheW91dChDb250YWluZXIsIEtleWJpbmQsIGZ1bmN0aW9uKCkKCQkJQ2hlY2tib3g6VG9nZ2xlKCkKCQllbmQpCgkJCgkJLS0vLyBDcmVhdGUgY29sdW1uIGFuZCBlbGVtZW50CgkJQ2hlY2tib3ggPSBDb250YWluZXJbQ2xhc3NdKENvbnRhaW5lciwgRGF0YSkKCWVuZAplbmQKCi0tLy8gQm9paWlpIHdoYXQgZGlkIHlvdSBzYXkgYWJvdXQgU2lnbWEgU3B5IPCfkoDwn5KACmZ1bmN0aW9uIFVpOkRpc3BsYXlBdXJhKCkKICAgIGxvY2FsIFdpbmRvdyA9IHNlbGYuV2luZG93CiAgICBsb2NhbCBSYW5kID0gc2VsZi5SYW5kb21TZWVkCgoJLS0vLyBBdXJhIChib2lpaWlpKQogICAgbG9jYWwgQVVSQSA9IFJhbmQ6TmV4dEludGVnZXIoMSwgOTk5OTk5OSkKICAgIGxvY2FsIEFVUkFERUxBWSA9IFJhbmQ6TmV4dEludGVnZXIoMSwgNSkKCgktLS8vIFRpdGxlCglsb2NhbCBUaXRsZSA9IGBTaWdtYSBTcHkgfCBBVVJBOiB7QVVSQX1gCglsb2NhbCBTZWFzb25hbCA9IHNlbGY6VHVyblNlYXNvbmFsKFRpdGxlKQogICAgV2luZG93OlNldFRpdGxlKFNlYXNvbmFsKQoKICAgIHdhaXQoQVVSQURFTEFZKQplbmQKCmZ1bmN0aW9uIFVpOkF1cmFDb3VudGVyU2VydmljZSgpCiAgICB0YXNrLnNwYXduKGZ1bmN0aW9uKCkKICAgICAgICB3aGlsZSB0cnVlIGRvCiAgICAgICAgICAgIHNlbGY6RGlzcGxheUF1cmEoKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZVdpbmRvd0NvbnRlbnQoV2luZG93KQogICAgLS0vLyBXaW5kb3cgZ3JvdXAKICAgIGxvY2FsIExheW91dCA9IFdpbmRvdzpMaXN0KHsKICAgICAgICBVaVBhZGRpbmcgPSAyLAogICAgICAgIEhvcml6b250YWxGbGV4ID0gRW51bS5VSUZsZXhBbGlnbm1lbnQuRmlsbCwKICAgICAgICBWZXJ0aWNhbEZsZXggPSBFbnVtLlVJRmxleEFsaWdubWVudC5GaWxsLAogICAgICAgIEZpbGxEaXJlY3Rpb24gPSBFbnVtLkZpbGxEaXJlY3Rpb24uVmVydGljYWwsCiAgICAgICAgRmlsbCA9IHRydWUKICAgIH0pCgoJLS0vLyBSZW1vdGVzIGxpc3QKICAgIHNlbGYuUmVtb3Rlc0xpc3QgPSBMYXlvdXQ6Q2FudmFzKHsKICAgICAgICBTY3JvbGwgPSB0cnVlLAogICAgICAgIFVpUGFkZGluZyA9IDUsCiAgICAgICAgQXV0b21hdGljU2l6ZSA9IEVudW0uQXV0b21hdGljU2l6ZS5Ob25lLAogICAgICAgIEZsZXhNb2RlID0gRW51bS5VSUZsZXhNb2RlLk5vbmUsCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxMzAsIDEsIDApCiAgICB9KQoKCS0tLy8gVGFiIGJveAoJbG9jYWwgSW5mb1NlbGVjdG9yID0gTGF5b3V0OlRhYlNlbGVjdG9yKHsKICAgICAgICBOb0FuaW1hdGlvbiA9IHRydWUsCiAgICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAtMTMwLCAwLjQsIDApLAogICAgfSkKCglzZWxmLkluZm9TZWxlY3RvciA9IEluZm9TZWxlY3RvcgoJc2VsZi5DYW52YXNMYXlvdXQgPSBMYXlvdXQKCgktLS8vIE1ha2UgdGFicwoJc2VsZjpNYWtlRWRpdG9yVGFiKEluZm9TZWxlY3RvcikKCXNlbGY6TWFrZU9wdGlvbnNUYWIoSW5mb1NlbGVjdG9yKQoJCglpZiBDb25maWcuRGVidWcgdGhlbgoJCXNlbGY6Q29uc29sZVRhYihJbmZvU2VsZWN0b3IpCgllbmQKZW5kCgpmdW5jdGlvbiBVaTpDb25zb2xlVGFiKEluZm9TZWxlY3RvcikKCWxvY2FsIFRhYiA9IEluZm9TZWxlY3RvcjpDcmVhdGVUYWIoewoJCU5hbWUgPSAiQ29uc29sZSIKCX0pCgoJbG9jYWwgQ29uc29sZQoJbG9jYWwgQnV0dG9uc1JvdyA9IFRhYjpSb3coKQoKCUJ1dHRvbnNSb3c6QnV0dG9uKHsKCQlUZXh0ID0gIkNsZWFyIiwKCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJQ29uc29sZTpDbGVhcigpCgkJZW5kCgl9KQoJQnV0dG9uc1JvdzpCdXR0b24oewoJCVRleHQgPSAiQ29weSIsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCXRvY2xpcGJvYXJkKENvbnNvbGU6R2V0VmFsdWUoKSkKCQllbmQKCX0pCglCdXR0b25zUm93OkJ1dHRvbih7CgkJVGV4dCA9ICJQYXVzZSIsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxmKQoJCQlsb2NhbCBFbmFibGVkID0gbm90IENvbnNvbGUuRW5hYmxlZAoJCQlsb2NhbCBUZXh0ID0gRW5hYmxlZCBhbmQgIlBhdXNlIiBvciAiUGF1c2VkIgoJCQlzZWxmLlRleHQgPSBUZXh0CgoJCQktLS8vIFVwZGF0ZSBjb25zb2xlCgkJCUNvbnNvbGUuRW5hYmxlZCA9IEVuYWJsZWQKCQllbmQsCgl9KQoJQnV0dG9uc1JvdzpFeHBhbmQoKQoKCS0tLy8gQ3JlYXRlIGNvbnNvbGUKCUNvbnNvbGUgPSBUYWI6Q29uc29sZSh7CgkJVGV4dCA9ICItLSBDcmVhdGVkIGJ5IGRlcHNvIiwKCQlSZWFkT25seSA9IHRydWUsCgkJQm9yZGVyID0gZmFsc2UsCgkJRmlsbCA9IHRydWUsCgkJRW5hYmxlZCA9IHRydWUsCgkJQXV0b1Njcm9sbCA9IHRydWUsCgkJUmljaFRleHQgPSB0cnVlLAoJCU1heExpbmVzID0gNTAKCX0pCgoJc2VsZi5Db25zb2xlID0gQ29uc29sZQplbmQKCmZ1bmN0aW9uIFVpOkNvbnNvbGVMb2coLi4uOiBzdHJpbmc/KQoJbG9jYWwgQ29uc29sZSA9IHNlbGYuQ29uc29sZQoJaWYgbm90IENvbnNvbGUgdGhlbiByZXR1cm4gZW5kCgoJQ29uc29sZTpBcHBlbmRUZXh0KC4uLikKZW5kCgpmdW5jdGlvbiBVaTpNYWtlT3B0aW9uc1RhYihJbmZvU2VsZWN0b3IpCglsb2NhbCBUYWIgPSBJbmZvU2VsZWN0b3I6Q3JlYXRlVGFiKHsKCQlOYW1lID0gIk9wdGlvbnMiCgl9KQoKCS0tLy8gQWRkIGdsb2JhbCBvcHRpb25zCglUYWI6U2VwYXJhdG9yKHtUZXh0PSJMb2dzIn0pCglzZWxmOkNyZWF0ZUJ1dHRvbnMoVGFiLCB7CgkJQmFzZSA9IHsKCQkJU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyMCksCgkJCUF1dG9tYXRpY1NpemUgPSBFbnVtLkF1dG9tYXRpY1NpemUuWSwKCQl9LAoJCUJ1dHRvbnMgPSB7CgkJCXsKCQkJCVRleHQgPSAiQ2xlYXIgbG9ncyIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBUYWIgPSBBY3RpdmVEYXRhIGFuZCBBY3RpdmVEYXRhLlRhYiBvciBuaWwKCgkJCQkJLS0vLyBSZW1vdmUgdGhlIFJlbW90ZSB0YWIKCQkJCQlpZiBUYWIgdGhlbgoJCQkJCQlJbmZvU2VsZWN0b3I6UmVtb3ZlVGFiKFRhYikKCQkJCQllbmQKCgkJCQkJLS0vLyBDbGVhciBhbGwgbG9nIGVsZW1lbnRzCgkJCQkJQWN0aXZlRGF0YSA9IG5pbAoJCQkJCXNlbGY6Q2xlYXJMb2dzKCkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJDbGVhciBibG9ja3MiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJUHJvY2VzczpVcGRhdGVBbGxSZW1vdGVEYXRhKCJCbG9ja2VkIiwgZmFsc2UpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQ2xlYXIgZXhjbHVkZXMiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJUHJvY2VzczpVcGRhdGVBbGxSZW1vdGVEYXRhKCJFeGNsdWRlZCIsIGZhbHNlKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkpvaW4gRGlzY29yZCIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlQcm9jZXNzOlByb21wdERpc2NvcmRJbnZpdGUoInM5bmdtVURXZ2IiKQoJCQkJCXNlbGY6U2V0Q2xpcGJvYXJkKCJodHRwczovL2Rpc2NvcmQuZ2cvczluZ21VRFdnYiIpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQ29weSBHaXRodWIiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJc2VsZjpTZXRDbGlwYm9hcmQoImh0dHBzOi8vZ2l0aHViLmNvbS9Kc3NzaWVlL1NpZ21hLVNweSIpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiRWRpdCBTcG9vZnMiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJc2VsZjpFZGl0RmlsZSgiUmV0dXJuIHNwb29mcy5sdWEiLCB0cnVlLCBmdW5jdGlvbihXaW5kb3csIENvbnRlbnQ6IHN0cmluZykKCQkJCQkJV2luZG93OkNsb3NlKCkKCQkJCQkJQ29tbUNoYW5uZWw6RmlyZSgiVXBkYXRlU3Bvb2ZzIiwgQ29udGVudCkKCQkJCQllbmQpCgkJCQllbmQsCgkJCX0KCQl9Cgl9KQoKCS0tLy8gRmxhZyBvcHRpb25zCglUYWI6U2VwYXJhdG9yKHtUZXh0PSJTZXR0aW5ncyJ9KQoJc2VsZjpDcmVhdGVFbGVtZW50cyhUYWIsIEZsYWdzOkdldEZsYWdzKCkpCgoJc2VsZjpBZGREZXRhaWxzU2VjdGlvbihUYWIpCmVuZAoKZnVuY3Rpb24gVWk6QWRkRGV0YWlsc1NlY3Rpb24oT3B0aW9uc1RhYikKCU9wdGlvbnNUYWI6U2VwYXJhdG9yKHtUZXh0PSJJbmZvcm1hdGlvbiJ9KQoJT3B0aW9uc1RhYjpCdWxsZXRUZXh0KHsKCQlSb3dzID0gewoJCQkiU2lnbWEgc3B5IC0gV3JpdHRlbiBieSBkZXBzbyEiLAoJCQkiTGlicmFyaWVzOiBSb2Jsb3gtUGFyc2VyLCBEZWFyLVJlR3VpIiwKCQkJIlRoYW5rIHlvdSBzeW4ubHVhIGZvciBzdWdnZXN0aW5nIEkgbWFrZSB0aGlzIgoJCX0KCX0pCmVuZAoKbG9jYWwgZnVuY3Rpb24gTWFrZUFjdGl2ZURhdGFDYWxsYmFjayhOYW1lOiBzdHJpbmcpCglyZXR1cm4gZnVuY3Rpb24oLi4uKQoJCWlmIG5vdCBBY3RpdmVEYXRhIHRoZW4gcmV0dXJuIGVuZAoJCXJldHVybiBBY3RpdmVEYXRhW05hbWVdKEFjdGl2ZURhdGEsIC4uLikKCWVuZAplbmQKCmZ1bmN0aW9uIFVpOk1ha2VFZGl0b3JUYWIoSW5mb1NlbGVjdG9yKQoJbG9jYWwgRGVmYXVsdCA9IHNlbGYuRGVmYXVsdEVkaXRvckNvbnRlbnQKCWxvY2FsIFN5bnRheENvbG9ycyA9IENvbmZpZy5TeW50YXhDb2xvcnMKCgktLS8vIENyZWF0ZSB0YWIKCWxvY2FsIEVkaXRvclRhYiA9IEluZm9TZWxlY3RvcjpDcmVhdGVUYWIoewoJCU5hbWUgPSAiRWRpdG9yIgoJfSkKCgktLS8vIElERQoJbG9jYWwgQ29kZUVkaXRvciA9IEVkaXRvclRhYjpDb2RlRWRpdG9yKHsKCQlGaWxsID0gdHJ1ZSwKCQlFZGl0YWJsZSA9IHRydWUsCgkJRm9udFNpemUgPSAxMywKCQlDb2xvcnMgPSBTeW50YXhDb2xvcnMsCgkJRm9udEZhY2UgPSBUZXh0Rm9udCwKCQlUZXh0ID0gRGVmYXVsdAoJfSkKCgktLS8vIEJ1dHRvbnMKCWxvY2FsIEJ1dHRvbnNSb3cgPSBFZGl0b3JUYWI6Um93KCkKCXNlbGY6Q3JlYXRlQnV0dG9ucyhCdXR0b25zUm93LCB7CgkJTm9UYWJsZSA9IHRydWUsCgkJQnV0dG9ucyA9IHsKCQkJewoJCQkJVGV4dCA9ICJDb3B5IiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIFNjcmlwdCA9IENvZGVFZGl0b3I6R2V0VGV4dCgpCgkJCQkJc2VsZjpTZXRDbGlwYm9hcmQoU2NyaXB0KQoJCQkJZW5kCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiUnVuIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIFNjcmlwdCA9IENvZGVFZGl0b3I6R2V0VGV4dCgpCgkJCQkJbG9jYWwgRnVuYywgRXJyb3IgPSBsb2Fkc3RyaW5nKFNjcmlwdCwgIlNpZ21hU3B5LVVTRVJTQ1JJUFQiKQoKCQkJCQktLS8vIFN5bnRheCBjaGVjawoJCQkJCWlmIG5vdCBGdW5jIHRoZW4KCQkJCQkJc2VsZjpTaG93TW9kYWwoeyJFcnJvciBydW5uaW5nIHNjcmlwdCFcbiIsIEVycm9yfSkKCQkJCQkJcmV0dXJuCgkJCQkJZW5kCgoJCQkJCUZ1bmMoKQoJCQkJZW5kCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiR2V0IHJldHVybiIsCgkJCQlDYWxsYmFjayA9IE1ha2VBY3RpdmVEYXRhQ2FsbGJhY2soIkdldFJldHVybiIpCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiU2NyaXB0IiwKCQkJCUNhbGxiYWNrID0gTWFrZUFjdGl2ZURhdGFDYWxsYmFjaygiU2NyaXB0T3B0aW9ucyIpCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQnVpbGQiLAoJCQkJQ2FsbGJhY2sgPSBNYWtlQWN0aXZlRGF0YUNhbGxiYWNrKCJCdWlsZFNjcmlwdCIpCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiUG9wLW91dCIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBTY3JpcHQgPSBDb2RlRWRpdG9yOkdldFRleHQoKQoJCQkJCWxvY2FsIFRpbGUgPSBBY3RpdmVEYXRhIGFuZCBBY3RpdmVEYXRhLlRhc2sgb3IgIlNpZ21hIFNweSIKCQkJCQlzZWxmOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3coU2NyaXB0LCB7CgkJCQkJCVRpdGxlID0gVGlsZQoJCQkJCX0pCgkJCQllbmQKCQkJfSwKCQl9Cgl9KQoJCglzZWxmLkNvZGVFZGl0b3IgPSBDb2RlRWRpdG9yCmVuZAoKZnVuY3Rpb24gVWk6U2hvdWxkRm9jdXMoVGFiKTogYm9vbGVhbgoJbG9jYWwgSW5mb1NlbGVjdG9yID0gc2VsZi5JbmZvU2VsZWN0b3IKCWxvY2FsIEFjdGl2ZVRhYiA9IEluZm9TZWxlY3Rvci5BY3RpdmVUYWIKCgktLS8vIElmIHRoZXJlIGlzIGFuIGVtcHR5IHRhYgoJaWYgbm90IEFjdGl2ZVRhYiB0aGVuCgkJcmV0dXJuIHRydWUKCWVuZAoKCXJldHVybiBJbmZvU2VsZWN0b3I6Q29tcGFyZVRhYnMoQWN0aXZlVGFiLCBUYWIpCmVuZAoKZnVuY3Rpb24gVWk6TWFrZUVkaXRvclBvcG91dFdpbmRvdyhDb250ZW50OiBzdHJpbmcsIFdpbmRvd0NvbmZpZzogdGFibGUpCglsb2NhbCBXaW5kb3cgPSBzZWxmOkNyZWF0ZVdpbmRvdyhXaW5kb3dDb25maWcpCglsb2NhbCBCdXR0b25zID0gV2luZG93Q29uZmlnLkJ1dHRvbnMgb3Ige30KCWxvY2FsIENvbG9ycyA9IENvbmZpZy5TeW50YXhDb2xvcnMKCglsb2NhbCBDb2RlRWRpdG9yID0gV2luZG93OkNvZGVFZGl0b3IoewoJCVRleHQgPSBDb250ZW50LAoJCUVkaXRhYmxlID0gdHJ1ZSwKCQlGaWxsID0gdHJ1ZSwKCQlGb250U2l6ZSA9IDEzLAoJCUNvbG9ycyA9IENvbG9ycywKCQlGb250RmFjZSA9IFRleHRGb250Cgl9KQoKCS0tLy8gRGVmYXVsdCBidXR0b25zCgl0YWJsZS5pbnNlcnQoQnV0dG9ucywgewoJCVRleHQgPSAiQ29weSIsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCWxvY2FsIFNjcmlwdCA9IENvZGVFZGl0b3I6R2V0VGV4dCgpCgkJCXNlbGY6U2V0Q2xpcGJvYXJkKFNjcmlwdCkKCQllbmQKCX0pCgoJLS0vLyBCdXR0b25zCglsb2NhbCBCdXR0b25zUm93ID0gV2luZG93OlJvdygpCglzZWxmOkNyZWF0ZUJ1dHRvbnMoQnV0dG9uc1JvdywgewoJCU5vVGFibGUgPSB0cnVlLAoJCUJ1dHRvbnMgPSBCdXR0b25zCgl9KQoKCVdpbmRvdzpDZW50ZXIoKQoJcmV0dXJuIENvZGVFZGl0b3IsIFdpbmRvdwplbmQKCmZ1bmN0aW9uIFVpOkVkaXRGaWxlKEZpbGVQYXRoOiBzdHJpbmcsIEluRm9sZGVyOiBib29sZWFuLCBPblNhdmVGdW5jOiAoKHRhYmxlLCBzdHJpbmcpIC0+IG5pbCk/KQoJbG9jYWwgRm9sZGVyID0gRmlsZXMuRm9sZGVyTmFtZQoJbG9jYWwgQ29kZUVkaXRvciwgV2luZG93CgoJLS0vLyBSZWxhdGl2ZSB0byBTaWdtYSBTcHkgZm9sZGVyCglpZiBJbkZvbGRlciB0aGVuCgkJRmlsZVBhdGggPSBge0ZvbGRlcn0ve0ZpbGVQYXRofWAKCWVuZAoKCS0tLy8gR2V0IGZpbGUgY29udGVudAoJbG9jYWwgQ29udGVudCA9IHJlYWRmaWxlKEZpbGVQYXRoKQoJQ29udGVudCA9IENvbnRlbnQ6Z3N1YigiXHJcbiIsICJcbiIpCgkKCWxvY2FsIEJ1dHRvbnMgPSB7CgkJewoJCQlUZXh0ID0gIlNhdmUiLAoJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCWxvY2FsIFNjcmlwdCA9IENvZGVFZGl0b3I6R2V0VGV4dCgpCgkJCQlsb2NhbCBTdWNjZXNzLCBFcnJvciA9IGxvYWRzdHJpbmcoU2NyaXB0LCAiU2lnbWFTcHktRWRpdG9yIikKCgkJCQktLS8vIFN5bnRheCBjaGVjawoJCQkJaWYgbm90IFN1Y2Nlc3MgdGhlbgoJCQkJCXNlbGY6U2hvd01vZGFsKHsiRXJyb3Igc2F2aW5nIGZpbGUhXG4iLCBFcnJvcn0pCgkJCQkJcmV0dXJuCgkJCQllbmQKCQkJCQoJCQkJLS0vLyBTYXZlIGNvbnRlbnRzCgkJCQl3cml0ZWZpbGUoRmlsZVBhdGgsIFNjcmlwdCkKCgkJCQktLS8vIEludm9rZSBvbiBzYXZlIGZ1bmN0aW9uCgkJCQlpZiBPblNhdmVGdW5jIHRoZW4KCQkJCQlPblNhdmVGdW5jKFdpbmRvdywgU2NyaXB0KQoJCQkJZW5kCgkJCWVuZAoJCX0KCX0KCgktLS8vIENyZWF0ZSBFZGl0b3IgV2luZG93CglDb2RlRWRpdG9yLCBXaW5kb3cgPSBzZWxmOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3coQ29udGVudCwgewoJCVRpdGxlID0gYEVkaXRpbmc6IHtGaWxlUGF0aH1gLAoJCUJ1dHRvbnMgPSBCdXR0b25zCgl9KQplbmQKCnR5cGUgTWVudU9wdGlvbnMgPSB7Cglbc3RyaW5nXTogKEd1aUJ1dHRvbiwgLi4uYW55KSAtPiBuaWwKfQpmdW5jdGlvbiBVaTpNYWtlQnV0dG9uTWVudShCdXR0b246IEluc3RhbmNlLCBVbnBhY2s6IHRhYmxlLCBPcHRpb25zOiBNZW51T3B0aW9ucykKCWxvY2FsIFdpbmRvdyA9IHNlbGYuV2luZG93Cglsb2NhbCBQb3B1cCA9IFdpbmRvdzpQb3B1cENhbnZhcyh7CgkJUmVsYXRpdmVUbyA9IEJ1dHRvbiwKCQlNYXhTaXplWCA9IDUwMCwKCX0pCgoJLS0vLyBDcmVhdGUgU2VsZWN0YWJsZXMgZm9yIHN0cmluZywgZnVuY3Rpb24KCWZvciBOYW1lLCBGdW5jIGluIE9wdGlvbnMgZG8KCQkgUG9wdXA6U2VsZWN0YWJsZSh7CgkJCVRleHQgPSBOYW1lLAoJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCUZ1bmMoUHJvY2VzczpVbnBhY2soVW5wYWNrKSkKCQkJZW5kLAoJCX0pCgllbmQKZW5kCgpmdW5jdGlvbiBVaTpSZW1vdmVQcmV2aW91c1RhYihUaXRsZTogc3RyaW5nKTogYm9vbGVhbgoJLS0vLyBObyBwcmV2aW91cyB0YWJzCglpZiBub3QgQWN0aXZlRGF0YSB0aGVuIAoJCXJldHVybiBmYWxzZSAKCWVuZAoKCS0tLy8gVGFiU2VsZWN0b3IKCWxvY2FsIEluZm9TZWxlY3RvciA9IHNlbGYuSW5mb1NlbGVjdG9yCgoJLS0vLyBQcmV2aW91cyBlbGVtZW50cwoJbG9jYWwgUHJldmlvdXNUYWIgPSBBY3RpdmVEYXRhLlRhYgoJbG9jYWwgUHJldmlvdXNTZWxlY3RhYmxlID0gQWN0aXZlRGF0YS5TZWxlY3RhYmxlCgoJLS0vLyBSZW1vdmUgcHJldmlvdXMgdGFiIGFuZCBzZXQgc2VsZWN0YWJsZSBmb2N1cwoJbG9jYWwgVGFiRm9jdXNlZCA9IHNlbGY6U2hvdWxkRm9jdXMoUHJldmlvdXNUYWIpCglJbmZvU2VsZWN0b3I6UmVtb3ZlVGFiKFByZXZpb3VzVGFiKQoJUHJldmlvdXNTZWxlY3RhYmxlOlNldFNlbGVjdGVkKGZhbHNlKQoKCS0tLy8gQ3JlYXRlIG5ldyB0YWIKCXJldHVybiBUYWJGb2N1c2VkCmVuZAoKZnVuY3Rpb24gVWk6TWFrZVRhYmxlSGVhZGVycyhUYWJsZSwgUm93czogdGFibGUpCglsb2NhbCBIZWFkZXJSb3cgPSBUYWJsZTpIZWFkZXJSb3coKQoJZm9yIF8sIENhdGFnb3J5IGluIFJvd3MgZG8KCQlsb2NhbCBDb2x1bW4gPSBIZWFkZXJSb3c6TmV4dENvbHVtbigpCgkJQ29sdW1uOkxhYmVsKHtUZXh0PUNhdGFnb3J5fSkKCWVuZAplbmQKCmZ1bmN0aW9uIFVpOkRlY29tcGlsZShFZGl0b3I6IHRhYmxlLCBTY3JpcHQ6IFNjcmlwdCkKCWxvY2FsIEhlYWRlciA9ICItLUJPT0lJSUkgVEhJUyBJUyBTTyBUVUZGIEZMSVBQWSBTS0lCSURJIEFVUkEgKFNJR01BIFNQWSkiCglFZGl0b3I6U2V0VGV4dCgiLS1EZWNvbXBpbGluZy4uLiArOTk5OTk5OSBBVVJBIChtYW5nbyBwaG9uaykiKQoKCS0tLy8gRGVjb21waWxlIHNjcmlwdAoJbG9jYWwgRGVjb21waWxlZCwgSXNFcnJvciA9IFByb2Nlc3M6RGVjb21waWxlKFNjcmlwdCkKCgktLS8vIEFkZCBoZWFkZXIgZm9yIHN1Y2Nlc3NmdWwgZGVjb21waWxhdGlvbnMKCWlmIG5vdCBJc0Vycm9yIHRoZW4KCQlEZWNvbXBpbGVkID0gYHtIZWFkZXJ9XG57RGVjb21waWxlZH1gCgllbmQKCglFZGl0b3I6U2V0VGV4dChEZWNvbXBpbGVkKQplbmQKCnR5cGUgRGlzcGxheVRhYmxlQ29uZmlnID0gewoJUm93czogdGFibGUsCglGbGFnczogdGFibGU/LAoJVG9EaXNwbGF5OiB0YWJsZSwKCVRhYmxlOiB0YWJsZQp9CmZ1bmN0aW9uIFVpOkRpc3BsYXlUYWJsZShQYXJlbnQsIENvbmZpZzogRGlzcGxheVRhYmxlQ29uZmlnKTogdGFibGUKCS0tLy8gQ29uZmlndXJhdGlvbgoJbG9jYWwgUm93cyA9IENvbmZpZy5Sb3dzCglsb2NhbCBGbGFncyA9IENvbmZpZy5GbGFncwoJbG9jYWwgRGF0YVRhYmxlID0gQ29uZmlnLlRhYmxlCglsb2NhbCBUb0Rpc3BsYXkgPSBDb25maWcuVG9EaXNwbGF5CgoJRmxhZ3MuTWF4Q29sdW1ucyA9ICNSb3dzCgoJLS0vLyBDcmVhdGUgdGFibGUKCWxvY2FsIFRhYmxlID0gUGFyZW50OlRhYmxlKEZsYWdzKQoKCS0tLy8gVGFibGUgaGVhZGVycwoJc2VsZjpNYWtlVGFibGVIZWFkZXJzKFRhYmxlLCBSb3dzKQoKCS0tLy8gVGFibGUgbGF5b3V0Cglmb3IgUm93SW5kZXgsIE5hbWUgaW4gVG9EaXNwbGF5IGRvCgkJbG9jYWwgUm93ID0gVGFibGU6Um93KCkKCQkKCQktLS8vIENyZWF0ZSBDb2x1bW5zCgkJZm9yIENvdW50LCBDYXRhZ29yeSBpbiBSb3dzIGRvCgkJCWxvY2FsIENvbHVtbiA9IFJvdzpOZXh0Q29sdW1uKCkKCQkJCgkJCS0tLy8gVmFsdWUgdGV4dAoJCQlsb2NhbCBWYWx1ZSA9IENhdGFnb3J5ID09ICJOYW1lIiBhbmQgTmFtZSBvciBEYXRhVGFibGVbTmFtZV0KCQkJaWYgbm90IFZhbHVlIHRoZW4gY29udGludWUgZW5kCgoJCQktLS8vIENyZWF0ZSBmaWx0ZXJlZCBsYWJlbAoJCQlsb2NhbCBTdHJpbmcgPSBzZWxmOkZpbHRlck5hbWUoYHtWYWx1ZX1gLCAxNTApCgkJCUNvbHVtbjpMYWJlbCh7VGV4dD1TdHJpbmd9KQoJCWVuZAoJZW5kCgoJcmV0dXJuIFRhYmxlCmVuZAoKZnVuY3Rpb24gVWk6U2V0Rm9jdXNlZFJlbW90ZShEYXRhKQoJLS0vLyBVbnBhY2sgcmVtb3RlIGRhdGEKCWxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBNZXRob2QgPSBEYXRhLk1ldGhvZAoJbG9jYWwgSXNSZWNlaXZlID0gRGF0YS5Jc1JlY2VpdmUKCWxvY2FsIFNjcmlwdCA9IERhdGEuQ2FsbGluZ1NjcmlwdAoJbG9jYWwgQ2xhc3NEYXRhID0gRGF0YS5DbGFzc0RhdGEKCWxvY2FsIEhlYWRlckRhdGEgPSBEYXRhLkhlYWRlckRhdGEKCWxvY2FsIFZhbHVlU3dhcHMgPSBEYXRhLlZhbHVlU3dhcHMKCWxvY2FsIEFyZ3MgPSBEYXRhLkFyZ3MKCWxvY2FsIElkID0gRGF0YS5JZAoKCS0tLy8gRmxhZ3MKCWxvY2FsIFRhYmxlQXJncyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiVGFibGVBcmdzIikKCWxvY2FsIE5vVmFyaWFibGVzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJOb1ZhcmlhYmxlcyIpCgoJLS0vLyBVbnBhY2sgaW5mbwoJbG9jYWwgUmVtb3RlRGF0YSA9IFByb2Nlc3M6R2V0UmVtb3RlRGF0YShJZCkKCWxvY2FsIElzUmVtb3RlRnVuY3Rpb24gPSBDbGFzc0RhdGEuSXNSZW1vdGVGdW5jdGlvbgoJbG9jYWwgUmVtb3RlTmFtZSA9IHNlbGY6RmlsdGVyTmFtZShge1JlbW90ZX1gLCA1MCkKCgktLS8vIFVJIGRhdGEKCWxvY2FsIENvZGVFZGl0b3IgPSBzZWxmLkNvZGVFZGl0b3IKCWxvY2FsIFRvRGlzcGxheSA9IHNlbGYuRGlzcGxheVJlbW90ZUluZm8KCWxvY2FsIEluZm9TZWxlY3RvciA9IHNlbGYuSW5mb1NlbGVjdG9yCgoJbG9jYWwgVGFiRm9jdXNlZCA9IHNlbGY6UmVtb3ZlUHJldmlvdXNUYWIoKQoJbG9jYWwgVGFiID0gSW5mb1NlbGVjdG9yOkNyZWF0ZVRhYih7CgkJTmFtZSA9IHNlbGY6RmlsdGVyTmFtZShgUmVtb3RlOiB7UmVtb3RlTmFtZX1gLCA1MCksCgkJRm9jdXNlZCA9IFRhYkZvY3VzZWQKCX0pCgoJLS0vLyBDcmVhdGUgbmV3IHBhcnNlcgoJbG9jYWwgTW9kdWxlID0gR2VuZXJhdGlvbjpOZXdQYXJzZXIoewoJCU5vVmFyaWFibGVzID0gTm9WYXJpYWJsZXMKCX0pCglsb2NhbCBQYXJzZXIgPSBNb2R1bGUuUGFyc2VyCglsb2NhbCBGb3JtYXR0ZXIgPSBNb2R1bGUuRm9ybWF0dGVyCglGb3JtYXR0ZXI6U2V0VmFsdWVTd2FwcyhWYWx1ZVN3YXBzKQoKCS0tLy8gU2V0IHRoaXMgbG9nIHRvIGJlIHNlbGVjdGVkCglBY3RpdmVEYXRhID0gRGF0YQoJRGF0YS5UYWIgPSBUYWIKCURhdGEuU2VsZWN0YWJsZTpTZXRTZWxlY3RlZCh0cnVlKQoKCWxvY2FsIGZ1bmN0aW9uIFNldElERVRleHQoQ29udGVudDogc3RyaW5nLCBUYXNrOiBzdHJpbmc/KQoJCURhdGEuVGFzayA9IFRhc2sgb3IgIlNpZ21hIFNweSIKCQlDb2RlRWRpdG9yOlNldFRleHQoQ29udGVudCkKCWVuZAoJbG9jYWwgZnVuY3Rpb24gRGF0YUNvbm5lY3Rpb24oTmFtZSwgLi4uKQoJCWxvY2FsIEFyZ3MgPSB7Li4ufQoJCXJldHVybiBmdW5jdGlvbigpCgkJCXJldHVybiBEYXRhW05hbWVdKERhdGEsIFByb2Nlc3M6VW5wYWNrKEFyZ3MpKQoJCWVuZAoJZW5kCglsb2NhbCBmdW5jdGlvbiBTY3JpcHRDaGVjayhTY3JpcHQsIE5vTWlzc2luZ0NoZWNrOiBib29sZWFuKTogYm9vbGVhbj8KCQktLS8vIFJlamVjdCBjbGllbnQgZXZlbnRzCgkJaWYgSXNSZWNlaXZlIHRoZW4gCgkJCVVpOlNob3dNb2RhbCh7CgkJCQkiUmVjaWV2ZXMgZG8gbm90IGhhdmUgYSBzY3JpcHQgYmVjYXVzZSBpdCdzIGEgQ29ubmVjdGlvbiIKCQkJfSkKCQkJcmV0dXJuIAoJCWVuZAoKCQktLS8vIENoZWNrIGlmIHNjcmlwdCBleGlzdHMKCQlpZiBub3QgU2NyaXB0IGFuZCBub3QgTm9NaXNzaW5nQ2hlY2sgdGhlbiAKCQkJVWk6U2hvd01vZGFsKHsiVGhlIFNjcmlwdCBoYXMgYmVlbiBkZXN0cm95ZWQgYnkgdGhlIGdhbWUgKC05OTk5OTk5IEFVUkEpIn0pCgkJCXJldHVybgoJCWVuZAoKCQlyZXR1cm4gdHJ1ZQoJZW5kCgoJLS0vLyBGdW5jdGlvbnMKCWZ1bmN0aW9uIERhdGE6U2NyaXB0T3B0aW9ucyhCdXR0b246IEd1aUJ1dHRvbikKCQlVaTpNYWtlQnV0dG9uTWVudShCdXR0b24sIHtzZWxmfSwgewoJCQlbIkNhbGxlciBJbmZvIl0gPSBEYXRhQ29ubmVjdGlvbigiR2VuZXJhdGVJbmZvIiksCgkJCVsiRGVjb21waWxlIl0gPSBEYXRhQ29ubmVjdGlvbigiRGVjb21waWxlIiwgIlNvdXJjZVNjcmlwdCIpLAoJCQlbIkRlY29tcGlsZSBDYWxsaW5nIl0gPSBEYXRhQ29ubmVjdGlvbigiRGVjb21waWxlIiwgIkNhbGxpbmdTY3JpcHQiKSwKCQkJWyJSZXBlYXQgQ2FsbCJdID0gRGF0YUNvbm5lY3Rpb24oIlJlcGVhdENhbGwiKSwKCQkJWyJTYXZlIEJ5dGVjb2RlIl0gPSBEYXRhQ29ubmVjdGlvbigiU2F2ZUJ5dGVjb2RlIiksCgkJfSkKCWVuZAoJZnVuY3Rpb24gRGF0YTpCdWlsZFNjcmlwdChCdXR0b246IEd1aUJ1dHRvbikKCQlVaTpNYWtlQnV0dG9uTWVudShCdXR0b24sIHtzZWxmfSwgewoJCQlbIlNhdmUiXSA9IERhdGFDb25uZWN0aW9uKCJTYXZlU2NyaXB0IiksCgkJCVsiQ2FsbCBSZW1vdGUiXSA9IERhdGFDb25uZWN0aW9uKCJNYWtlU2NyaXB0IiwgIlJlbW90ZSIpLAoJCQlbIkJsb2NrIFJlbW90ZSJdID0gRGF0YUNvbm5lY3Rpb24oIk1ha2VTY3JpcHQiLCAiQmxvY2siKSwKCQkJWyJSZXBlYXQgRm9yIl0gPSBEYXRhQ29ubmVjdGlvbigiTWFrZVNjcmlwdCIsICJSZXBlYXQiKSwKCQkJWyJTcGFtIFJlbW90ZSJdID0gRGF0YUNvbm5lY3Rpb24oIk1ha2VTY3JpcHQiLCAiU3BhbSIpCgkJfSkKCWVuZAoJZnVuY3Rpb24gRGF0YTpTYXZlU2NyaXB0KCkKCQlsb2NhbCBGaWxlUGF0aCA9IEdlbmVyYXRpb246VGltZVN0YW1wRmlsZShzZWxmLlRhc2spCgkJd3JpdGVmaWxlKEZpbGVQYXRoLCBDb2RlRWRpdG9yOkdldFRleHQoKSkKCgkJVWk6U2hvd01vZGFsKHsiU2F2ZWQgc2NyaXB0IHRvIiwgRmlsZVBhdGh9KQoJZW5kCglmdW5jdGlvbiBEYXRhOlNhdmVCeXRlY29kZSgpCgkJLS0vLyBQcm9ibGVtIGNoZWNrCgkJaWYgbm90IFNjcmlwdENoZWNrKFNjcmlwdCwgdHJ1ZSkgdGhlbiByZXR1cm4gZW5kCgoJCS0tLy8gZ2V0c2NyaXB0Ynl0ZWNvZGUKICAgIAlsb2NhbCBTdWNjZXNzLCBCeXRlY29kZSA9IHBjYWxsKGdldHNjcmlwdGJ5dGVjb2RlLCBTY3JpcHQpCgkJaWYgbm90IFN1Y2Nlc3MgdGhlbgoJCQlVaTpTaG93TW9kYWwoeyJGYWlsZWQgdG8gZ2V0IFNjcmlwdGUgYnl0ZWNvZGUgKC05OTk5OTk5IEFVUkEpIn0pCgkJCXJldHVybgoJCWVuZAoKCQktLS8vIFNhdmUgZmlsZQoJCWxvY2FsIFBhdGhCYXNlID0gYHtTY3JpcHR9ICVzLnR4dGAKCQlsb2NhbCBGaWxlUGF0aCA9IEdlbmVyYXRpb246VGltZVN0YW1wRmlsZShQYXRoQmFzZSkKCQl3cml0ZWZpbGUoRmlsZVBhdGgsIEJ5dGVjb2RlKQoKCQlVaTpTaG93TW9kYWwoeyJTYXZlZCBieXRlY29kZSB0byIsIEZpbGVQYXRofSkKCWVuZAoJZnVuY3Rpb24gRGF0YTpNYWtlU2NyaXB0KFNjcmlwdFR5cGU6IHN0cmluZykKCQlsb2NhbCBTY3JpcHQgPSBHZW5lcmF0aW9uOlJlbW90ZVNjcmlwdChNb2R1bGUsIHNlbGYsIFNjcmlwdFR5cGUpCgkJU2V0SURFVGV4dChTY3JpcHQsIGBFZGl0aW5nOiB7UmVtb3RlTmFtZX0ubHVhYCkKCWVuZAoJZnVuY3Rpb24gRGF0YTpSZXBlYXRDYWxsKCkKCQlsb2NhbCBTaWduYWwgPSBIb29rOkluZGV4KFJlbW90ZSwgTWV0aG9kKQoKCQlpZiBJc1JlY2VpdmUgdGhlbgoJCQlmaXJlc2lnbmFsKFNpZ25hbCwgUHJvY2VzczpVbnBhY2soQXJncykpCgkJZWxzZQoJCQlTaWduYWwoUmVtb3RlLCBQcm9jZXNzOlVucGFjayhBcmdzKSkKCQllbmQKCWVuZAoJZnVuY3Rpb24gRGF0YTpHZXRSZXR1cm4oKQoJCWxvY2FsIFJldHVyblZhbHVlcyA9IHNlbGYuUmV0dXJuVmFsdWVzCgoJCS0tLy8gRXJyb3IgbWVzc2FnZXMKCQlpZiBub3QgSXNSZW1vdGVGdW5jdGlvbiB0aGVuCgkJCVVpOlNob3dNb2RhbCh7IlRoZSBSZW1vdGUgaXMgbm90IGEgUmVtb3RlIEZ1bmN0aW9uICgtOTk5OTk5OSBBVVJBKSJ9KQoJCQlyZXR1cm4KCQllbmQKCQlpZiBub3QgUmV0dXJuVmFsdWVzIHRoZW4KCQkJVWk6U2hvd01vZGFsKHsiTm8gcmV0dXJuIHZhbHVlcyAoLTk5OTk5OTkgQVVSQSkifSkKCQkJcmV0dXJuCgkJZW5kCgoJCS0tLy8gR2VuZXJhdGUgc2NyaXB0CgkJbG9jYWwgU2NyaXB0ID0gR2VuZXJhdGlvbjpUYWJsZVNjcmlwdChNb2R1bGUsIFJldHVyblZhbHVlcykKCQlTZXRJREVUZXh0KFNjcmlwdCwgYFJldHVybiBWYWx1ZXMgZm9yOiB7UmVtb3RlTmFtZX1gKQoJZW5kCglmdW5jdGlvbiBEYXRhOkdlbmVyYXRlSW5mbygpCgkJLS0vLyBQcm9ibGVtIGNoZWNrCgkJaWYgbm90IFNjcmlwdENoZWNrKG5pbCwgdHJ1ZSkgdGhlbiByZXR1cm4gZW5kCgoJCS0tLy8gR2VuZXJhdGUgc2NyaXB0CgkJbG9jYWwgU2NyaXB0ID0gR2VuZXJhdGlvbjpBZHZhbmNlZEluZm8oTW9kdWxlLCBzZWxmKQoJCVNldElERVRleHQoU2NyaXB0LCBgQWR2YW5jZWQgSW5mbyBmb3I6IHtSZW1vdGVOYW1lfWApCgllbmQKCWZ1bmN0aW9uIERhdGE6RGVjb21waWxlKFdoaWNoU2NyaXB0OiBzdHJpbmcpCgkJbG9jYWwgRGVjb21waWxlUG9wb3V0ID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJEZWNvbXBpbGVQb3BvdXQiKQoJCWxvY2FsIFRvRGVjb21waWxlID0gRGF0YVtXaGljaFNjcmlwdF0KCQlsb2NhbCBFZGl0b3IgPSBDb2RlRWRpdG9yCgoJCS0tLy8gUHJvYmxlbSBjaGVjawoJCWlmIG5vdCBTY3JpcHRDaGVjayhUb0RlY29tcGlsZSwgdHJ1ZSkgdGhlbiByZXR1cm4gZW5kCgkJbG9jYWwgVGFzayA9IFVpOkZpbHRlck5hbWUoYFZpZXdpbmc6IHtUb0RlY29tcGlsZX0ubHVhYCwgMjAwKQoJCQoJCS0tLy8gQXV0b21hdGljYWxseSBQb3Atb3V0IHRoZSBlZGl0b3IgZm9yIGRlY29tcGlsaW5nIGlmIGVuYWJsZWQKCQlpZiBEZWNvbXBpbGVQb3BvdXQgdGhlbgoJCQlFZGl0b3IgPSBVaTpNYWtlRWRpdG9yUG9wb3V0V2luZG93KCIiLCB7CgkJCQlUaXRsZSA9IFRhc2sKCQkJfSkKCQllbmQKCgkJVWk6RGVjb21waWxlKEVkaXRvciwgVG9EZWNvbXBpbGUpCgllbmQKCQoJLS0vLyBSZW1vdGVPcHRpb25zCglzZWxmOkNyZWF0ZU9wdGlvbnNGb3JEaWN0KFRhYiwgUmVtb3RlRGF0YSwgZnVuY3Rpb24oKQoJCVByb2Nlc3M6VXBkYXRlUmVtb3RlRGF0YShJZCwgUmVtb3RlRGF0YSkKCWVuZCkKCgktLS8vIEluc3RhbmNlIG9wdGlvbnMKCXNlbGY6Q3JlYXRlQnV0dG9ucyhUYWIsIHsKCQlCYXNlID0gewoJCQlTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDIwKSwKCQkJQXV0b21hdGljU2l6ZSA9IEVudW0uQXV0b21hdGljU2l6ZS5ZLAoJCX0sCgkJQnV0dG9ucyA9IHsKCQkJewoJCQkJVGV4dCA9ICJDb3B5IHNjcmlwdCBwYXRoIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCVNldENsaXBib2FyZChQYXJzZXI6TWFrZVBhdGhTdHJpbmcoewoJCQkJCQlPYmplY3QgPSBTY3JpcHQsCgkJCQkJCU5vVmFyaWFibGVzID0gdHJ1ZQoJCQkJCX0pKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkNvcHkgcmVtb3RlIHBhdGgiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJU2V0Q2xpcGJvYXJkKFBhcnNlcjpNYWtlUGF0aFN0cmluZyh7CgkJCQkJCU9iamVjdCA9IFJlbW90ZSwKCQkJCQkJTm9WYXJpYWJsZXMgPSB0cnVlCgkJCQkJfSkpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiUmVtb3ZlIGxvZyIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlJbmZvU2VsZWN0b3I6UmVtb3ZlVGFiKFRhYikKCQkJCQlEYXRhLlNlbGVjdGFibGU6UmVtb3ZlKCkKCQkJCQlIZWFkZXJEYXRhOlJlbW92ZSgpCgkJCQkJQWN0aXZlRGF0YSA9IG5pbAoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkR1bXAgbG9ncyIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBMb2dzID0gSGVhZGVyRGF0YS5FbnRyaWVzCgkJCQkJbG9jYWwgRmlsZVBhdGggPSBHZW5lcmF0aW9uOkR1bXBMb2dzKExvZ3MpCgkJCQkJc2VsZjpTaG93TW9kYWwoeyJTYXZlZCBkdW1wIHRvIiwgRmlsZVBhdGh9KQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIlZpZXcgQ29ubmVjdGlvbnMiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgTWV0aG9kID0gQ2xhc3NEYXRhLlJlY2VpdmVbMV0KCQkJCQlsb2NhbCBTaWduYWwgPSBSZW1vdGVbTWV0aG9kXQoJCQkJCXNlbGY6Vmlld0Nvbm5lY3Rpb25zKFJlbW90ZU5hbWUsIFNpZ25hbCkKCQkJCWVuZCwKCQkJfQoJCX0KCX0pCgoJLS0vLyBSZW1vdGUgaW5mb3JtYXRpb24gdGFibGUKCXNlbGY6RGlzcGxheVRhYmxlKFRhYiwgewoJCVJvd3MgPSB7Ik5hbWUiLCAiVmFsdWUifSwKCQlUYWJsZSA9IERhdGEsCgkJVG9EaXNwbGF5ID0gVG9EaXNwbGF5LAoJCUZsYWdzID0gewoJCQlCb3JkZXIgPSB0cnVlLAoJCQlSb3dCYWNrZ3JvdW5kID0gdHJ1ZSwKCQkJTWF4Q29sdW1ucyA9IDIKCQl9Cgl9KQoJCgktLS8vIEFyZ3VtZW50cyB0YWJsZSBzY3JpcHQKCWlmIFRhYmxlQXJncyB0aGVuCgkJbG9jYWwgUGFyc2VkID0gR2VuZXJhdGlvbjpUYWJsZVNjcmlwdChNb2R1bGUsIEFyZ3MpCgkJU2V0SURFVGV4dChQYXJzZWQsIGBBcmd1bWVudHMgZm9yIHtSZW1vdGVOYW1lfWApCgkJcmV0dXJuCgllbmQKCgktLS8vIFJlbW90ZSBjYWxsIHNjcmlwdAoJRGF0YTpNYWtlU2NyaXB0KCJSZW1vdGUiKQplbmQKCmZ1bmN0aW9uIFVpOlZpZXdDb25uZWN0aW9ucyhSZW1vdGVOYW1lOiBzdHJpbmcsIFNpZ25hbDogUkJYU2NyaXB0Q29ubmVjdGlvbikKCWxvY2FsIFdpbmRvdyA9IHNlbGY6Q3JlYXRlV2luZG93KHsKCQlUaXRsZSA9IGBDb25uZWN0aW9ucyBmb3I6IHtSZW1vdGVOYW1lfWAsCgkJU2l6ZSA9IFVEaW0yLmZyb21PZmZzZXQoNDUwLCAyNTApCgl9KQoKCWxvY2FsIFRvRGlzcGxheSA9IHsKCQkiRW5hYmxlZCIsCgkJIkx1YUNvbm5lY3Rpb24iLAoJCSJTY3JpcHQiCgl9CgoJLS0vLyBHZXQgRmlsdGVyZWQgY29ubmVjdGlvbnMKCWxvY2FsIENvbm5lY3Rpb25zID0gUHJvY2VzczpGaWx0ZXJDb25uZWN0aW9ucyhTaWduYWwsIFRvRGlzcGxheSkKCgktLS8vIFRhYmxlCglsb2NhbCBUYWJsZSA9IFdpbmRvdzpUYWJsZSh7CgkJQm9yZGVyID0gdHJ1ZSwKCQlSb3dCYWNrZ3JvdW5kID0gdHJ1ZSwKCQlNYXhDb2x1bW5zID0gMwoJfSkKCglsb2NhbCBCdXR0b25zRm9yVmFsdWVzID0gewoJCVsiU2NyaXB0Il0gPSBmdW5jdGlvbihSb3csIFZhbHVlKQoJCQlSb3c6QnV0dG9uKHsKCQkJCVRleHQgPSAiRGVjb21waWxlIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIFRhc2sgPSBzZWxmOkZpbHRlck5hbWUoYFZpZXdpbmc6IHtWYWx1ZX0ubHVhYCwgMjAwKQoJCQkJCWxvY2FsIEVkaXRvciA9IHNlbGY6TWFrZUVkaXRvclBvcG91dFdpbmRvdyhuaWwsIHsKCQkJCQkJVGl0bGUgPSBUYXNrCgkJCQkJfSkKCQkJCQlzZWxmOkRlY29tcGlsZShFZGl0b3IsIFZhbHVlKQoJCQkJZW5kCgkJCX0pCgkJZW5kLAoJCVsiRW5hYmxlZCJdID0gZnVuY3Rpb24oUm93LCBFbmFibGVkLCBDb25uZWN0aW9uKQoJCQlSb3c6QnV0dG9uKHsKCQkJCVRleHQgPSBFbmFibGVkIGFuZCAiRGlzYWJsZSIgb3IgIkVuYWJsZSIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGYpCgkJCQkJRW5hYmxlZCA9IG5vdCBFbmFibGVkCgkJCQkJc2VsZi5UZXh0ID0gRW5hYmxlZCBhbmQgIkRpc2FibGUiIG9yICJFbmFibGUiCgoJCQkJCS0tLy8gRW5hYmxlIG9yIGRpc2FibGUgdGhlIGNvbm5lY3Rpb24KCQkJCQlpZiBFbmFibGVkIHRoZW4KCQkJCQkJQ29ubmVjdGlvbjpFbmFibGUoKQoJCQkJCWVsc2UKCQkJCQkJQ29ubmVjdGlvbjpEaXNhYmxlKCkKCQkJCQllbmQKCQkJCWVuZAoJCQl9KQoJCWVuZAoJfQoKCS0tLy8gTWFrZSBoZWFkZXJzIG9uIHRoZSB0YWJsZQoJc2VsZjpNYWtlVGFibGVIZWFkZXJzKFRhYmxlLCBUb0Rpc3BsYXkpCgoJZm9yIF8sIENvbm5lY3Rpb24gaW4gQ29ubmVjdGlvbnMgZG8KCQlsb2NhbCBSb3cgPSBUYWJsZTpSb3coKQoKCQlmb3IgXywgUHJvcGVydHkgaW4gVG9EaXNwbGF5IGRvCgkJCWxvY2FsIENvbHVtbiA9IFJvdzpOZXh0Q29sdW1uKCkKCQkJbG9jYWwgQ29sdW1uUm93ID0gQ29sdW1uOlJvdygpCgoJCQlsb2NhbCBWYWx1ZSA9IENvbm5lY3Rpb25bUHJvcGVydHldCgkJCWxvY2FsIENhbGxiYWNrID0gQnV0dG9uc0ZvclZhbHVlc1tQcm9wZXJ0eV0KCgkJCS0tLy8gVmFsdWUgbGFiZWwKCQkJQ29sdW1uUm93OkxhYmVsKHtUZXh0PWB7VmFsdWV9YH0pCgoJCQktLS8vIEFkZCBidXR0b25zCgkJCWlmIENhbGxiYWNrIHRoZW4KCQkJCUNhbGxiYWNrKENvbHVtblJvdywgVmFsdWUsIENvbm5lY3Rpb24pCgkJCWVuZAoJCWVuZAoJZW5kCgoJLS0vLyBDZW50ZXIgV2luZG93CglXaW5kb3c6Q2VudGVyKCkKZW5kCgpmdW5jdGlvbiBVaTpHZXRSZW1vdGVIZWFkZXIoRGF0YTogTG9nKQoJbG9jYWwgTG9nTGltaXQgPSBzZWxmLkxvZ0xpbWl0Cglsb2NhbCBMb2dzID0gc2VsZi5Mb2dzCglsb2NhbCBSZW1vdGVzTGlzdCA9IHNlbGYuUmVtb3Rlc0xpc3QKCgktLS8vIFJlbW90ZSBpbmZvCglsb2NhbCBJZCA9IERhdGEuSWQKCWxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBSZW1vdGVOYW1lID0gc2VsZjpGaWx0ZXJOYW1lKGB7UmVtb3RlfWAsIDMwKQoKCS0tLy8gTm9UcmVlTm9kZXMKCWxvY2FsIE5vVHJlZU5vZGVzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJOb1RyZWVOb2RlcyIpCgoJLS0vLyBDaGVjayBmb3IgZXhpc3RpbmcgVHJlZU5vZGUKCWxvY2FsIEV4aXN0aW5nID0gTG9nc1tJZF0KCWlmIEV4aXN0aW5nIHRoZW4gcmV0dXJuIEV4aXN0aW5nIGVuZAoKCS0tLy8gSGVhZGVyIGRhdGEKCWxvY2FsIEhlYWRlckRhdGEgPSB7CQoJCUxvZ0NvdW50ID0gMCwKCQlEYXRhID0gRGF0YSwKCQlFbnRyaWVzID0ge30KCX0KCgktLS8vIEluY3JlbWVudCB0cmVlbm9kZSBjb3VudAoJUmVtb3Rlc0NvdW50ICs9IDEKCgktLS8vIENyZWF0ZSBuZXcgdHJlZW5vZGUgZWxlbWVudAoJaWYgbm90IE5vVHJlZU5vZGVzIHRoZW4KCQlIZWFkZXJEYXRhLlRyZWVOb2RlID0gUmVtb3Rlc0xpc3Q6VHJlZU5vZGUoewoJCQlMYXlvdXRPcmRlciA9IC0xICogUmVtb3Rlc0NvdW50LAoJCQlUaXRsZSA9IFJlbW90ZU5hbWUKCQl9KQoJZW5kCgoJZnVuY3Rpb24gSGVhZGVyRGF0YTpDaGVja0xpbWl0KCkKCQlsb2NhbCBFbnRyaWVzID0gc2VsZi5FbnRyaWVzCgkJaWYgI0VudHJpZXMgPCBMb2dMaW1pdCB0aGVuIHJldHVybiBlbmQKCQkJCgkJLS0vLyBHZXQgYW5kIHJlbW92ZSBsYXN0IGVsZW1lbnQKCQlsb2NhbCBMb2cgPSB0YWJsZS5yZW1vdmUoRW50cmllcywgMSkKCQlMb2cuU2VsZWN0YWJsZTpSZW1vdmUoKQoJZW5kCgoJZnVuY3Rpb24gSGVhZGVyRGF0YTpMb2dBZGRlZChEYXRhKQoJCS0tLy8gSW5jcmVtZW50IGxvZyBjb3VudAoJCXNlbGYuTG9nQ291bnQgKz0gMQoJCXNlbGY6Q2hlY2tMaW1pdCgpCgoJCS0tLy8gQWRkIGVudHJ5CgkJbG9jYWwgRW50cmllcyA9IHNlbGYuRW50cmllcwoJCXRhYmxlLmluc2VydChFbnRyaWVzLCBEYXRhKQoJCQoJCXJldHVybiBzZWxmCgllbmQKCglmdW5jdGlvbiBIZWFkZXJEYXRhOlJlbW92ZSgpCgkJLS0vLyBSZW1vdmUgVHJlZU5vZGUKCQlsb2NhbCBUcmVlTm9kZSA9IHNlbGYuVHJlZU5vZGUKCQlpZiBUcmVlTm9kZSB0aGVuCgkJCVRyZWVOb2RlOlJlbW92ZSgpCgkJZW5kCgoJCS0tLy8gQ2xlYXIgdGFibGVzIGZyb20gbWVtb3J5CgkJTG9nc1tJZF0gPSBuaWwKCQl0YWJsZS5jbGVhcihIZWFkZXJEYXRhKQoJZW5kCgoJTG9nc1tJZF0gPSBIZWFkZXJEYXRhCglyZXR1cm4gSGVhZGVyRGF0YQplbmQKCmZ1bmN0aW9uIFVpOkNsZWFyTG9ncygpCglsb2NhbCBMb2dzID0gc2VsZi5Mb2dzCglsb2NhbCBSZW1vdGVzTGlzdCA9IHNlbGYuUmVtb3Rlc0xpc3QKCgktLS8vIENsZWFyIGFsbCBlbGVtZW50cwoJUmVtb3Rlc0NvdW50ID0gMAoJUmVtb3Rlc0xpc3Q6Q2xlYXJDaGlsZEVsZW1lbnRzKCkKCgktLS8vIENsZWFyIGxvZ3MgZnJvbSBtZW1vcnkKCXRhYmxlLmNsZWFyKExvZ3MpCmVuZAoKZnVuY3Rpb24gVWk6UXVldWVMb2coRGF0YSkKCWxvY2FsIExvZ1F1ZXVlID0gc2VsZi5Mb2dRdWV1ZQoJUHJvY2VzczpNZXJnZShEYXRhLCB7CgkJQXJncyA9IFByb2Nlc3M6RGVlcENsb25lVGFibGUoRGF0YS5BcmdzKSwKCX0pCgoJaWYgRGF0YS5SZXR1cm5WYWx1ZXMgdGhlbgogICAgICAgIERhdGEuUmV0dXJuVmFsdWVzID0gUHJvY2VzczpEZWVwQ2xvbmVUYWJsZShEYXRhLlJldHVyblZhbHVlcykKICAgIGVuZAoJCiAgICB0YWJsZS5pbnNlcnQoTG9nUXVldWUsIERhdGEpCmVuZAoKZnVuY3Rpb24gVWk6UHJvY2Vzc0xvZ1F1ZXVlKCkKCWxvY2FsIFF1ZXVlID0gc2VsZi5Mb2dRdWV1ZQogICAgaWYgI1F1ZXVlIDw9IDAgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBDcmVhdGUgYSBsb2cgZWxlbWVudCBmb3IgZWFjaCBpbiB0aGUgUXVldWUKICAgIGZvciBJbmRleCwgRGF0YSBpbiBuZXh0LCBRdWV1ZSBkbwogICAgICAgIHNlbGY6Q3JlYXRlTG9nKERhdGEpCiAgICAgICAgdGFibGUucmVtb3ZlKFF1ZXVlLCBJbmRleCkKICAgIGVuZAplbmQKCmZ1bmN0aW9uIFVpOkJlZ2luTG9nU2VydmljZSgpCgljb3JvdXRpbmUud3JhcChmdW5jdGlvbigpCgkJd2hpbGUgdHJ1ZSBkbwoJCQlzZWxmOlByb2Nlc3NMb2dRdWV1ZSgpCgkJCXRhc2sud2FpdCgpCgkJZW5kCgllbmQpKCkKZW5kCgpmdW5jdGlvbiBVaTpGaWx0ZXJOYW1lKE5hbWU6IHN0cmluZywgQ2hhcmFjdGVyTGltaXQ6IG51bWJlcj8pOiBzdHJpbmcKCWxvY2FsIFRyaW1tZWQgPSBOYW1lOnN1YigxLCBDaGFyYWN0ZXJMaW1pdCBvciAyMCkKCWxvY2FsIEZpbHRyZWQgPSBUcmltbWVkOmdzdWIoIltcblxyXSIsICIiKQoJRmlsdHJlZCA9IEdlbmVyYXRpb246TWFrZVByaW50YWJsZShGaWx0cmVkKQoKCXJldHVybiBGaWx0cmVkCmVuZAoKZnVuY3Rpb24gVWk6Q3JlYXRlTG9nKERhdGE6IExvZykKCS0tLy8gVW5wYWNrIGxvZyBkYXRhCiAgICBsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQoJbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKICAgIGxvY2FsIEFyZ3MgPSBEYXRhLkFyZ3MKICAgIGxvY2FsIElzUmVjZWl2ZSA9IERhdGEuSXNSZWNlaXZlCglsb2NhbCBJZCA9IERhdGEuSWQKCWxvY2FsIFRpbWVzdGFtcCA9IERhdGEuVGltZXN0YW1wCglsb2NhbCBJc0V4cGxvaXQgPSBEYXRhLklzRXhwbG9pdAoJCglsb2NhbCBJc05pbFBhcmVudCA9IEhvb2s6SW5kZXgoUmVtb3RlLCAiUGFyZW50IikgPT0gbmlsCglsb2NhbCBSZW1vdGVEYXRhID0gUHJvY2VzczpHZXRSZW1vdGVEYXRhKElkKQoKCS0tLy8gUGF1c2VkCglsb2NhbCBQYXVzZWQgPSBGbGFnczpHZXRGbGFnVmFsdWUoIlBhdXNlZCIpCglpZiBQYXVzZWQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBDaGVjayBjYWxsZXIgKElnbm9yZSBleHBsb2l0IGNhbGxzKQoJbG9jYWwgTG9nRXhwbG9pdCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTG9nRXhwbG9pdCIpCglpZiBub3QgTG9nRXhwbG9pdCBhbmQgSXNFeHBsb2l0IHRoZW4gcmV0dXJuIGVuZAoKCS0tLy8gSWdub3JlTmlsCglsb2NhbCBJZ25vcmVOaWwgPSBGbGFnczpHZXRGbGFnVmFsdWUoIklnbm9yZU5pbCIpCglpZiBJZ25vcmVOaWwgYW5kIElzTmlsUGFyZW50IHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tLy8gTG9nUmVjaXZlcyBjaGVjawoJbG9jYWwgTG9nUmVjaXZlcyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTG9nUmVjaXZlcyIpCglpZiBub3QgTG9nUmVjaXZlcyBhbmQgSXNSZWNlaXZlIHRoZW4gcmV0dXJuIGVuZAoKCWxvY2FsIFNlbGVjdE5ld2VzdCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiU2VsZWN0TmV3ZXN0IikKCWxvY2FsIE5vVHJlZU5vZGVzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJOb1RyZWVOb2RlcyIpCgogICAgLS0vLyBFeGNsdWRlZCBjaGVjawogICAgaWYgUmVtb3RlRGF0YS5FeGNsdWRlZCB0aGVuIHJldHVybiBlbmQKCgktLS8vIERlc2VyaWFsaXplIGFyZ3VtZW50cwoJQXJncyA9IENvbW11bmljYXRpb246RGVzZXJpYWxpemVUYWJsZShBcmdzKQoKCS0tLy8gRGVlcCBjbG9uZSBkYXRhCglsb2NhbCBDbG9uZWRBcmdzID0gUHJvY2VzczpEZWVwQ2xvbmVUYWJsZShBcmdzKQoJRGF0YS5BcmdzID0gQ2xvbmVkQXJncwoJRGF0YS5WYWx1ZVN3YXBzID0gR2VuZXJhdGlvbjpNYWtlVmFsdWVTd2Fwc1RhYmxlKFRpbWVzdGFtcCkKCgktLS8vIEdlbmVyYXRlIGxvZyB0aXRsZQoJbG9jYWwgQ29sb3IgPSBDb25maWcuTWV0aG9kQ29sb3JzW01ldGhvZDpsb3dlcigpXQoJbG9jYWwgVGV4dCA9IE5vVHJlZU5vZGVzIGFuZCBge1JlbW90ZX0gfCB7TWV0aG9kfWAgb3IgTWV0aG9kCgoJLS0vLyBGaW5kU3RyaW5nRm9yTmFtZSBjaGVjawoJbG9jYWwgRmluZFN0cmluZyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiRmluZFN0cmluZ0Zvck5hbWUiKQoJaWYgRmluZFN0cmluZyB0aGVuCgkJZm9yIF8sIEFyZyBpbiBuZXh0LCBDbG9uZWRBcmdzIGRvCgkJCWlmIHR5cGVvZihBcmcpID09ICJzdHJpbmciIHRoZW4KCQkJCWxvY2FsIEZpbHRyZWQgPSBzZWxmOkZpbHRlck5hbWUoQXJnKQoJCQkJVGV4dCA9IGB7RmlsdHJlZH0gfCB7VGV4dH1gCgkJCQlicmVhawoJCQllbmQKCQllbmQKCWVuZAoKCS0tLy8gRmV0Y2ggSGVhZGVyRGF0YSBieSB0aGUgUmVtb3RlSUQgdXNlZCBmb3Igc3RhY2tpbmcKCWxvY2FsIEhlYWRlciA9IHNlbGY6R2V0UmVtb3RlSGVhZGVyKERhdGEpCglsb2NhbCBSZW1vdGVzTGlzdCA9IHNlbGYuUmVtb3Rlc0xpc3QKCglsb2NhbCBMb2dDb3VudCA9IEhlYWRlci5Mb2dDb3VudAoJbG9jYWwgVHJlZU5vZGUgPSBIZWFkZXIuVHJlZU5vZGUgCglsb2NhbCBQYXJlbnQgPSBUcmVlTm9kZSBvciBSZW1vdGVzTGlzdAoKCS0tLy8gSW5jcmVhc2UgbG9nIGNvdW50IC0gVHJlZU5vZGVzIGFyZSBpbiBHZXRSZW1vdGVIZWFkZXIgZnVuY3Rpb24KCWlmIE5vVHJlZU5vZGVzIHRoZW4KCQlSZW1vdGVzQ291bnQgKz0gMQoJCUxvZ0NvdW50ID0gUmVtb3Rlc0NvdW50CgllbmQKCiAgICAtLS8vIENyZWF0ZSBmb2N1cyBidXR0b24KCURhdGEuSGVhZGVyRGF0YSA9IEhlYWRlcgoJRGF0YS5TZWxlY3RhYmxlID0gUGFyZW50OlNlbGVjdGFibGUoewoJCVRleHQgPSBUZXh0LAogICAgICAgIExheW91dE9yZGVyID0gLTEgKiBMb2dDb3VudCwKCQlUZXh0Q29sb3IzID0gQ29sb3IsCgkJVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkxlZnQsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCXNlbGY6U2V0Rm9jdXNlZFJlbW90ZShEYXRhKQoJCWVuZCwKICAgIH0pCgoJSGVhZGVyOkxvZ0FkZGVkKERhdGEpCgoJLS0vLyBBdXRvIHNlbGVjdCBjaGVjawoJbG9jYWwgR3JvdXBTZWxlY3RlZCA9IEFjdGl2ZURhdGEgYW5kIEFjdGl2ZURhdGEuSGVhZGVyRGF0YSA9PSBIZWFkZXIKCWlmIFNlbGVjdE5ld2VzdCBhbmQgR3JvdXBTZWxlY3RlZCB0aGVuCgkJc2VsZjpTZXRGb2N1c2VkUmVtb3RlKERhdGEpCgllbmQKZW5kCgpyZXR1cm4gVWkK]]
},Generation={'base64',
[[dHlwZSB0YWJsZSA9IHsKCVthbnldOiBhbnkKfQoKdHlwZSBSZW1vdGVEYXRhID0gewoJUmVtb3RlOiBJbnN0YW5jZSwKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglNZXRhTWV0aG9kOiBzdHJpbmcsCglBcmdzOiB0YWJsZSwKCU1ldGhvZDogc3RyaW5nLAogICAgVHJhbnNmZXJUeXBlOiBzdHJpbmcsCglWYWx1ZVJlcGxhY2VtZW50czogdGFibGUsCglOb1ZhcmlhYmxlczogYm9vbGVhbj8KfQoKLS0vLyBNb2R1bGUKbG9jYWwgR2VuZXJhdGlvbiA9IHsKCUR1bXBCYXNlTmFtZSA9ICJTaWdtYVNweS1EdW1wICVzLmx1YSIsIC0tICItLSBHZW5lcmF0ZWQgd2l0aCBzaWdtYSBzcHkgQk9JSUlJSUlJSUkgKCs5OTk5OTk5IEFVUkEpXG4iCglIZWFkZXIgPSAiLS0gR2VuZXJhdGVkIHdpdGggU2lnbWEgU3B5IEdpdGh1YjogaHR0cHM6Ly9naXRodWIuY29tL0pzc3NpZWUvU2lnbWEtU3B5XG4iLAoJU2NyaXB0VGVtcGxhdGVzID0gewoJCVsiUmVtb3RlIl0gPSB7CgkJCXsiJVJlbW90ZUNhbGwlIn0KCQl9LAoJCVsiU3BhbSJdID0gewoJCQl7IndoaWxlIHdhaXQoKSBkbyJ9LAoJCQl7IiVSZW1vdGVDYWxsJSIsIDJ9LAoJCQl7ImVuZCJ9CgkJfSwKCQlbIlJlcGVhdCJdID0gewoJCQl7ImZvciBJbmRleCA9IDEsIDEwIGRvIn0sCgkJCXsiJVJlbW90ZUNhbGwlIiwgMn0sCgkJCXsiZW5kIn0KCQl9LAoJCVsiQmxvY2siXSA9IHsKCQkJWyJfX2luZGV4Il0gPSB7CgkJCQl7ImxvY2FsIE9sZDsgT2xkID0gaG9va2Z1bmN0aW9uKCVTaWduYWwlLCBmdW5jdGlvbihzZWxmLCAuLi4pIn0sCgkJCQl7ImlmIHNlbGYgPT0gJVJlbW90ZSUgdGhlbiIsIDJ9LAoJCQkJeyJyZXR1cm4iLCAzfSwKCQkJCXsiZW5kIiwgMn0sCgkJCQl7InJldHVybiBPbGQoc2VsZiwgLi4uKSIsIDJ9LAoJCQkJeyJlbmQpIn0KCQkJfSwKCQkJWyJfX25hbWVjYWxsIl0gPSB7CgkJCQl7ImxvY2FsIE9sZDsgT2xkID0gaG9va21ldGFtZXRob2QoZ2FtZSwgXCJfX25hbWVjYWxsXCIsIGZ1bmN0aW9uKHNlbGYsIC4uLikifSwKCQkJCXsibG9jYWwgTWV0aG9kID0gZ2V0bmFtZWNhbGxtZXRob2QoKSIsIDJ9LAoJCQkJeyJpZiBzZWxmID09ICVSZW1vdGUlIGFuZCBNZXRob2QgPT0gXCIlTWV0aG9kJVwiIHRoZW4iLCAyfSwKCQkJCXsicmV0dXJuIiwgM30sCgkJCQl7ImVuZCIsIDJ9LAoJCQkJeyJyZXR1cm4gT2xkKHNlbGYsIC4uLikiLCAyfSwKCQkJCXsiZW5kKSJ9CgkJCX0sCgkJCVsiQ29ubmVjdCJdID0gewoJCQkJeyJmb3IgXywgQ29ubmVjdGlvbiBpbiBnZXRjb25uZWN0aW9ucyglU2lnbmFsJSkgZG8ifSwKCQkJCXsiQ29ubmVjdGlvbjpEaXNhYmxlKCkiLCAyfSwKCQkJCXsiZW5kIn0KCQkJfQoJCX0KCX0KfQoKLS0vLyBNb2R1bGVzCmxvY2FsIENvbmZpZwpsb2NhbCBIb29rCmxvY2FsIFBhcnNlck1vZHVsZQpsb2NhbCBGbGFncwpsb2NhbCBUaGlzU2NyaXB0ID0gc2NyaXB0Cgpsb2NhbCBmdW5jdGlvbiBNZXJnZShCYXNlOiB0YWJsZSwgTmV3OiB0YWJsZT8pCglpZiBub3QgTmV3IHRoZW4gcmV0dXJuIGVuZAoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgTmV3IGRvCgkJQmFzZVtLZXldID0gVmFsdWUKCWVuZAplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246SW5pdChEYXRhOiB0YWJsZSkKICAgIGxvY2FsIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKCWxvY2FsIENvbmZpZ3VyYXRpb24gPSBNb2R1bGVzLkNvbmZpZ3VyYXRpb24KCgktLS8vIE1vZHVsZXMKCUNvbmZpZyA9IE1vZHVsZXMuQ29uZmlnCglIb29rID0gTW9kdWxlcy5Ib29rCglGbGFncyA9IE1vZHVsZXMuRmxhZ3MKCQoJLS0vLyBJbXBvcnQgcGFyc2VyCglsb2NhbCBQYXJzZXJVcmwgPSBDb25maWd1cmF0aW9uLlBhcnNlclVybAoJc2VsZjpMb2FkUGFyc2VyKFBhcnNlclVybCkKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOk1ha2VQcmludGFibGUoU3RyaW5nOiBzdHJpbmcpOiBzdHJpbmcKCWxvY2FsIEZvcm1hdHRlciA9IFBhcnNlck1vZHVsZS5Nb2R1bGVzLkZvcm1hdHRlcgoJcmV0dXJuIEZvcm1hdHRlcjpNYWtlUHJpbnRhYmxlKFN0cmluZykKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOlRpbWVTdGFtcEZpbGUoRmlsZVBhdGg6IHN0cmluZyk6IHN0cmluZwoJbG9jYWwgVGltZVN0YW1wID0gb3MuZGF0ZSgiJVktJW0tJWRfJUgtJU0tJVMiKQoJbG9jYWwgRm9ybWF0dGVkID0gRmlsZVBhdGg6Zm9ybWF0KFRpbWVTdGFtcCkKCXJldHVybiBGb3JtYXR0ZWQKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOldyaXRlRHVtcChDb250ZW50OiBzdHJpbmcpOiBzdHJpbmcKCWxvY2FsIER1bXBCYXNlTmFtZSA9IHNlbGYuRHVtcEJhc2VOYW1lCglsb2NhbCBGaWxlUGF0aCA9IHNlbGY6VGltZVN0YW1wRmlsZShEdW1wQmFzZU5hbWUpCgoJLS0vLyBXcml0ZSB0byBmaWxlCgl3cml0ZWZpbGUoRmlsZVBhdGgsIENvbnRlbnQpCgoJcmV0dXJuIEZpbGVQYXRoCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpMb2FkUGFyc2VyKE1vZHVsZVVybDogc3RyaW5nKQoJUGFyc2VyTW9kdWxlID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoTW9kdWxlVXJsKSwgIlBhcnNlciIpKCkKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOk1ha2VWYWx1ZVN3YXBzVGFibGUoKTogdGFibGUKCWxvY2FsIEZvcm1hdHRlciA9IFBhcnNlck1vZHVsZS5Nb2R1bGVzLkZvcm1hdHRlcgoJcmV0dXJuIEZvcm1hdHRlcjpNYWtlUmVwbGFjZW1lbnRzKCkKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOlNldFN3YXBzQ2FsbGJhY2soQ2FsbGJhY2s6IChJbnRlcmZhY2U6IHRhYmxlKSAtPiAoKSkKCXNlbGYuU3dhcHNDYWxsYmFjayA9IENhbGxiYWNrCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpHZXRCYXNlKE1vZHVsZSk6IChzdHJpbmcsIGJvb2xlYW4pCglsb2NhbCBOb0NvbW1lbnRzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJOb0NvbW1lbnRzIikKCWxvY2FsIEhlYWRlciA9IHNlbGYuSGVhZGVyCgoJbG9jYWwgQ29kZSA9IE5vQ29tbWVudHMgYW5kICIiIG9yIEhlYWRlcgoKCS0tLy8gR2VuZXJhdGUgdmFyaWFibGVzIGNvZGUKCWxvY2FsIFZhcmlhYmxlcyA9IE1vZHVsZS5QYXJzZXI6TWFrZVZhcmlhYmxlQ29kZSh7CgkJIlNlcnZpY2VzIiwgIlJlbW90ZSIsICJWYXJpYWJsZXMiCgl9LCBOb0NvbW1lbnRzKQoKCWxvY2FsIE5vVmFyaWFibGVzID0gVmFyaWFibGVzID09ICIiCglDb2RlIC4uPSBWYXJpYWJsZXMKCglyZXR1cm4gQ29kZSwgTm9WYXJpYWJsZXMKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkdldFN3YXBzKCkKCWxvY2FsIEZ1bmMgPSBzZWxmLlN3YXBzQ2FsbGJhY2sKCWxvY2FsIFN3YXBzID0ge30KCglsb2NhbCBJbnRlcmZhY2UgPSB7fQoJZnVuY3Rpb24gSW50ZXJmYWNlOkFkZFN3YXAoT2JqZWN0OiBJbnN0YW5jZSwgRGF0YTogdGFibGUpCgkJaWYgbm90IE9iamVjdCB0aGVuIHJldHVybiBlbmQKCQlTd2Fwc1tPYmplY3RdID0gRGF0YQoJZW5kCgoJLS0vLyBJbnZva2UgR2V0U3dhcHMgZnVuY3Rpb24KCUZ1bmMoSW50ZXJmYWNlKQoKCXJldHVybiBTd2FwcwplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246UGlja1ZhcmlhYmxlTmFtZSgpOiBzdHJpbmcKCWxvY2FsIE5hbWVzID0gQ29uZmlnLlZhcmlhYmxlTmFtZXMKCXJldHVybiBOYW1lc1ttYXRoLnJhbmRvbSgxLCAjTmFtZXMpXQplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246TmV3UGFyc2VyKEV4dHJhOiB0YWJsZT8pCglsb2NhbCBWYXJpYWJsZU5hbWUgPSBzZWxmOlBpY2tWYXJpYWJsZU5hbWUoKQoJbG9jYWwgU3dhcHMgPSBzZWxmOkdldFN3YXBzKCkKCglsb2NhbCBDb25maWd1cmF0aW9uID0gewoJCVZhcmlhYmxlQmFzZSA9IFZhcmlhYmxlTmFtZSwKCQlTd2FwcyA9IFN3YXBzLAoJCUluZGV4RnVuYyA9IGZ1bmN0aW9uKC4uLikKCQkJcmV0dXJuIEhvb2s6SW5kZXgoLi4uKQoJCWVuZCwKCX0KCgktLS8vIE1lcmdlIGV4dHJhIGNvbmZpZ3VyYXRpb24KCU1lcmdlKENvbmZpZ3VyYXRpb24sIEV4dHJhKQoKCS0tLy8gQ3JlYXRlIG5ldyBwYXJzZXIgaW5zdGFuY2UKCXJldHVybiBQYXJzZXJNb2R1bGU6TmV3KENvbmZpZ3VyYXRpb24pCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpJbmRlbnQoSW5kZW50U3RyaW5nOiBzdHJpbmcsIExpbmU6IHN0cmluZykKCXJldHVybiBge0luZGVudFN0cmluZ317TGluZX1gCmVuZAoKdHlwZSBDYWxsSW5mbyA9IHsKCUFyZ3VtZW50czogdGFibGUsCglJbmRlbnQ6IG51bWJlciwKCVJlbW90ZVZhcmlhYmxlOiBzdHJpbmcsCglNb2R1bGU6IHRhYmxlCn0KZnVuY3Rpb24gR2VuZXJhdGlvbjpDYWxsUmVtb3RlU2NyaXB0KERhdGEsIEluZm86IENhbGxJbmZvKTogc3RyaW5nCglsb2NhbCBJc1JlY2VpdmUgPSBEYXRhLklzUmVjZWl2ZQoJbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKCWxvY2FsIEFyZ3MgPSBEYXRhLkFyZ3MKCglsb2NhbCBSZW1vdGVWYXJpYWJsZSA9IEluZm8uUmVtb3RlVmFyaWFibGUKCWxvY2FsIEluZGVudCA9IEluZm8uSW5kZW50IG9yIDAKCWxvY2FsIE1vZHVsZSA9IEluZm8uTW9kdWxlCgoJbG9jYWwgVmFyaWFibGVzID0gTW9kdWxlLlZhcmlhYmxlcwoJbG9jYWwgUGFyc2VyID0gTW9kdWxlLlBhcnNlcgoJbG9jYWwgTm9WYXJpYWJsZXMgPSBEYXRhLk5vVmFyaWFibGVzCgoJbG9jYWwgSW5kZW50U3RyaW5nID0gc2VsZjpNYWtlSW5kZW50KEluZGVudCkKCgktLS8vIFBhcnNlIGFyZ3VtZW50cwoJbG9jYWwgUGFyc2VkQXJncywgSXRlbXNDb3VudCwgSXNBcnJheSA9IFBhcnNlcjpQYXJzZVRhYmxlSW50b1N0cmluZyh7CgkJTm9CcmFja2V0cyA9IHRydWUsCgkJTm9WYXJpYWJsZXMgPSBOb1ZhcmlhYmxlcywKCQlUYWJsZSA9IEFyZ3MsCgkJSW5kZW50ID0gSW5kZW50Cgl9KQoKCS0tLy8gQ3JlYXRlIHRhYmxlIHZhcmlhYmxlIGlmIG5vdCBhbiBhcnJheQoJaWYgbm90IElzQXJyYXkgb3IgTm9WYXJpYWJsZXMgdGhlbgoJCVBhcnNlZEFyZ3MgPSBWYXJpYWJsZXM6TWFrZVZhcmlhYmxlKHsKCQkJVmFsdWUgPSAoInslc30iKTpmb3JtYXQoUGFyc2VkQXJncyksCgkJCUNvbW1lbnQgPSBub3QgSXNBcnJheSBhbmQgIkFyZ3VtZW50cyBhcmVuJ3Qgb3JkZXJlZCIgb3IgbmlsLAoJCQlOYW1lID0gIlJlbW90ZUFyZ3MiLAoJCQlDbGFzcyA9ICJSZW1vdGUiCgkJfSkKCWVuZAoKCS0tLy8gV3JhcCBpbiBhIHVucGFjayBpZiB0aGUgdGFibGUgaXMgYSBkaWN0CglpZiBJdGVtc0NvdW50ID4gMCBhbmQgbm90IElzQXJyYXkgdGhlbgoJCVBhcnNlZEFyZ3MgPSBgdW5wYWNrKHtQYXJzZWRBcmdzfSwgMSwgdGFibGUubWF4bih7UGFyc2VkQXJnc30pKWAKCWVuZAoKCS0tLy8gRmlyZXNpZ25hbCBzY3JpcHQgZm9yIGNsaWVudCByZWNpZXZlcwoJaWYgSXNSZWNlaXZlIHRoZW4KCQlsb2NhbCBTZWNvbmQgPSBJdGVtc0NvdW50IDw9IDAgYW5kICIiIG9yIGAsIHtQYXJzZWRBcmdzfWAKCQlsb2NhbCBTaWduYWwgPSBge1JlbW90ZVZhcmlhYmxlfS57TWV0aG9kfWAKCgkJbG9jYWwgQ29kZSA9IGAtLSBUaGlzIGRhdGEgd2FzIHJlY2VpdmVkIGZyb20gdGhlIHNlcnZlcmAKCQlQYXJzZWRBcmdzID0gc2VsZjpJbmRlbnQoSW5kZW50U3RyaW5nLCBDb2RlKQoJCUNvZGUgLi49IGBcbntJbmRlbnRTdHJpbmd9ZmlyZXNpZ25hbCh7U2lnbmFsfXtTZWNvbmR9KWAKCQkKCQlyZXR1cm4gQ29kZQoJZW5kCgkKCS0tLy8gUmVtb3RlIGludm9rZSBzY3JpcHQKCXJldHVybiBge1JlbW90ZVZhcmlhYmxlfTp7TWV0aG9kfSh7UGFyc2VkQXJnc30pYAplbmQKCi0tLy8gVmFyaWFibGVzOiAlVmFyaWFibGVOYW1lJQpmdW5jdGlvbiBHZW5lcmF0aW9uOkFwcGx5VmFyaWFibGVzKFN0cmluZzogc3RyaW5nLCBWYXJpYWJsZXM6IHRhYmxlLCAuLi4pOiBzdHJpbmcKCWZvciBWYXJpYWJsZSwgVmFsdWUgaW4gVmFyaWFibGVzIGRvCgkJLS0vLyBJbnZva2UgdmFsdWUgZnVuY3Rpb24KCQlpZiB0eXBlb2YoVmFsdWUpID09ICJmdW5jdGlvbiIgdGhlbgoJCQlWYWx1ZSA9IFZhbHVlKC4uLikKCQllbmQKCgkJU3RyaW5nID0gU3RyaW5nOmdzdWIoYCUle1ZhcmlhYmxlfSUlYCwgZnVuY3Rpb24oKQoJCQlyZXR1cm4gVmFsdWUKCQllbmQpCgllbmQKCXJldHVybiBTdHJpbmcKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOk1ha2VJbmRlbnQoSW5kZW50OiBudW1iZXIpCglyZXR1cm4gc3RyaW5nLnJlcCgiCSIsIEluZGVudCkKZW5kCgp0eXBlIFNjcmlwdERhdGEgPSB7CglWYXJpYWJsZXM6IHRhYmxlLAoJTWV0YU1ldGhvZDogc3RyaW5nCn0KZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlQ2FsbENvZGUoU2NyaXB0VHlwZTogc3RyaW5nLCBEYXRhOiBTY3JpcHREYXRhKTogc3RyaW5nCglsb2NhbCBTY3JpcHRUZW1wbGF0ZXMgPSBzZWxmLlNjcmlwdFRlbXBsYXRlcwoJbG9jYWwgVGVtcGxhdGUgPSBTY3JpcHRUZW1wbGF0ZXNbU2NyaXB0VHlwZV0KCglhc3NlcnQoVGVtcGxhdGUsIGB7U2NyaXB0VHlwZX0gaXMgbm90IGEgdmFsaWQgc2NyaXB0IHR5cGUhYCkKCglsb2NhbCBWYXJpYWJsZXMgPSBEYXRhLlZhcmlhYmxlcwoJbG9jYWwgTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZAoJbG9jYWwgTWV0YU1ldGhvZHMgPSB7Il9faW5kZXgiLCAiX19uYW1lY2FsbCIsICJDb25uZWN0In0KCglsb2NhbCBmdW5jdGlvbiBDb21waWxlKFRlbXBsYXRlOiB0YWJsZSk6IHN0cmluZwoJCWxvY2FsIE91dCA9ICIiCgoJCWZvciBLZXksIFZhbHVlIGluIG5leHQsIFRlbXBsYXRlIGRvCgkJCS0tLy8gTWV0YU1ldGhvZCBjaGVjawoJCQlsb2NhbCBJc01ldGFUeXBlT25seSA9IHRhYmxlLmZpbmQoTWV0YU1ldGhvZHMsIEtleSkKCQkJaWYgSXNNZXRhVHlwZU9ubHkgdGhlbgoJCQkJaWYgS2V5ID09IE1ldGFNZXRob2QgdGhlbgoJCQkJCWxvY2FsIExpbmUgPSBDb21waWxlKFZhbHVlKQoJCQkJCU91dCAuLj0gTGluZQoJCQkJZW5kCgkJCQljb250aW51ZQoJCQllbmQKCgkJCS0tLy8gSW5mb3JtYXRpb24KCQkJbG9jYWwgQ29udGVudCwgSW5kZW50ID0gVmFsdWVbMV0sIFZhbHVlWzJdIG9yIDAKCQkJSW5kZW50ID0gbWF0aC5jbGFtcChJbmRlbnQtMSwgMCwgOTk5OSkKCgkJCS0tLy8gTWFrZSBsaW5lCgkJCWxvY2FsIExpbmUgPSBzZWxmOkFwcGx5VmFyaWFibGVzKENvbnRlbnQsIFZhcmlhYmxlcywgSW5kZW50KQoJCQlsb2NhbCBJbmRlbnRTdHJpbmcgPSBzZWxmOk1ha2VJbmRlbnQoSW5kZW50KQoKCQkJLS0vLyBBcHBlbmQgdG8gY29kZQoJCQlPdXQgLi49IGB7SW5kZW50U3RyaW5nfXtMaW5lfVxuYAoJCWVuZAoKCQlyZXR1cm4gT3V0CgllbmQKCQoJcmV0dXJuIENvbXBpbGUoVGVtcGxhdGUpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpSZW1vdGVTY3JpcHQoTW9kdWxlLCBEYXRhOiBSZW1vdGVEYXRhLCBTY3JpcHRUeXBlOiBzdHJpbmcpOiBzdHJpbmcKCS0tLy8gVW5wYWNrIGRhdGEKCWxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBBcmdzID0gRGF0YS5BcmdzCglsb2NhbCBNZXRob2QgPSBEYXRhLk1ldGhvZAoJbG9jYWwgTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZAoKCS0tLy8gUmVtb3RlIGluZm8KCWxvY2FsIENsYXNzTmFtZSA9IEhvb2s6SW5kZXgoUmVtb3RlLCAiQ2xhc3NOYW1lIikKCWxvY2FsIElzTmlsUGFyZW50ID0gSG9vazpJbmRleChSZW1vdGUsICJQYXJlbnQiKSA9PSBuaWwKCQoJbG9jYWwgVmFyaWFibGVzID0gTW9kdWxlLlZhcmlhYmxlcwoJbG9jYWwgRm9ybWF0dGVyID0gTW9kdWxlLkZvcm1hdHRlcgoJCgktLS8vIFByZS1yZW5kZXIgdmFyaWFibGVzCglWYXJpYWJsZXM6UHJlcmVuZGVyVmFyaWFibGVzKEFyZ3MsIHsiSW5zdGFuY2UifSkKCgktLS8vIENyZWF0ZSByZW1vdGUgdmFyaWFibGUKCWxvY2FsIFJlbW90ZVZhcmlhYmxlID0gVmFyaWFibGVzOk1ha2VWYXJpYWJsZSh7CgkJVmFsdWUgPSBGb3JtYXR0ZXI6Rm9ybWF0KFJlbW90ZSwgewoJCQlOb1ZhcmlhYmxlcyA9IHRydWUKCQl9KSwKCQlDb21tZW50ID0gYHtDbGFzc05hbWV9IHtJc05pbFBhcmVudCBhbmQgInwgUmVtb3RlIHBhcmVudCBpcyBuaWwiIG9yICIifWAsCgkJTmFtZSA9IEZvcm1hdHRlcjpNYWtlTmFtZShSZW1vdGUpLAoJCUxvb2t1cCA9IFJlbW90ZSwKCQlDbGFzcyA9ICJSZW1vdGUiCgl9KQoKCS0tLy8gR2VuZXJhdGUgY2FsbCBzY3JpcHQKCWxvY2FsIENhbGxDb2RlID0gc2VsZjpNYWtlQ2FsbENvZGUoU2NyaXB0VHlwZSwgewoJCVZhcmlhYmxlcyA9IHsKCQkJWyJSZW1vdGVDYWxsIl0gPSBmdW5jdGlvbihJbmRlbnQ6IG51bWJlcikKCQkJCXJldHVybiBzZWxmOkNhbGxSZW1vdGVTY3JpcHQoRGF0YSwgewoJCQkJCVJlbW90ZVZhcmlhYmxlID0gUmVtb3RlVmFyaWFibGUsCgkJCQkJSW5kZW50ID0gSW5kZW50LAoJCQkJCU1vZHVsZSA9IE1vZHVsZQoJCQkJfSkKCQkJZW5kLAoJCQlbIlJlbW90ZSJdID0gUmVtb3RlVmFyaWFibGUsCgkJCVsiTWV0aG9kIl0gPSBNZXRob2QsCgkJCVsiU2lnbmFsIl0gPSBge1JlbW90ZVZhcmlhYmxlfS57TWV0aG9kfWAKCQl9LAoJCU1ldGFNZXRob2QgPSBNZXRhTWV0aG9kCgl9KQoJCgktLS8vIE1ha2UgY29kZQoJbG9jYWwgQ29kZSA9IHNlbGY6R2V0QmFzZShNb2R1bGUpCglyZXR1cm4gYHtDb2RlfVxue0NhbGxDb2RlfWAKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkNvbm5lY3Rpb25zVGFibGUoU2lnbmFsOiBSQlhTY3JpcHRTaWduYWwpOiB0YWJsZQoJbG9jYWwgQ29ubmVjdGlvbnMgPSBnZXRjb25uZWN0aW9ucyhTaWduYWwpCglsb2NhbCBEYXRhQXJyYXkgPSB7fQoKCWZvciBfLCBDb25uZWN0aW9uIGluIG5leHQsIENvbm5lY3Rpb25zIGRvCgkJbG9jYWwgRnVuY3Rpb24gPSBDb25uZWN0aW9uLkZ1bmN0aW9uCgkJbG9jYWwgU2NyaXB0ID0gcmF3Z2V0KGdldGZlbnYoRnVuY3Rpb24pLCAic2NyaXB0IikKCgkJLS0vLyBTa2lwIGlmIHNlbGYKCQlpZiBTY3JpcHQgPT0gVGhpc1NjcmlwdCB0aGVuIGNvbnRpbnVlIGVuZAoKCQktLS8vIENvbm5lY3Rpb24gZGF0YQoJCWxvY2FsIERhdGEgPSB7CgkJCUZ1bmN0aW9uID0gRnVuY3Rpb24sCgkJCVN0YXRlID0gQ29ubmVjdGlvbi5TdGF0ZSwKCQkJU2NyaXB0ID0gU2NyaXB0CgkJfQoKCQl0YWJsZS5pbnNlcnQoRGF0YUFycmF5LCBEYXRhKQoJZW5kCgoJcmV0dXJuIERhdGFBcnJheQplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246VGFibGVTY3JpcHQoTW9kdWxlLCBUYWJsZTogdGFibGUpOiBzdHJpbmcKCS0tLy8gUHJlLXJlbmRlciB2YXJpYWJsZXMKCU1vZHVsZS5WYXJpYWJsZXM6UHJlcmVuZGVyVmFyaWFibGVzKFRhYmxlLCB7Ikluc3RhbmNlIn0pCgoJLS0vLyBQYXJzZSBhcmd1bWVudHMKCWxvY2FsIFBhcnNlZFRhYmxlID0gTW9kdWxlLlBhcnNlcjpQYXJzZVRhYmxlSW50b1N0cmluZyh7CgkJVGFibGUgPSBUYWJsZQoJfSkKCgktLS8vIEdlbmVyYXRlIHNjcmlwdAoJbG9jYWwgQ29kZSwgTm9WYXJpYWJsZXMgPSBzZWxmOkdldEJhc2UoTW9kdWxlKQoJbG9jYWwgU2VwZXJhdG9yID0gTm9WYXJpYWJsZXMgYW5kICIiIG9yICJcbiIKCUNvZGUgLi49IGB7U2VwZXJhdG9yfXJldHVybiB7UGFyc2VkVGFibGV9YAoKCXJldHVybiBDb2RlCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlVHlwZXNUYWJsZShUYWJsZTogdGFibGUpOiB0YWJsZQoJbG9jYWwgVHlwZXMgPSB7fQoKCWZvciBLZXksIFZhbHVlIGluIG5leHQsIFRhYmxlIGRvCgkJbG9jYWwgVHlwZSA9IHR5cGVvZihWYWx1ZSkKCQlpZiBUeXBlID09ICJ0YWJsZSIgdGhlbgoJCQlUeXBlID0gc2VsZjpNYWtlVHlwZXNUYWJsZShWYWx1ZSkKCQllbmQKCgkJVHlwZXNbS2V5XSA9IFR5cGUKCWVuZAoKCXJldHVybiBUeXBlcwplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246Q29ubmVjdGlvbkluZm8oUmVtb3RlOiBJbnN0YW5jZSwgQ2xhc3NEYXRhOiB0YWJsZSk6IHRhYmxlPwoJbG9jYWwgUmVjZWl2ZU1ldGhvZHMgPSBDbGFzc0RhdGEuUmVjZWl2ZQoJaWYgbm90IFJlY2VpdmVNZXRob2RzIHRoZW4gcmV0dXJuIGVuZAoKCWxvY2FsIENvbm5lY3Rpb25zID0ge30KCWZvciBfLCBNZXRob2Q6IHN0cmluZyBpbiBuZXh0LCBSZWNlaXZlTWV0aG9kcyBkbwoJCXBjYWxsKGZ1bmN0aW9uKCkgLS0gVE9ETzogR0VUQ0FMTEJBQ0tWQUxVRQoJCQlsb2NhbCBTaWduYWwgPSBIb29rOkluZGV4KFJlbW90ZSwgTWV0aG9kKQoJCQlDb25uZWN0aW9uc1tNZXRob2RdID0gc2VsZjpDb25uZWN0aW9uc1RhYmxlKFNpZ25hbCkKCQllbmQpCgllbmQKCglyZXR1cm4gQ29ubmVjdGlvbnMKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkFkdmFuY2VkSW5mbyhNb2R1bGUsIERhdGE6IHRhYmxlKTogc3RyaW5nCgktLS8vIFVucGFjayByZW1vdGUgZGF0YQoJbG9jYWwgRnVuY3Rpb24gPSBEYXRhLkNhbGxpbmdGdW5jdGlvbgoJbG9jYWwgQ2xhc3NEYXRhID0gRGF0YS5DbGFzc0RhdGEKCWxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBBcmdzID0gRGF0YS5BcmdzCgkKCS0tLy8gQWR2YW5jZWQgaW5mbyB0YWJsZSBiYXNlCglsb2NhbCBGdW5jdGlvbkluZm8gPSB7CgkJWyJDYWxsZXIiXSA9IHsKCQkJWyJTb3VyY2VTY3JpcHQiXSA9IERhdGEuU291cmNlU2NyaXB0LAoJCQlbIkNhbGxpbmdTY3JpcHQiXSA9IERhdGEuQ2FsbGluZ1NjcmlwdCwKCQkJWyJDYWxsaW5nRnVuY3Rpb24iXSA9IEZ1bmN0aW9uCgkJfSwKCQlbIlJlbW90ZSJdID0gewoJCQlbIlJlbW90ZSJdID0gUmVtb3RlLAoJCQlbIlJlbW90ZUlEIl0gPSBEYXRhLklkLAoJCQlbIk1ldGhvZCJdID0gRGF0YS5NZXRob2QsCgkJCVsiQ29ubmVjdGlvbnMiXSA9IHNlbGY6Q29ubmVjdGlvbkluZm8oUmVtb3RlLCBDbGFzc0RhdGEpCgkJfSwKCQlbIkFyZ3VtZW50cyJdID0gewoJCQlbIkxlbmd0aCJdID0gI0FyZ3MsCgkJCVsiVHlwZXMiXSA9IHNlbGY6TWFrZVR5cGVzVGFibGUoQXJncyksCgkJfSwKCQlbIk1ldGFNZXRob2QiXSA9IERhdGEuTWV0YU1ldGhvZCwKCQlbIklzQWN0b3IiXSA9IERhdGEuSXNBY3RvciwKCX0KCgktLS8vIFNvbWUgY2xvc3VyZXMgbWF5IG5vdCBiZSBsdWEKCWlmIEZ1bmN0aW9uIGFuZCBpc2xjbG9zdXJlKEZ1bmN0aW9uKSB0aGVuCgkJRnVuY3Rpb25JbmZvWyJVcFZhbHVlcyJdID0gZGVidWcuZ2V0dXB2YWx1ZXMoRnVuY3Rpb24pCgkJRnVuY3Rpb25JbmZvWyJDb25zdGFudHMiXSA9IGRlYnVnLmdldGNvbnN0YW50cyhGdW5jdGlvbikKCWVuZAoKCS0tLy8gR2VuZXJhdGUgc2NyaXB0CglyZXR1cm4gc2VsZjpUYWJsZVNjcmlwdChNb2R1bGUsIEZ1bmN0aW9uSW5mbykKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkR1bXBMb2dzKExvZ3M6IHRhYmxlKTogc3RyaW5nCglsb2NhbCBCYXNlRGF0YQoJbG9jYWwgUGFyc2VkID0gewoJCVJlbW90ZSA9IG5pbCwKCQlDYWxscyA9IHt9Cgl9CgoJLS0vLyBDcmVhdGUgbmV3IHBhcnNlciBpbnN0YW5jZQoJbG9jYWwgTW9kdWxlID0gR2VuZXJhdGlvbjpOZXdQYXJzZXIoKQoKCWZvciBfLCBEYXRhIGluIExvZ3MgZG8KCQlsb2NhbCBDYWxscyA9IFBhcnNlZC5DYWxscwoJCWxvY2FsIFRhYmxlID0gewoJCQlBcmdzID0gRGF0YS5BcmdzLAoJCQlUaW1lc3RhbXAgPSBEYXRhLlRpbWVzdGFtcCwKCQkJUmV0dXJuVmFsdWVzID0gRGF0YS5SZXR1cm5WYWx1ZXMsCgkJCU1ldGhvZCA9IERhdGEuTWV0aG9kLAoJCQlNZXRhTWV0aG9kID0gRGF0YS5NZXRhTWV0aG9kLAoJCQlDYWxsaW5nU2NyaXB0ID0gRGF0YS5DYWxsaW5nU2NyaXB0LAoJCX0KCgkJLS0vLyBBcHBlbmQKCQl0YWJsZS5pbnNlcnQoQ2FsbHMsIFRhYmxlKQoKCQktLS8vIFNldCBCYXNlRGF0YQoJCWlmIG5vdCBCYXNlRGF0YSB0aGVuCgkJCUJhc2VEYXRhID0gRGF0YQoJCWVuZAoJZW5kCgoJLS0vLyBCYXNlZGF0YSBtZXJnZQoJUGFyc2VkLlJlbW90ZSA9IEJhc2VEYXRhLlJlbW90ZQoKCS0tLy8gQ29tcGlsZSBhbmQgc2F2ZQoJbG9jYWwgT3V0cHV0ID0gc2VsZjpUYWJsZVNjcmlwdChNb2R1bGUsIFBhcnNlZCkKCWxvY2FsIEZpbGVQYXRoID0gc2VsZjpXcml0ZUR1bXAoT3V0cHV0KQoJCglyZXR1cm4gRmlsZVBhdGgKZW5kCgpyZXR1cm4gR2VuZXJhdGlvbgo=]]
},Communication={'base64',
[[dHlwZSB0YWJsZSA9IHsKICAgIFthbnldOiBhbnkKfQoKLS0vLyBNb2R1bGUKbG9jYWwgTW9kdWxlID0gewogICAgQ29tbUNhbGxiYWNrcyA9IHt9Cn0KCmxvY2FsIENvbW1XcmFwcGVyID0ge30KQ29tbVdyYXBwZXIuX19pbmRleCA9IENvbW1XcmFwcGVyCgotLS8vIFNlcmlhbGl6ZXIgY2FjaGUKbG9jYWwgU2VyaWFsaXplQ2FjaGUgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAiayJ9KQpsb2NhbCBEZXNlcmlhbGl6ZUNhY2hlID0gc2V0bWV0YXRhYmxlKHt9LCB7X19tb2RlID0gImsifSkKCi0tLy8gU2VydmljZXMKbG9jYWwgQ29yZUd1aQoKLS0vLyBNb2R1bGVzCmxvY2FsIEhvb2sKbG9jYWwgQ2hhbm5lbApsb2NhbCBDb25maWcKbG9jYWwgUHJvY2VzcwoKZnVuY3Rpb24gTW9kdWxlOkluaXQoRGF0YSkKICAgIGxvY2FsIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKICAgIGxvY2FsIFNlcnZpY2VzID0gRGF0YS5TZXJ2aWNlcwoKICAgIEhvb2sgPSBNb2R1bGVzLkhvb2sKICAgIFByb2Nlc3MgPSBNb2R1bGVzLlByb2Nlc3MKICAgIENvbmZpZyA9IE1vZHVsZXMuQ29uZmlnIG9yIENvbmZpZwogICAgQ29yZUd1aSA9IFNlcnZpY2VzLkNvcmVHdWkKZW5kCgpmdW5jdGlvbiBDb21tV3JhcHBlcjpGaXJlKC4uLikKICAgIGxvY2FsIFF1ZXVlID0gc2VsZi5RdWV1ZQogICAgdGFibGUuaW5zZXJ0KFF1ZXVlLCB7Li4ufSkKZW5kCgpmdW5jdGlvbiBDb21tV3JhcHBlcjpQcm9jZXNzQXJndW1lbnRzKEFyZ3VtZW50cykgCiAgICBsb2NhbCBDaGFubmVsID0gc2VsZi5DaGFubmVsCiAgICBDaGFubmVsOkZpcmUoUHJvY2VzczpVbnBhY2soQXJndW1lbnRzKSkKZW5kCgpmdW5jdGlvbiBDb21tV3JhcHBlcjpQcm9jZXNzUXVldWUoKQogICAgbG9jYWwgUXVldWUgPSBzZWxmLlF1ZXVlCgogICAgZm9yIEluZGV4ID0gMSwgI1F1ZXVlIGRvCiAgICAgICAgbG9jYWwgQXJndW1lbnRzID0gdGFibGUucmVtb3ZlKFF1ZXVlKQogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgc2VsZjpQcm9jZXNzQXJndW1lbnRzKEFyZ3VtZW50cykgCiAgICAgICAgZW5kKQogICAgZW5kCmVuZAoKZnVuY3Rpb24gQ29tbVdyYXBwZXI6QmVnaW5RdWV1ZVNlcnZpY2UoKQogICAgY29yb3V0aW5lLndyYXAoZnVuY3Rpb24oKQogICAgICAgIHdoaWxlIHdhaXQoKSBkbwogICAgICAgICAgICBzZWxmOlByb2Nlc3NRdWV1ZSgpCiAgICAgICAgZW5kCiAgICBlbmQpKCkKZW5kCgpmdW5jdGlvbiBNb2R1bGU6TmV3Q29tbVdyYXAoQ2hhbm5lbDogQmluZGFibGVFdmVudCkKICAgIGxvY2FsIEJhc2UgPSB7CiAgICAgICAgUXVldWUgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAidiJ9KSwKICAgICAgICBDaGFubmVsID0gQ2hhbm5lbCwKICAgICAgICBFdmVudCA9IENoYW5uZWwuRXZlbnQKICAgIH0KCiAgICAtLS8vIENyZWF0ZSBuZXcgd3JhcHBlciBjbGFzcwogICAgbG9jYWwgV3JhcHBlZCA9IHNldG1ldGF0YWJsZShCYXNlLCBDb21tV3JhcHBlcikKICAgIFdyYXBwZWQ6QmVnaW5RdWV1ZVNlcnZpY2UoKQoKICAgIHJldHVybiBXcmFwcGVkCmVuZAoKZnVuY3Rpb24gTW9kdWxlOk1ha2VEZWJ1Z0lkSGFuZGxlcigpOiBCaW5kYWJsZUZ1bmN0aW9uCiAgICAtLS8vIFVzaW5nIEJpbmRhYmxlRnVuY3Rpb24gYXMgaXQgZG9lcyBub3QgcmVxdWlyZSBhIHRocmVhZCBwZXJtaXNzaW9uIGNoYW5nZQogICAgbG9jYWwgUmVtb3RlID0gSW5zdGFuY2UubmV3KCJCaW5kYWJsZUZ1bmN0aW9uIikKICAgIGZ1bmN0aW9uIFJlbW90ZS5Pbkludm9rZShPYmplY3Q6IEluc3RhbmNlKTogc3RyaW5nCiAgICAgICAgcmV0dXJuIE9iamVjdDpHZXREZWJ1Z0lkKCkKICAgIGVuZAoKICAgIHNlbGYuRGVidWdJZFJlbW90ZSA9IFJlbW90ZQogICAgc2VsZi5EZWJ1Z0lkSW52b2tlID0gUmVtb3RlLkludm9rZQoKICAgIHJldHVybiBSZW1vdGUKZW5kCgpmdW5jdGlvbiBNb2R1bGU6R2V0RGVidWdJZChPYmplY3Q6IEluc3RhbmNlKTogc3RyaW5nCiAgICBsb2NhbCBJbnZva2UgPSBzZWxmLkRlYnVnSWRJbnZva2UKICAgIGxvY2FsIFJlbW90ZSA9IHNlbGYuRGVidWdJZFJlbW90ZQoJcmV0dXJuIEludm9rZShSZW1vdGUsIE9iamVjdCkKZW5kCgpmdW5jdGlvbiBNb2R1bGU6R2V0SGlkZGVuUGFyZW50KCk6IEluc3RhbmNlCiAgICAtLS8vIFVzZSBnZXRodWkgaWYgaXQgZXhpc3RzCiAgICBpZiBnZXRodWkgdGhlbiByZXR1cm4gZ2V0aHVpKCkgZW5kCiAgICByZXR1cm4gQ29yZUd1aQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpDcmVhdGVDb21tQ2hhbm5lbCgpOiAobnVtYmVyLCBCaW5kYWJsZUV2ZW50KQogICAgLS0vLyBVc2UgbmF0aXZlIGlmIGl0IGV4aXN0cwogICAgbG9jYWwgRm9yY2UgPSBDb25maWcuRm9yY2VVc2VDdXN0b21Db21tCiAgICBpZiBjcmVhdGVfY29tbV9jaGFubmVsIGFuZCBub3QgRm9yY2UgdGhlbgogICAgICAgIHJldHVybiBjcmVhdGVfY29tbV9jaGFubmVsKCkKICAgIGVuZAoKICAgIGxvY2FsIFBhcmVudCA9IHNlbGY6R2V0SGlkZGVuUGFyZW50KCkKICAgIGxvY2FsIENoYW5uZWxJZCA9IG1hdGgucmFuZG9tKDEsIDEwMDAwMDAwKQoKICAgIC0tLy8gQmluZGFibGVFdmVudAogICAgbG9jYWwgQ2hhbm5lbCA9IEluc3RhbmNlLm5ldygiQmluZGFibGVFdmVudCIsIFBhcmVudCkKICAgIENoYW5uZWwuTmFtZSA9IENoYW5uZWxJZAoKICAgIHJldHVybiBDaGFubmVsSWQsIENoYW5uZWwKZW5kCgpmdW5jdGlvbiBNb2R1bGU6R2V0Q29tbUNoYW5uZWwoQ2hhbm5lbElkOiBudW1iZXIpOiBCaW5kYWJsZUV2ZW50PwogICAgLS0vLyBVc2UgbmF0aXZlIGlmIGl0IGV4aXN0cwogICAgbG9jYWwgRm9yY2UgPSBDb25maWcuRm9yY2VVc2VDdXN0b21Db21tCiAgICBpZiBnZXRfY29tbV9jaGFubmVsIGFuZCBub3QgRm9yY2UgdGhlbgogICAgICAgIGxvY2FsIENoYW5uZWwgPSBnZXRfY29tbV9jaGFubmVsKENoYW5uZWxJZCkKICAgICAgICByZXR1cm4gQ2hhbm5lbCwgZmFsc2UKICAgIGVuZAoKICAgIGxvY2FsIFBhcmVudCA9IHNlbGY6R2V0SGlkZGVuUGFyZW50KCkKICAgIGxvY2FsIENoYW5uZWwgPSBQYXJlbnQ6RmluZEZpcnN0Q2hpbGQoQ2hhbm5lbElkKQoKICAgIC0tLy8gV3JhcCB0aGUgY2hhbm5lbCAoUHJldmVudHMgdGhyZWFkIHBlcm1pc3Npb24gZXJyb3JzKQogICAgbG9jYWwgV3JhcHBlZCA9IHNlbGY6TmV3Q29tbVdyYXAoQ2hhbm5lbCkKICAgIHJldHVybiBXcmFwcGVkLCB0cnVlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkNoZWNrVmFsdWUoVmFsdWUsIEluYm91bmQ6IGJvb2xlYW4/KQogICAgIC0tLy8gTm8gc2VyaWFsaXppbmcgIG5lZWRlZAogICAgaWYgdHlwZW9mKFZhbHVlKSB+PSAidGFibGUiIHRoZW4gCiAgICAgICAgcmV0dXJuIFZhbHVlIAogICAgZW5kCiAgIAogICAgLS0vLyBEZXNlcmlhbGl6ZQogICAgaWYgSW5ib3VuZCB0aGVuCiAgICAgICAgcmV0dXJuIHNlbGY6RGVzZXJpYWxpemVUYWJsZShWYWx1ZSkKICAgIGVuZAoKICAgIC0tLy8gU2VyaWFsaXplCiAgICByZXR1cm4gc2VsZjpTZXJpYWxpemVUYWJsZShWYWx1ZSkKZW5kCgpsb2NhbCBUaWNrID0gMApmdW5jdGlvbiBNb2R1bGU6V2FpdENoZWNrKCkKICAgIFRpY2sgKz0gMQogICAgaWYgVGljayA+IDQwIHRoZW4KICAgICAgICBUaWNrID0gMCAtLSBJIGNvdWxkIHVzZSBtb2R1bHVzIGhlcmUgYnV0IHRoZSBpbnRlcmdlciB3aWxsIGJlIG1hc3NpdmUKICAgICAgICB3YWl0KCkKICAgIGVuZAplbmQKCmZ1bmN0aW9uIE1vZHVsZTpNYWtlUGFja2V0KEluZGV4LCBWYWx1ZSk6IHRhYmxlCiAgICBzZWxmOldhaXRDaGVjaygpCiAgICByZXR1cm4gewogICAgICAgIEluZGV4ID0gc2VsZjpDaGVja1ZhbHVlKEluZGV4KSwgCiAgICAgICAgVmFsdWUgPSBzZWxmOkNoZWNrVmFsdWUoVmFsdWUpCiAgICB9CmVuZAoKZnVuY3Rpb24gTW9kdWxlOlJlYWRQYWNrZXQoUGFja2V0OiB0YWJsZSk6IChhbnksIGFueSkKICAgIGlmIHR5cGVvZihQYWNrZXQpIH49ICJ0YWJsZSIgdGhlbiByZXR1cm4gUGFja2V0IGVuZAogICAgCiAgICBsb2NhbCBLZXkgPSBzZWxmOkNoZWNrVmFsdWUoUGFja2V0LkluZGV4LCB0cnVlKQogICAgbG9jYWwgVmFsdWUgPSBzZWxmOkNoZWNrVmFsdWUoUGFja2V0LlZhbHVlLCB0cnVlKQogICAgc2VsZjpXYWl0Q2hlY2soKQoKICAgIHJldHVybiBLZXksIFZhbHVlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOlNlcmlhbGl6ZVRhYmxlKFRhYmxlOiB0YWJsZSk6IHRhYmxlCiAgICAtLS8vIENoZWNrIGNhY2hlIGZvciBleGlzdGluZwogICAgbG9jYWwgQ2FjaGVkID0gU2VyaWFsaXplQ2FjaGVbVGFibGVdCiAgICBpZiBDYWNoZWQgdGhlbiByZXR1cm4gQ2FjaGVkIGVuZAoKICAgIGxvY2FsIFNlcmlhbGl6ZWQgPSB7fQogICAgU2VyaWFsaXplQ2FjaGVbVGFibGVdID0gU2VyaWFsaXplZAoKICAgIGZvciBJbmRleCwgVmFsdWUgaW4gbmV4dCwgVGFibGUgZG8KICAgICAgICBsb2NhbCBQYWNrZXQgPSBzZWxmOk1ha2VQYWNrZXQoSW5kZXgsIFZhbHVlKQogICAgICAgIHRhYmxlLmluc2VydChTZXJpYWxpemVkLCBQYWNrZXQpCiAgICBlbmQKCiAgICByZXR1cm4gU2VyaWFsaXplZAplbmQKCmZ1bmN0aW9uIE1vZHVsZTpEZXNlcmlhbGl6ZVRhYmxlKFNlcmlhbGl6ZWQ6IHRhYmxlKTogdGFibGUKICAgIC0tLy8gQ2hlY2sgZm9yIGNhY2hlZAogICAgbG9jYWwgQ2FjaGVkID0gRGVzZXJpYWxpemVDYWNoZVtTZXJpYWxpemVkXQogICAgaWYgQ2FjaGVkIHRoZW4gcmV0dXJuIENhY2hlZCBlbmQKCiAgICBsb2NhbCBUYWJsZSA9IHt9CiAgICBEZXNlcmlhbGl6ZUNhY2hlW1NlcmlhbGl6ZWRdID0gVGFibGUKICAgIAogICAgZm9yIF8sIFBhY2tldCBpbiBuZXh0LCBTZXJpYWxpemVkIGRvCiAgICAgICAgbG9jYWwgSW5kZXgsIFZhbHVlID0gc2VsZjpSZWFkUGFja2V0KFBhY2tldCkKICAgICAgICBpZiBJbmRleCA9PSBuaWwgdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgVGFibGVbSW5kZXhdID0gVmFsdWUKICAgIGVuZAoKICAgIHJldHVybiBUYWJsZQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpTZXRDaGFubmVsKE5ld0NoYW5uZWw6IG51bWJlcikKICAgIENoYW5uZWwgPSBOZXdDaGFubmVsCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkNvbnNvbGVQcmludCguLi4pCiAgICBzZWxmOkNvbW11bmljYXRlKCJQcmludCIsIC4uLikKZW5kCgpmdW5jdGlvbiBNb2R1bGU6UXVldWVMb2coRGF0YSkKICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBTZXJpYWxpemVkQXJncyA9IHNlbGY6U2VyaWFsaXplVGFibGUoRGF0YS5BcmdzKQogICAgICAgIERhdGEuQXJncyA9IFNlcmlhbGl6ZWRBcmdzCgogICAgICAgIHNlbGY6Q29tbXVuaWNhdGUoIlF1ZXVlTG9nIiwgRGF0YSkKICAgIGVuZCkKZW5kCgpmdW5jdGlvbiBNb2R1bGU6QWRkQ29tbUNhbGxiYWNrKFR5cGU6IHN0cmluZywgQ2FsbGJhY2s6ICguLi5hbnkpIC0+IC4uLmFueSkKICAgIGxvY2FsIENvbW1DYWxsYmFja3MgPSBzZWxmLkNvbW1DYWxsYmFja3MKICAgIENvbW1DYWxsYmFja3NbVHlwZV0gPSBDYWxsYmFjawplbmQKCmZ1bmN0aW9uIE1vZHVsZTpHZXRDb21tQ2FsbGJhY2soVHlwZTogc3RyaW5nKTogKC4uLmFueSkgLT4gLi4uYW55CiAgICBsb2NhbCBDb21tQ2FsbGJhY2tzID0gc2VsZi5Db21tQ2FsbGJhY2tzCiAgICByZXR1cm4gQ29tbUNhbGxiYWNrc1tUeXBlXQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgUHJvcGVydHk6IHN0cmluZykKICAgIGlmIHR5cGVvZihDaGFubmVsKSA9PSAiSW5zdGFuY2UiIHRoZW4KICAgICAgICByZXR1cm4gSG9vazpJbmRleChDaGFubmVsLCBQcm9wZXJ0eSkKICAgIGVuZAoKICAgIC0tLy8gU29tZSBleGVjdXRvcnMgcmV0dXJuIGEgVXNlckRhdGEgdHlwZQogICAgcmV0dXJuIENoYW5uZWxbUHJvcGVydHldCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkNvbW11bmljYXRlKC4uLikKICAgIGxvY2FsIEZpcmUgPSBzZWxmOkNoYW5uZWxJbmRleChDaGFubmVsLCAiRmlyZSIpCiAgICBGaXJlKENoYW5uZWwsIC4uLikKZW5kCgpmdW5jdGlvbiBNb2R1bGU6QWRkQ29ubmVjdGlvbihDYWxsYmFjayk6IFJCWFNjcmlwdENvbm5lY3Rpb24KICAgIGxvY2FsIEV2ZW50ID0gc2VsZjpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgIkV2ZW50IikKICAgIHJldHVybiBFdmVudDpDb25uZWN0KENhbGxiYWNrKQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpBZGRUeXBlQ2FsbGJhY2soVHlwZTogc3RyaW5nLCBDYWxsYmFjayk6IFJCWFNjcmlwdENvbm5lY3Rpb24KICAgIGxvY2FsIEV2ZW50ID0gc2VsZjpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgIkV2ZW50IikKICAgIHJldHVybiBFdmVudDpDb25uZWN0KGZ1bmN0aW9uKFJlY2l2ZWRUeXBlOiBzdHJpbmcsIC4uLikKICAgICAgICBpZiBSZWNpdmVkVHlwZSB+PSBUeXBlIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIENhbGxiYWNrKC4uLikKICAgIGVuZCkKZW5kCgpmdW5jdGlvbiBNb2R1bGU6QWRkVHlwZUNhbGxiYWNrcyhUeXBlczogdGFibGUpCiAgICBmb3IgVHlwZTogc3RyaW5nLCBDYWxsYmFjayBpbiBuZXh0LCBUeXBlcyBkbwogICAgICAgIHNlbGY6QWRkVHlwZUNhbGxiYWNrKFR5cGUsIENhbGxiYWNrKQogICAgZW5kCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkNyZWF0ZUNoYW5uZWwoKTogbnVtYmVyCiAgICBsb2NhbCBDaGFubmVsSUQsIEV2ZW50ID0gc2VsZjpDcmVhdGVDb21tQ2hhbm5lbCgpCgogICAgLS0vLyBDb25uZWN0IEdldENvbW1DYWxsYmFjayBmdW5jdGlvbgogICAgRXZlbnQuRXZlbnQ6Q29ubmVjdChmdW5jdGlvbihUeXBlOiBzdHJpbmcsIC4uLikKICAgICAgICBsb2NhbCBDYWxsYmFjayA9IHNlbGY6R2V0Q29tbUNhbGxiYWNrKFR5cGUpCiAgICAgICAgaWYgQ2FsbGJhY2sgdGhlbgogICAgICAgICAgICBDYWxsYmFjayguLi4pCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgcmV0dXJuIENoYW5uZWxJRCwgRXZlbnQKZW5kCgpNb2R1bGU6TWFrZURlYnVnSWRIYW5kbGVyKCkKCnJldHVybiBNb2R1bGU=]]
}},d.Players local i=e:LoadLibraries(g)local j,k,l,m,n,o,p=i.Process,i.Hook,i.Ui
,i.Generation,i.Communication,i.Config,e:GetAsset('ProggyClean.ttf',true)local q
=e:CreateFont('ProggyClean',p)l:SetFontFile(q)j:CheckConfig(o)e:LoadModules(i,{
Modules=i,Services=d})local r,s=l:CreateMainWindow(),j:CheckIsSupported()if not
s then r:Close()return end local t,u=n:CreateChannel()n:AddCommCallback(
'QueueLog',function(...)l:QueueLog(...)end)n:AddCommCallback('Print',function(
...)l:ConsoleLog(...)end)local v=h.LocalPlayer m:SetSwapsCallback(function(w)w:
AddSwap(v,{String='LocalPlayer'})w:AddSwap(v.Character,{String='Character',
NextParent=v})end)l:CreateWindowContent(r)l:SetCommChannel(u)l:BeginLogService()
local w=e:MakeActorScript(g,t)k:LoadHooks(w,t)local x=l:AskUser{Title=
'Enable function patches?',Content={
[[On some executors, function patches can prevent common detections that executor has]]
,
[[By enabling this, it MAY trigger hook detections in some games, this is why you are asked.]]
,"If it doesn't work, rejoin and press 'No'",'',
'(This does not affect game functionality)'},Options={'Yes','No'}}=='Yes'u:Fire(
'BeginHooks',{PatchFunctions=x})